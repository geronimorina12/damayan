import{_ as j}from"./not_found-DvAnRRcV.js";import{r as p,s as C,f as n,o as a,b as e,n as w,u as o,F as M,G as A,t as i,W as T,x as E,l as O,h as $,d as F,i as S,I,D as B,e as U,J as R,E as H,a as y,g as W,w as z}from"./app-ukGeU6Fu.js";import{A as G}from"./AdminLayout-CxBBxh6C.js";import{_ as V}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as J}from"./ToggleContribution-zKza1Ztf.js";import"./logo1-BZ0h4foK.js";const K={class:"d-flex align-items-center gap-2 text-muted small"},Y=["onClick"],q={__name:"Purok",props:{activePurok:{type:String,default:()=>""},currentDeceasedId:{type:[String,Number],default:null}},setup(m){const d=m;let u=p("");C(()=>d.activePurok,k=>{u.value=k},{immediate:!0});const v=["purok1","purok2","purok3","purok4"],f=k=>{T.get(route("contributions.togglePurok",{purok:k,deceasedId:d.currentDeceasedId||0}),{onSuccess:()=>console.log("changing purok"),onError:_=>console.log("An error occured: ",_)})};return(k,_)=>(a(),n("div",null,[e("div",K,[e("span",{class:w(["purok all-members-text",{"fw-bold active":o(u)=="all"}]),onClick:_[0]||(_[0]=g=>f("all"))},"ALL MEMBERS",2),e("div",null,[(a(),n(M,null,A(v,g=>e("span",{key:g,class:w(["mx-2 purok",{"fw-bold active":g===o(u)}]),onClick:r=>f(g)},i(g),11,Y)),64))])])]))}},Q=V(q,[["__scopeId","data-v-43b9cc2a"]]),X={class:"contri-container py-1"},Z={class:"row justify-content-center"},ee={class:"col-md-8"},te={class:"card rounded-4 shadow-none border-0"},se={class:"card-body p-4"},oe={key:0,class:"alert alert-success text-center fw-semibold",role:"alert"},le={class:"mb-3"},ne=["value"],ae={key:0,class:"invalid-feedback"},re={class:"mb-3"},ie={key:0,class:"invalid-feedback"},de={class:"mb-3"},ue=["value"],ce={key:0,class:"invalid-feedback"},be={class:"mb-3"},pe={class:"mb-3"},_e=["value"],ve={class:"d-flex justify-content-end"},fe=["disabled"],ke={key:0,class:"spinner-border spinner-border-sm"},ge={__name:"AddContribution",setup(m){const d=p([]),u=p([]),v=p([]),f=p([]),k=p([]),_=p(!1),g=p(""),r=E({member_id:"",amount:100,payment_date:"",collector:"",status:"paid",purok:"",deceased_id:""});O(async()=>{try{const l=await R.get(route("contributions.members.data")),{members:s,users:t,deceasedMembers:P}=l.data;d.value=s||[],f.value=t||[],k.value=P||[];const x=(s||[]).map(b=>({id:b.id,fullName:`${b.first_name} ${b.middle_name??""} ${b.last_name}`.replace(/\s+/g," ").trim()})),h=(t||[]).map(b=>({id:b.id,fullName:b.name}));u.value=[...x,...h],v.value=(t||[]).filter(b=>b.role==="collector")}catch(l){console.error(l)}});const c=()=>{r.post(route("contributions.store"),{preserveScroll:!0,onSuccess:()=>{g.value="Contribution successfully created!",_.value=!0,setTimeout(()=>_.value=!1,3e3),r.reset()}})};return(l,s)=>(a(),n("div",null,[e("div",X,[e("div",Z,[e("div",ee,[e("div",te,[s[14]||(s[14]=e("div",{class:"card-header text-center"},[e("h4",{class:"mb-0"},"Create Contribution")],-1)),e("div",se,[_.value?(a(),n("div",oe,i(g.value),1)):$("",!0),e("form",{onSubmit:F(c,["prevent"])},[e("div",le,[s[6]||(s[6]=e("label",{class:"form-label"},"Member Name",-1)),S(e("select",{"onUpdate:modelValue":s[0]||(s[0]=t=>o(r).member_id=t),class:w(["form-select",{"is-invalid":o(r).errors.member_id}])},[s[5]||(s[5]=e("option",{disabled:"",value:""},"-- Select Member --",-1)),(a(!0),n(M,null,A(u.value,t=>(a(),n("option",{key:t.id,value:t.id},i(t.fullName),9,ne))),128))],2),[[I,o(r).member_id]]),o(r).errors.member_id?(a(),n("div",ae,i(o(r).errors.member_id),1)):$("",!0)]),e("div",re,[s[7]||(s[7]=e("label",{class:"form-label"},"Payment Date",-1)),S(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>o(r).payment_date=t),type:"datetime-local",class:w(["form-control",{"is-invalid":o(r).errors.payment_date}])},null,2),[[B,o(r).payment_date]]),o(r).errors.payment_date?(a(),n("div",ie,i(o(r).errors.payment_date),1)):$("",!0)]),e("div",de,[s[9]||(s[9]=e("label",{class:"form-label"},"Collector",-1)),S(e("select",{"onUpdate:modelValue":s[2]||(s[2]=t=>o(r).collector=t),class:w(["form-control",{"is-invalid":o(r).errors.collector}])},[s[8]||(s[8]=e("option",{disabled:"",value:""},"-- Select Collector --",-1)),(a(!0),n(M,null,A(v.value,t=>(a(),n("option",{key:t.id,value:t.name},i(t.name),9,ue))),128))],2),[[I,o(r).collector]]),o(r).errors.collector?(a(),n("div",ce,i(o(r).errors.collector),1)):$("",!0)]),e("div",be,[s[11]||(s[11]=e("label",{class:"form-label"},"Purok",-1)),S(e("select",{"onUpdate:modelValue":s[3]||(s[3]=t=>o(r).purok=t),class:"form-control"},s[10]||(s[10]=[e("option",{value:"purok1"},"Purok 1",-1),e("option",{value:"purok2"},"Purok 2",-1),e("option",{value:"purok3"},"Purok 3",-1),e("option",{value:"purok4"},"Purok 4",-1)]),512),[[I,o(r).purok]])]),e("div",pe,[s[13]||(s[13]=e("label",{class:"form-label"},"Select Deceased Member",-1)),S(e("select",{"onUpdate:modelValue":s[4]||(s[4]=t=>o(r).deceased_id=t),class:"form-control"},[s[12]||(s[12]=e("option",{disabled:"",value:""},"-- Select Deceased Member --",-1)),(a(!0),n(M,null,A(k.value,t=>(a(),n("option",{key:t.id,value:t.member_id},i(t.deceased_name),9,_e))),128))],512),[[I,o(r).deceased_id]])]),e("div",ve,[e("button",{type:"submit",class:"btn btn-success px-4 rounded-pill d-flex align-items-center gap-2",disabled:o(r).processing},[o(r).processing?(a(),n("span",ke)):$("",!0),U(" "+i(o(r).processing?"Submitting...":"Submit"),1)],8,fe)])],32)])])])]),s[15]||(s[15]=e("div",{class:"container-bottom"},null,-1))])]))}},ye={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},me={class:"modal-dialog",style:{"min-width":"60%"}},xe={class:"modal-content"},he={class:"modal-body"},$e={__name:"Header",setup(m){return(d,u)=>(a(),n("div",null,[u[1]||(u[1]=H('<div class="container-fluid d-flex flex-row justify-content-between align-items-center px-0 mb-2" data-v-31f09250><div data-v-31f09250><h6 class="mt-4 payment-contribution-text fs-5" style="transform:translateY(-20%);" data-v-31f09250><span class="d-none d-sm-none d-lg-inline" data-v-31f09250>Payment</span> Contribution</h6></div><div data-v-31f09250><button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#exampleModal" data-v-31f09250><span class="d-none d-sm-none d-lg-inline" data-v-31f09250>Add contribution</span><i class="bi bi-plus d-inline d-sm-inline d-lg-none" data-v-31f09250></i></button></div></div>',1)),e("div",ye,[e("div",me,[e("div",xe,[u[0]||(u[0]=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Add contribution"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",he,[y(ge)])])])])]))}},Me=V($e,[["__scopeId","data-v-31f09250"]]),L={__name:"Collector",props:{collectors:{type:Array,default:()=>[]},purok:{type:String,default:""}},setup(m){var v;const d=m,u=p("");return d.collectors.length!=0&&d.purok!=""?u.value=((v=d.collectors.find(f=>f.purok===d.purok.slice(-1)))==null?void 0:v.name)||"N/A":u.value="N/A",(f,k)=>(a(),n("div",null,[e("p",null,i(u.value),1)]))}},Ce={class:"main-container"},Ae={class:"bg-light p-2"},Ne={key:0,class:"mt-3"},Pe={key:1,class:"table-responsive mt-3 desktop-view"},De={class:"table table-bordered table-hover align-middle text-center"},Se={class:"scrollable-tbody"},we={class:"text-start"},Ie={key:0},Ue={key:1,class:"text-muted"},Ve={key:0,class:"badge bg-success"},Le={key:1,class:"text-muted"},Te={class:"pagination-controls d-flex align-items-center justify-content-end gap-2 mt-3"},je=["disabled"],Ee=["disabled"],Oe={key:2,class:"mobile-view"},Fe={class:"mobile-cards-container"},Be={class:"mobile-card-header"},Re={class:"mobile-member-id"},He={class:"mobile-status"},We={key:0,class:"badge bg-success"},ze={key:1,class:"text-muted"},Ge={class:"mobile-card-body"},Je={class:"mobile-field"},Ke={class:"mobile-value"},Ye={class:"mobile-field-group"},qe={class:"mobile-field"},Qe={class:"mobile-value"},Xe={class:"mobile-field"},Ze={class:"mobile-value"},et={class:"mobile-field"},tt={key:0,class:"mobile-value"},st={key:1,class:"text-muted"},ot={class:"mobile-field"},lt={class:"mobile-value"},nt={class:"mobile-pagination d-flex align-items-center justify-content-between mt-3"},at=["disabled"],rt=["disabled"],it={key:3,class:"container mt-4 text-center"},dt={class:"fw-light"},ut={class:"text-success"},ct={__name:"MemberContribution",props:{member:{type:Object,default:()=>({data:[],links:{},meta:{}})},selectedPurok:{type:String,default:()=>""},collectors:{type:Array,default:()=>[]},currentDeceasedMembers:{type:Array,default:()=>[]},currentDeceasedMember:{type:Object,default:()=>({})}},setup(m){const d=m;let u=p([]),v=p(""),f=p([]);const k=p([]),_=p({});C(()=>d.member,c=>{u.value=(c==null?void 0:c.data)||[]},{immediate:!0}),C(()=>d.selectedPurok,c=>{v.value=c},{immediate:!0}),C(()=>d.collectors,c=>{f.value=c},{immediate:!0}),C(()=>d.currentDeceasedMembers,c=>{k.value=c?Object.values(c):[]},{immediate:!0}),C(()=>d.currentDeceasedMember,c=>{_.value=c},{immediate:!0});const g=c=>{const l={year:"numeric",month:"long",day:"numeric"};return new Date(c).toLocaleDateString(void 0,l)};function r(c){return c==null?"N/A":parseFloat(c)}function N(c){c&&T.get(c,{},{preserveScroll:!0,preserveState:!0})}return(c,l)=>(a(),n(M,null,[y(o(W),{title:"Member contribution"}),e("div",null,[y(G,null,{default:z(()=>{var s;return[e("div",Ce,[e("div",Ae,[y(Me),y(Q,{activePurok:o(v),currentDeceasedId:(s=_.value)==null?void 0:s.member_id},null,8,["activePurok","currentDeceasedId"]),_.value?(a(),n("div",Ne,[y(J,{allDeceased:k.value,data:_.value,purok:o(v)},null,8,["allDeceased","data","purok"])])):$("",!0),Array.isArray(o(u))&&o(u).length>0?(a(),n("div",Pe,[e("table",De,[l[4]||(l[4]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"ID"),e("th",null,"NAME"),e("th",null,"AMOUNT"),e("th",null,"DATE"),e("th",null,"COLLECTOR"),e("th",null,"PUROK"),e("th",null,"STATUS")])],-1)),e("tbody",Se,[(a(!0),n(M,null,A(o(u),(t,P)=>{var x,h,b,D;return a(),n("tr",{key:P},[e("td",null,i(t==null?void 0:t.id),1),e("td",we,i(t==null?void 0:t.first_name)+" "+i(t==null?void 0:t.middle_name)+" "+i(t==null?void 0:t.last_name),1),e("td",null,i(r((x=t==null?void 0:t.contributions[0])==null?void 0:x.amount)),1),e("td",null,[(h=t==null?void 0:t.contributions[0])!=null&&h.payment_date?(a(),n("span",Ie,i(g((b=t==null?void 0:t.contributions[0])==null?void 0:b.payment_date)),1)):(a(),n("span",Ue,"..."))]),e("td",null,[y(L,{collectors:o(f),purok:t.purok},null,8,["collectors","purok"])]),e("td",null,i((t==null?void 0:t.purok)||"N/A"),1),e("td",null,[((D=t==null?void 0:t.contributions[0])==null?void 0:D.status)==="paid"?(a(),n("span",Ve,"Paid")):(a(),n("span",Le,"Unpaid"))])])}),128))])]),e("div",Te,[e("button",{class:"btn btn-outline-primary",disabled:!d.member.prev_page_url,onClick:l[0]||(l[0]=t=>N(d.member.prev_page_url))}," Previous ",8,je),e("button",{class:"btn btn-outline-primary",disabled:!d.member.next_page_url,onClick:l[1]||(l[1]=t=>N(d.member.next_page_url))}," Next ",8,Ee)])])):$("",!0),Array.isArray(o(u))&&o(u).length>0?(a(),n("div",Oe,[e("div",Fe,[(a(!0),n(M,null,A(o(u),(t,P)=>{var x,h,b,D;return a(),n("div",{class:"mobile-card",key:P},[e("div",Be,[e("div",Re,"ID: "+i(t==null?void 0:t.id),1),e("div",He,[((x=t==null?void 0:t.contributions[0])==null?void 0:x.status)==="paid"?(a(),n("span",We,"Paid")):(a(),n("span",ze,"Unpaid"))])]),e("div",Ge,[e("div",Je,[l[5]||(l[5]=e("label",null,"Name:",-1)),e("span",Ke,i(t==null?void 0:t.first_name)+" "+i(t==null?void 0:t.middle_name)+" "+i(t==null?void 0:t.last_name),1)]),e("div",Ye,[e("div",qe,[l[6]||(l[6]=e("label",null,"Amount:",-1)),e("span",Qe,i(r((h=t==null?void 0:t.contributions[0])==null?void 0:h.amount)),1)]),e("div",Xe,[l[7]||(l[7]=e("label",null,"Purok:",-1)),e("span",Ze,i((t==null?void 0:t.purok)||"N/A"),1)])]),e("div",et,[l[8]||(l[8]=e("label",null,"Date:",-1)),(b=t==null?void 0:t.contributions[0])!=null&&b.payment_date?(a(),n("span",tt,i(g((D=t==null?void 0:t.contributions[0])==null?void 0:D.payment_date)),1)):(a(),n("span",st,"..."))]),e("div",ot,[l[9]||(l[9]=e("label",null,"Collector:",-1)),e("span",lt,[y(L,{collectors:o(f),purok:t.purok},null,8,["collectors","purok"])])])])])}),128))]),e("div",nt,[e("button",{class:"btn btn-outline-primary btn-sm",disabled:!d.member.prev_page_url,onClick:l[2]||(l[2]=t=>N(d.member.prev_page_url))}," ← Previous ",8,at),e("button",{class:"btn btn-outline-primary btn-sm",disabled:!d.member.next_page_url,onClick:l[3]||(l[3]=t=>N(d.member.next_page_url))}," Next → ",8,rt)])])):(a(),n("div",it,[l[12]||(l[12]=e("img",{src:j,alt:"No Data",class:"not-found-image image-rounded"},null,-1)),e("h5",dt,[l[10]||(l[10]=U(" No contribution found in ")),e("span",ut,i(o(v)||"N/A"),1),l[11]||(l[11]=U(". "))])])),l[13]||(l[13]=e("div",{class:"container space-at-bottom"},null,-1))])])]}),_:1})])],64))}},gt=V(ct,[["__scopeId","data-v-7564f001"]]);export{gt as default};
