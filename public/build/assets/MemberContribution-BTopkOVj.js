import{_ as V}from"./not_found-DvAnRRcV.js";import{l as p,q as x,f as r,o as n,b as e,n as C,u as o,F as $,E as A,t as c,W as T,x as j,j as E,h as M,d as O,m as h,H as D,C as F,e as I,I as B,a as y,g as H,w as R}from"./app-lJPr0_lx.js";import{A as W}from"./AdminLayout-BfAzXtKV.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as q}from"./ToggleContribution-Bn2xHOHk.js";import"./logo1-BZ0h4foK.js";const z={class:"d-flex align-items-center gap-2 text-muted small"},K=["onClick"],G={__name:"Purok",props:{activePurok:{type:String,default:()=>""},currentDeceasedId:{type:[String,Number],default:null}},setup(k){const d=k;let u=p("");x(()=>d.activePurok,v=>{u.value=v},{immediate:!0});const b=["purok1","purok2","purok3","purok4"],f=v=>{T.get(route("contributions.togglePurok",{purok:v,deceasedId:d.currentDeceasedId}),{onSuccess:()=>console.log("changing purok"),onError:_=>console.log("An error occured: ",_)})};return(v,_)=>(n(),r("div",null,[e("div",z,[e("span",{class:C(["purok all-members-text",{"fw-bold active":o(u)=="all"}]),onClick:_[0]||(_[0]=g=>f("all"))},"ALL MEMBERS",2),e("div",null,[(n(),r($,null,A(b,g=>e("span",{key:g,class:C(["mx-2 purok",{"fw-bold active":g===o(u)}]),onClick:l=>f(g)},c(g),11,K)),64))])])]))}},J=U(G,[["__scopeId","data-v-80c37cd6"]]),Q={class:"contri-container py-1"},X={class:"row justify-content-center"},Y={class:"col-md-8"},Z={class:"card rounded-4 shadow-none border-0"},ee={class:"card-body p-4"},te={key:0,class:"alert alert-success text-center fw-semibold",role:"alert"},se={class:"mb-3"},oe=["value"],le={key:0,class:"invalid-feedback"},re={class:"mb-3"},ne={key:0,class:"invalid-feedback"},ae={class:"mb-3"},ie=["value"],de={key:0,class:"invalid-feedback"},ue={class:"mb-3"},ce={class:"mb-3"},pe=["value"],be={class:"d-flex justify-content-end"},_e=["disabled"],me={key:0,class:"spinner-border spinner-border-sm"},ve={__name:"AddContribution",setup(k){const d=p([]),u=p([]),b=p([]),f=p([]),v=p([]),_=p(!1),g=p(""),l=j({member_id:"",amount:100,payment_date:"",collector:"",status:"paid",purok:"",deceased_id:""});E(async()=>{try{const i=await B.get(route("contributions.members.data")),{members:s,users:t,deceasedMembers:w}=i.data;d.value=s||[],f.value=t||[],v.value=w||[];const P=(s||[]).map(m=>({id:m.id,fullName:`${m.first_name} ${m.middle_name??""} ${m.last_name}`.replace(/\s+/g," ").trim()})),S=(t||[]).map(m=>({id:m.id,fullName:m.name}));u.value=[...P,...S],b.value=(t||[]).filter(m=>m.role==="collector")}catch(i){console.error(i)}});const a=()=>{l.post(route("contributions.store"),{preserveScroll:!0,onSuccess:()=>{g.value="Contribution successfully created!",_.value=!0,setTimeout(()=>_.value=!1,3e3),l.reset()}})};return(i,s)=>(n(),r("div",null,[e("div",Q,[e("div",X,[e("div",Y,[e("div",Z,[s[14]||(s[14]=e("div",{class:"card-header text-center"},[e("h4",{class:"mb-0"},"Create Contribution")],-1)),e("div",ee,[_.value?(n(),r("div",te,c(g.value),1)):M("",!0),e("form",{onSubmit:O(a,["prevent"])},[e("div",se,[s[6]||(s[6]=e("label",{class:"form-label"},"Member Name",-1)),h(e("select",{"onUpdate:modelValue":s[0]||(s[0]=t=>o(l).member_id=t),class:C(["form-select",{"is-invalid":o(l).errors.member_id}])},[s[5]||(s[5]=e("option",{disabled:"",value:""},"-- Select Member --",-1)),(n(!0),r($,null,A(u.value,t=>(n(),r("option",{key:t.id,value:t.id},c(t.fullName),9,oe))),128))],2),[[D,o(l).member_id]]),o(l).errors.member_id?(n(),r("div",le,c(o(l).errors.member_id),1)):M("",!0)]),e("div",re,[s[7]||(s[7]=e("label",{class:"form-label"},"Payment Date",-1)),h(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>o(l).payment_date=t),type:"datetime-local",class:C(["form-control",{"is-invalid":o(l).errors.payment_date}])},null,2),[[F,o(l).payment_date]]),o(l).errors.payment_date?(n(),r("div",ne,c(o(l).errors.payment_date),1)):M("",!0)]),e("div",ae,[s[9]||(s[9]=e("label",{class:"form-label"},"Collector",-1)),h(e("select",{"onUpdate:modelValue":s[2]||(s[2]=t=>o(l).collector=t),class:C(["form-control",{"is-invalid":o(l).errors.collector}])},[s[8]||(s[8]=e("option",{disabled:"",value:""},"-- Select Collector --",-1)),(n(!0),r($,null,A(b.value,t=>(n(),r("option",{key:t.id,value:t.name},c(t.name),9,ie))),128))],2),[[D,o(l).collector]]),o(l).errors.collector?(n(),r("div",de,c(o(l).errors.collector),1)):M("",!0)]),e("div",ue,[s[11]||(s[11]=e("label",{class:"form-label"},"Purok",-1)),h(e("select",{"onUpdate:modelValue":s[3]||(s[3]=t=>o(l).purok=t),class:"form-control"},s[10]||(s[10]=[e("option",{value:"purok1"},"Purok 1",-1),e("option",{value:"purok2"},"Purok 2",-1),e("option",{value:"purok3"},"Purok 3",-1),e("option",{value:"purok4"},"Purok 4",-1)]),512),[[D,o(l).purok]])]),e("div",ce,[s[13]||(s[13]=e("label",{class:"form-label"},"Select Deceased Member",-1)),h(e("select",{"onUpdate:modelValue":s[4]||(s[4]=t=>o(l).deceased_id=t),class:"form-control"},[s[12]||(s[12]=e("option",{disabled:"",value:""},"-- Select Deceased Member --",-1)),(n(!0),r($,null,A(v.value,t=>(n(),r("option",{key:t.id,value:t.member_id},c(t.deceased_name),9,pe))),128))],512),[[D,o(l).deceased_id]])]),e("div",be,[e("button",{type:"submit",class:"btn btn-success px-4 rounded-pill d-flex align-items-center gap-2",disabled:o(l).processing},[o(l).processing?(n(),r("span",me)):M("",!0),I(" "+c(o(l).processing?"Submitting...":"Submit"),1)],8,_e)])],32)])])])]),s[15]||(s[15]=e("div",{class:"container-bottom"},null,-1))])]))}},fe={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},ge={class:"modal-dialog",style:{"min-width":"60%"}},ke={class:"modal-content"},ye={class:"modal-body"},xe={__name:"Header",setup(k){return(d,u)=>(n(),r("div",null,[u[1]||(u[1]=e("div",{class:"container-fluid d-flex flex-row justify-content-between align-items-center px-0 mb-2"},[e("div",null,[e("h6",{class:"mt-4 payment-contribution-text fs-5"},"Payment Contribution")]),e("div",null,[e("button",{class:"btn btn-success","data-bs-toggle":"modal","data-bs-target":"#exampleModal"},"Add contribution")])],-1)),e("div",fe,[e("div",ge,[e("div",ke,[u[0]||(u[0]=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Add contribution"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",ye,[y(ve)])])])])]))}},$e=U(xe,[["__scopeId","data-v-292e65eb"]]),Me={__name:"Collector",props:{collectors:{type:Array,default:()=>[]},purok:{type:String,default:""}},setup(k){var b;const d=k,u=p("");return d.collectors.length!=0&&d.purok!=""?u.value=((b=d.collectors.find(f=>f.purok===d.purok.slice(-1)))==null?void 0:b.name)||"N/A":u.value="N/A",(f,v)=>(n(),r("div",null,[e("p",null,c(u.value),1)]))}},he={class:"main-container"},Ce={class:"bg-light p-2"},Ae={key:0,class:"table-responsive mt-3"},Pe={class:"table table-bordered table-hover align-middle text-center"},Se={class:"scrollable-tbody"},De={class:"text-start"},Ne={key:0},we={key:1,class:"text-muted"},Ie={key:0,class:"badge bg-success"},Ue={key:1,class:""},Le={class:"pagination-controls d-flex align-items-center justify-content-end gap-2 mt-3"},Te=["disabled"],Ve=["disabled"],je={key:1,class:"container mt-4 text-center"},Ee={class:"fw-light"},Oe={class:"text-success"},Fe={__name:"MemberContribution",props:{member:{type:Object,default:()=>({data:[],links:{},meta:{}})},selectedPurok:{type:String,default:()=>""},collectors:{type:Array,default:()=>[]},currentDeceasedMembers:{type:Array,default:()=>[]},currentDeceasedMember:{type:Object,default:()=>({})}},setup(k){const d=k;let u=p([]),b=p(""),f=p([]);const v=p([]),_=p({});x(()=>d.member,a=>{u.value=(a==null?void 0:a.data)||[]},{immediate:!0}),x(()=>d.selectedPurok,a=>{b.value=a},{immediate:!0}),x(()=>d.collectors,a=>{f.value=a},{immediate:!0}),x(()=>d.currentDeceasedMembers,a=>{v.value=a?Object.values(a):[]},{immediate:!0}),x(()=>d.currentDeceasedMember,a=>{_.value=a},{immediate:!0});const g=a=>{const i={year:"numeric",month:"long",day:"numeric"};return new Date(a).toLocaleDateString(void 0,i)};function l(a){return a==null?"N/A":parseFloat(a)}function N(a){a&&T.get(a,{},{preserveScroll:!0,preserveState:!0})}return(a,i)=>(n(),r($,null,[y(o(H),{title:"Member contribution"}),e("div",null,[y(W,null,{default:R(()=>{var s;return[e("div",he,[e("div",Ce,[y($e),y(J,{activePurok:o(b),currentDeceasedId:(s=_.value)==null?void 0:s.member_id},null,8,["activePurok","currentDeceasedId"]),y(q,{allDeceased:v.value,data:_.value,purok:o(b)},null,8,["allDeceased","data","purok"]),Array.isArray(o(u))&&o(u).length>0?(n(),r("div",Ae,[e("table",Pe,[i[2]||(i[2]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"ID"),e("th",null,"NAME"),e("th",null,"AMOUNT"),e("th",null,"DATE"),e("th",null,"COLLECTOR"),e("th",null,"PUROK"),e("th",null,"STATUS")])],-1)),e("tbody",Se,[(n(!0),r($,null,A(o(u),(t,w)=>{var P,S,m,L;return n(),r("tr",{key:w},[e("td",null,c(t==null?void 0:t.id),1),e("td",De,c(t==null?void 0:t.first_name)+" "+c(t==null?void 0:t.middle_name)+" "+c(t==null?void 0:t.last_name),1),e("td",null,c(l((P=t==null?void 0:t.contributions[0])==null?void 0:P.amount)),1),e("td",null,[(S=t==null?void 0:t.contributions[0])!=null&&S.payment_date?(n(),r("span",Ne,c(g((m=t==null?void 0:t.contributions[0])==null?void 0:m.payment_date)),1)):(n(),r("span",we,"..."))]),e("td",null,[y(Me,{collectors:o(f),purok:t.purok},null,8,["collectors","purok"])]),e("td",null,c((t==null?void 0:t.purok)||"N/A"),1),e("td",null,[((L=t==null?void 0:t.contributions[0])==null?void 0:L.status)==="paid"?(n(),r("span",Ie,"Paid")):(n(),r("span",Ue,"Unpaid"))])])}),128))])]),e("div",Le,[e("button",{class:"btn btn-outline-primary",disabled:!d.member.prev_page_url,onClick:i[0]||(i[0]=t=>N(d.member.prev_page_url))}," Previous ",8,Te),e("button",{class:"btn btn-outline-primary",disabled:!d.member.next_page_url,onClick:i[1]||(i[1]=t=>N(d.member.next_page_url))}," Next ",8,Ve)])])):(n(),r("div",je,[i[5]||(i[5]=e("img",{src:V,alt:"No Data",class:"not-found-image image-rounded"},null,-1)),e("h5",Ee,[i[3]||(i[3]=I(" No contribution found in ")),e("span",Oe,c(o(b)||"N/A"),1),i[4]||(i[4]=I(". "))])])),i[6]||(i[6]=e("div",{class:"container space-at-bottom"},null,-1))])])]}),_:1})])],64))}},Ke=U(Fe,[["__scopeId","data-v-17f53d98"]]);export{Ke as default};
