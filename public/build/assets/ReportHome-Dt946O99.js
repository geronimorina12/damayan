import{A as B}from"./AdminLayout-Da8BGDln.js";import{r,s as w,l as N,f as c,o as d,b as e,F as $,G as A,e as P,t as u,x as O,i as C,D as x,u as a,n as y,I as T,h as M,d as F,j as I,J as U,a as D,g as H,w as z,c as V}from"./app-YM487_xA.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{h as j}from"./html2pdf-Da6tlUZY.js";import"./logo1-BZ0h4foK.js";const Y={key:0,class:"mb-4"},G={class:"container"},K={class:"table-responsive-wrapper"},q={class:"responsive-table"},J={"data-label":"Collector"},Z={"data-label":"Purok"},Q={"data-label":"Assigned Members"},W={"data-label":"Paid"},X={"data-label":"Unpaid"},ee={key:1,class:"container text-muted text-center"},te={__name:"ContributionReportForAdmin",props:{contributions:{type:Array,default:()=>[]}},setup(g){const _=g,o=r([]),v=r([]),p=r([]),m=r([]),f=r([]),s=r([]);w(()=>_.contributions,k=>{o.value=k,v.value=o.value.filter(i=>i.purok=="purok1"),p.value=o.value.filter(i=>i.purok=="purok2"),m.value=o.value.filter(i=>i.purok=="purok3"),f.value=o.value.filter(i=>i.purok=="purok4")},{immediate:!0});const b=async()=>{try{const k=await axios.get("/members");s.value=k.data;const i=s.value.filter(n=>n.purok.toLowerCase().replace(/\s/g,"")==="purok1"),h=s.value.filter(n=>n.purok.toLowerCase().replace(/\s/g,"")==="purok2"),l=s.value.filter(n=>n.purok.toLowerCase().replace(/\s/g,"")==="purok3"),t=s.value.filter(n=>n.purok.toLowerCase().replace(/\s/g,"")==="purok4");v.value=i.length,p.value=h.length,m.value=l.length,f.value=t.length,console.log("Purok 1:",v.value),console.log("Purok 2:",p.value),console.log("Purok 3:",m.value),console.log("Purok 4:",f.value)}catch(k){console.error("Error fetching members:",k)}};return N(()=>{b()}),(k,i)=>(d(),c("div",null,[o.value.length>0?(d(),c("div",Y,[e("div",G,[e("div",K,[e("table",q,[i[1]||(i[1]=e("thead",{class:"table-light"},[e("tr",null,[e("th",{"data-label":"Collector"},"COLLECTOR"),e("th",{"data-label":"Purok"},"PUROK"),e("th",{"data-label":"Assigned Members"},"ASSIGNED MEMBERS"),e("th",{"data-label":"Paid"},"PAID"),e("th",{"data-label":"Unpaid"},"UNPAID")])],-1)),e("tbody",null,[(d(!0),c($,null,A(g.contributions,(h,l)=>(d(),c("tr",{key:l},[e("td",J,[i[0]||(i[0]=e("i",{class:"bi bi-person me-2"},null,-1)),P(u(h.collector),1)]),e("td",Z,u(h.purok),1),e("td",Q,u(h.members),1),e("td",W,u(h.paid),1),e("td",X,u(h.members-h.paid),1)]))),128))])])]),i[2]||(i[2]=e("div",{class:"container w-50 h-50"},null,-1))])])):(d(),c("div",ee,i[3]||(i[3]=[e("p",null,"No contribution data.",-1)])))]))}},oe=R(te,[["__scopeId","data-v-4799b3ea"]]),se={key:0,class:"container"},le={class:"table-responsive-wrapper"},ae={class:"responsive-table"},ne={"data-label":"Amount"},re={"data-label":"Members"},de={"data-label":"Collector"},ie={"data-label":"Purok"},ue={key:1,class:"container text-muted text-center"},ce={__name:"RecentContributionForAdmin",props:{recent:{type:Array,default:()=>[]}},setup(g){const _=g,o=r([]);return w(()=>_.recent,v=>{o.value=v},{immediate:!0}),(v,p)=>(d(),c("div",null,[o.value.length>0?(d(),c("div",se,[e("div",le,[e("table",ae,[p[0]||(p[0]=e("thead",{class:"table-light"},[e("tr",null,[e("th",{"data-label":"Amount"},"AMOUNT"),e("th",{"data-label":"Members"},"MEMBERS"),e("th",{"data-label":"Collector"},"COLLECTOR"),e("th",{"data-label":"Purok"},"PUROK")])],-1)),e("tbody",null,[(d(!0),c($,null,A(g.recent,(m,f)=>(d(),c("tr",{key:f},[e("td",ne,u(m.total_amount),1),e("td",re,u(m.members),1),e("td",de,u(m.collector),1),e("td",ie,u(m.purok),1)]))),128))])])])])):(d(),c("div",ue,p[1]||(p[1]=[e("p",null,"No recent contribution data.",-1)])))]))}},pe=R(ce,[["__scopeId","data-v-a455ffd6"]]),me={class:"container"},be={class:"mb-3"},ve={class:"invalid-feedback"},_e={class:"mb-3"},fe={class:"invalid-feedback"},he={class:"mb-3"},ke={class:"invalid-feedback"},ge={class:"mb-3"},Ce={class:"mb-3"},we=["value"],ye={class:"invalid-feedback"},$e=["disabled"],Ae={key:0,class:"spinner-border spinner-border-sm me-1"},Me={__name:"AddCollector",emits:["submitted"],setup(g,{emit:_}){const o=O({name:"",email:"",password:"",role:"collector",purok:"1"}),v=_,p=["1","2","3","4"],m=()=>{o.post(route("reports.storeCollector"),{onSuccess:()=>{o.reset(),v("submitted"),alert("Collector added successfully!")},onError:f=>console.log(f)})};return(f,s)=>(d(),c("div",me,[e("form",{onSubmit:F(m,["prevent"]),class:"bg-white rounded"},[e("div",be,[s[5]||(s[5]=e("label",{for:"name",class:"form-label"},"Name",-1)),C(e("input",{type:"text",id:"name","onUpdate:modelValue":s[0]||(s[0]=b=>a(o).name=b),class:y(["form-control",{"is-invalid":a(o).errors.name}])},null,2),[[x,a(o).name]]),e("div",ve,u(a(o).errors.name),1)]),e("div",_e,[s[6]||(s[6]=e("label",{for:"email",class:"form-label"},"Email",-1)),C(e("input",{type:"email",id:"email","onUpdate:modelValue":s[1]||(s[1]=b=>a(o).email=b),class:y(["form-control",{"is-invalid":a(o).errors.email}])},null,2),[[x,a(o).email]]),e("div",fe,u(a(o).errors.email),1)]),e("div",he,[s[7]||(s[7]=e("label",{for:"password",class:"form-label"},"Password",-1)),C(e("input",{type:"password",id:"password","onUpdate:modelValue":s[2]||(s[2]=b=>a(o).password=b),class:y(["form-control",{"is-invalid":a(o).errors.password}])},null,2),[[x,a(o).password]]),e("div",ke,u(a(o).errors.password),1)]),e("div",ge,[s[8]||(s[8]=e("label",{for:"role",class:"form-label"},"Role",-1)),C(e("input",{type:"text",id:"role","onUpdate:modelValue":s[3]||(s[3]=b=>a(o).role=b),class:"form-control",readonly:""},null,512),[[x,a(o).role]])]),e("div",Ce,[s[10]||(s[10]=e("label",{for:"purok",class:"form-label"},"Purok",-1)),C(e("select",{id:"purok","onUpdate:modelValue":s[4]||(s[4]=b=>a(o).purok=b),class:y(["form-select",{"is-invalid":a(o).errors.purok}])},[s[9]||(s[9]=e("option",{disabled:"",value:""},"Select Purok",-1)),(d(),c($,null,A(p,b=>e("option",{key:b,value:b},u(b),9,we)),64))],2),[[T,a(o).purok]]),e("div",ye,u(a(o).errors.purok),1)]),e("button",{type:"submit",class:"btn btn-primary",disabled:a(o).processing},[a(o).processing?(d(),c("span",Ae)):M("",!0),s[11]||(s[11]=P(" Submit "))],8,$e)],32)]))}},Re=R(Me,[["__scopeId","data-v-ff4066de"]]),xe={key:0,class:"select-wrapper"},De={class:"select-box"},Ne=["value"],Pe={key:1},Ee={class:"header"},Se={class:"deceased-name"},Le={class:"table-container"},Ue={class:"members-table"},Ve={class:"total-amount"},Te={__name:"View",setup(g){const _=r([]),o=r(null);r(null);const v=r(""),p=r(!1),m=r([]),f=r(null),s=async l=>{try{const t=await U.get(`/reports/contributions/${l}`);m.value=t.data.contributions}catch(t){console.error("Error fetching contributions:",t)}};N(async()=>{try{const l=await U.get("/reports/deceased");_.value=l.data.deceased}catch(l){console.error("An error occurred while fetching deceased:",l)}});const k=()=>{s(o.value);const l=_.value.find(t=>t.member_id==o.value);v.value=(l==null?void 0:l.deceased_name)||"",p.value=!0},i=I(()=>m.value.reduce((l,t)=>l+parseFloat(t.amount||0),0)),h=()=>{const l=f.value,t={filename:`${v.value}_Report.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}};j().from(l).set(t).save()};return(l,t)=>(d(),c($,null,[p.value?M("",!0):(d(),c("div",xe,[t[2]||(t[2]=e("label",{class:"select-label"},"Select Deceased Member:",-1)),e("div",De,[C(e("select",{"onUpdate:modelValue":t[0]||(t[0]=n=>o.value=n),onChange:k},[t[1]||(t[1]=e("option",{disabled:"",value:""},"Select...",-1)),(d(!0),c($,null,A(_.value,n=>(d(),c("option",{key:n.member_id,value:n.member_id},u(n.deceased_name),9,Ne))),128))],544),[[T,o.value]])])])),p.value?(d(),c("div",Pe,[e("button",{onClick:h,class:"download-btn",title:"Download PDF"},t[3]||(t[3]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:`M12 3a1 1 0 011 1v9.586l3.293-3.293a1 1 0 011.414 1.414l-5 
            5a1 1 0 01-1.414 0l-5-5a1 1 0 
            011.414-1.414L11 13.586V4a1 1 0 011-1zm-7 
            14a1 1 0 100 2h14a1 1 0 100-2H5z`})],-1)])),e("div",{ref_key:"pdfContent",ref:f,class:"document-container"},[e("div",Ee,[t[4]||(t[4]=e("div",{class:"organization-name"},"BULAN P.R.O.T.E.C DAMAYAN FEDERATION",-1)),t[5]||(t[5]=e("div",{class:"organization-subtitle"},"(People's Responsible Organization Transforming Community)",-1)),t[6]||(t[6]=e("div",{class:"chapter-info"},"Affiliated Bulan, Sorsogon Chapter Brgy. ______ C.Y 2021",-1)),t[7]||(t[7]=e("div",{class:"established"},"Since 2016",-1)),e("div",Se," Deceased Name: "+u(v.value),1)]),e("div",Le,[t[9]||(t[9]=e("div",{class:"mb-3"},[e("strong",null,"MEMBERS")],-1)),e("table",Ue,[t[8]||(t[8]=e("thead",null,[e("tr",null,[e("th",null,"No."),e("th",null,"NAME"),e("th",null,"STATUS"),e("th",null,"AMOUNT")])],-1)),e("tbody",null,[(d(!0),c($,null,A(m.value,(n,E)=>{var S,L;return d(),c("tr",{key:E},[e("td",null,u(E+1),1),e("td",null,u(((S=n==null?void 0:n.member_contribution)==null?void 0:S.first_name)||"member")+" "+u(((L=n==null?void 0:n.member_contribution)==null?void 0:L.last_name)||""),1),e("td",null,u(n.status),1),e("td",null,u(Math.floor(n.amount)||"0"),1)])}),128))])]),e("div",Ve," TOTAL AMOUNT: â‚±"+u(i.value.toLocaleString()),1)]),t[10]||(t[10]=e("div",{class:"signature"},[e("div",null,"Noted By:"),e("div",{class:"president-name"},"Melva Canale Delariarte"),e("div",null,"DAMAYAN PRESIDENT")],-1))],512)])):M("",!0)],64))}},Be=R(Te,[["__scopeId","data-v-5599dfff"]]),Oe={class:"modern-report-container"},Fe={class:"tab-navigation"},Ie={class:"content-area"},He={class:"modal fade",id:"viewReportModal",tabindex:"-1","aria-labelledby":"viewReportModalLabel","aria-hidden":"true"},ze={class:"modal-dialog modern-modal-dialog"},je={class:"modal-content modern-modal-content"},Ye={class:"modal-body"},Ge={class:"modal fade",id:"addCollectorModal",tabindex:"-1","aria-labelledby":"addCollectorModalLabel","aria-hidden":"true"},Ke={class:"modal-dialog",style:{"max-width":"700px"}},qe={class:"modal-content"},Je={class:"modal-body"},Ze={__name:"ReportHome",props:{contributions:{type:Array,default:()=>[]},memberContributions:{type:Array,default:()=>[]},deathReports:{type:Array,default:()=>[]},president:{type:Object,default:()=>({})}},setup(g){const _=g;let o=r([]),v=r(!0),p=r(!1),m=r([]),f=r([]);r(!1),r(null);let s=r(0);r(null);const b=r("");w(()=>_.contributions,l=>{o.value=l},{immediate:!0}),w(()=>_.memberContributions,l=>{m.value=l.filter(t=>t.member_contribution!==null),console.log("member contributions:",m.value),s.value=m.value.reduce((t,n)=>t+Number(n.amount||0),0)},{immediate:!0}),w(()=>_.deathReports,l=>{f.value=l},{immediate:!0}),w(()=>_.president,l=>{b.value=l==null?void 0:l.name},{immediate:!0});const k=()=>{p.value=!0,v.value=!1},i=()=>{p.value=!1,v.value=!0};N(()=>{document.getElementById("addCollectorModal")});const h=()=>{};return(l,t)=>(d(),c("div",null,[D(a(H),{title:"Report"}),D(B,null,{default:z(()=>[e("div",Oe,[t[2]||(t[2]=e("div",{class:"modern-header"},[e("div",{class:"header-content"},[e("h5",{class:"fw-light"},"Reports Dashboard")]),e("div",{class:"header-actions"},[e("button",{class:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#viewReportModal"},[e("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M9 17H15",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"}),e("path",{d:"M9 13H15",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"}),e("path",{d:"M9 9H13",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"}),e("path",{d:"M3 5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H19C19.5304 3 20.0391 3.21071 20.4142 3.58579C20.7893 3.96086 21 4.46957 21 5V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V5Z",stroke:"currentColor","stroke-width":"2"})]),P(" View Reports ")])])],-1)),e("div",Fe,[e("button",{class:y(a(p)?"tab-btn active":"tab-btn"),onClick:k}," Recent Contributions ",2),e("button",{class:y(a(v)?"tab-btn active":"tab-btn"),onClick:i}," Contributions Report ",2)]),e("div",Ie,[a(v)?(d(),V(oe,{key:0,contributions:a(o)},null,8,["contributions"])):M("",!0),a(p)?(d(),V(pe,{key:1,recent:a(o)},null,8,["recent"])):M("",!0)]),e("div",He,[e("div",ze,[e("div",je,[t[0]||(t[0]=e("div",{class:"modal-header modern-modal-header"},[e("div",{class:"header-content"}),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",Ye,[D(Be)])])])]),e("div",Ge,[e("div",Ke,[e("div",qe,[t[1]||(t[1]=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"addCollectorModalLabel"}," Add Collector "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",Je,[D(Re,{onSubmitted:h})])])])]),t[3]||(t[3]=e("div",{class:"extra-space"},null,-1))])]),_:1})]))}},ot=R(Ze,[["__scopeId","data-v-279a1c35"]]);export{ot as default};
