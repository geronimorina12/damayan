import{r as o,s as C,f as i,o as d,b as e,F as V,G as P,e as D,n as E,t as c,W as p,j as B,a as $,u as L,g as j,w as W,i as q,h as T,D as z,E as G}from"./app-BrCd4CiO.js";import{A as J}from"./AdminLayout-DjuTBwzp.js";import{_ as S}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./logo1-BZ0h4foK.js";const Q={class:"card mt-4"},H={class:"card-body"},K={class:"table-responsive"},O={class:"table table-bordered align-middle"},X={class:"btn btn-sm btn-light"},Y=["onClick"],Z={class:"modal fade",id:"action",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},ee={class:"modal-dialog"},te={class:"modal-content"},se={class:"modal-footer"},le={class:"container-fluid"},ae={class:"col"},oe={__name:"RoleAndPermissionTable",props:{users:{type:Array,default:()=>[]}},setup(x){const h=x,n=o([]),m=o(0),u=o(0),r=o(0),v=o(0),f=o(0),y=o(0),_=o(0),b=o(null);C(()=>h.users,g=>{n.value=g,m.value=n.value.filter(l=>l.role==="admin").length,u.value=n.value.filter(l=>l.position==="secretary").length,r.value=n.value.filter(l=>l.position==="president").length,v.value=n.value.filter(l=>l.position==="vise_president").length,f.value=n.value.filter(l=>l.position==="purok_leader").length,y.value=n.value.filter(l=>l.position==="treasurer").length,_.value=n.value.filter(l=>l.position==="colector").length},{immediate:!0});const k=[{name:"Admin",description:"Full access",users:m.value+(m.value>1?" users":" user"),access:"Full modules",icon:"bi bi-person"},{name:"Collector",description:"Jurisdiction-based",users:4,access:"Status updates",icon:"bi bi-people"}],w=()=>{if(!b.value){alert("No role selected. Please select a role to view.");return}p.get(route("role.viewSpecificRole",{role:b.value})),b.value=null};return(g,l)=>(d(),i("div",null,[e("div",Q,[e("div",H,[l[2]||(l[2]=e("h6",{class:"fw-semibold"},"Roles and Permissions",-1)),e("div",K,[e("table",O,[l[1]||(l[1]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"Role"),e("th",null,"Description"),e("th",null,"Users"),e("th",null,"Access"),e("th")])],-1)),e("tbody",null,[(d(),i(V,null,P(k,(s,t)=>e("tr",{key:t},[e("td",null,[e("i",{class:E(s.icon)},null,2),D(" "+c(s.name),1)]),e("td",null,c(s.description),1),e("td",null,c(s.users),1),e("td",null,c(s.access),1),e("td",null,[e("button",X,[e("i",{class:"bi bi-three-dots-vertical","data-bs-toggle":"modal","data-bs-target":"#action",onClick:a=>b.value=s.name.toLocaleLowerCase()},null,8,Y)])])])),64))])])])])]),e("div",Z,[e("div",ee,[e("div",te,[l[3]||(l[3]=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"}," Action "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",se,[e("div",le,[e("div",ae,[e("button",{type:"button",class:"btn btn-primary w-100","data-bs-dismiss":"modal",onClick:l[0]||(l[0]=s=>w())}," View All ")])])])])])])]))}},ne=S(oe,[["__scopeId","data-v-72122ad6"]]),ie={class:"container mt-4 role-container"},de={class:"card mt-3"},re={class:"card-body"},ue={class:"container-fluid d-flex align-items-center justify-content-between px-0"},ce={class:"search-box mb-3 position-relative"},me={key:0,class:"spinner-border text-primary spinner-sm position-absolute end-0 top-50 translate-middle-y me-3",role:"status"},ve={class:"table-responsive"},be={class:"table table-bordered align-middle"},pe={key:0},fe={key:0},ye={key:1},he={class:"btn btn-sm btn-light"},_e=["onClick"],ge={class:"modal fade",id:"action1Modal",tabindex:"-1","aria-labelledby":"actionModalLabel","aria-hidden":"true"},Ce={class:"modal-dialog modal-dialog-centered"},xe={class:"modal-content modern-modal"},ke={class:"modal-footer modern-footer"},we={class:"action-buttons"},Ae={__name:"Index",props:{users:{type:Array,default:()=>[]},admins:{type:Array,default:()=>[]}},setup(x){const h=x;let n=o([]),m=o([]),u=o(null),r=o("");const v=o(""),f=o(!1);o(""),C(()=>h.admins,s=>{m.value=s},{immediate:!0}),C(()=>h.users,s=>{n.value=[...s,...m.value]},{immediate:!0});const y=B(()=>{const s=v.value.trim().toLowerCase();return s?n.value.filter(t=>{var M,U,F,N;const a=((M=t.name)==null?void 0:M.toLowerCase())||"",A=((U=t.email)==null?void 0:U.toLowerCase())||"",R=((F=t.role)==null?void 0:F.toLowerCase())||"",I=((N=t.position)==null?void 0:N.toLowerCase())||"";return a.includes(s)||A.includes(s)||R.includes(s)||I.includes(s)}):n.value});let _;C(v,()=>{f.value=!0,clearTimeout(_),_=setTimeout(()=>{f.value=!1},400)});const b=(s,t)=>{u.value=s,r.value=t},k=()=>{r.value==="admin"||r.value==="collector"?p.get(route("role.edit",{user:u.value})):p.get(route("role.official.edit",{official:u.value}))},w=()=>{r.value==="admin"||r.value==="collector"?p.get(route("role.viewUser",{user:u.value})):p.get(route("role.official.view",{official:u.value}))},g=()=>{confirm("Are you sure you want to delete this user?")&&p.delete(route("role.deleteUser",{user:u.value}),{onSuccess:()=>{alert("User deleted successfully.")},onError:s=>{console.error("Failed to delete user.",s)}})},l=(s,t)=>s==="collector"||t==="collector"?"Status updates":s==="admin"||t==="president"?"Full modules":s==="secretary"||t==="secretary"?"Records and Reports":s==="vise_president"||t==="vise_president"?"Review and Approval":"N/A";return(s,t)=>(d(),i("div",null,[$(L(j),{title:"Role Management"}),$(J,null,{default:W(()=>[e("div",ie,[t[8]||(t[8]=e("h5",{class:"fw-light"},"User and Role Management",-1)),e("div",de,[e("div",re,[e("div",ue,[t[5]||(t[5]=e("div",null,[e("h6",{class:"fw-semibold"},"User Management")],-1)),e("div",ce,[q(e("input",{type:"text",class:"form-control search-input",placeholder:"Search...","onUpdate:modelValue":t[0]||(t[0]=a=>v.value=a)},null,512),[[z,v.value]]),f.value?(d(),i("div",me,t[4]||(t[4]=[e("span",{class:"visually-hidden"},"Loading...",-1)]))):T("",!0)])]),e("div",ve,[e("table",be,[t[7]||(t[7]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"NAME"),e("th",null,"EMAIL"),e("th",null,"Role"),e("th",null,"Access"),e("th")])],-1)),e("tbody",null,[y.value.length===0?(d(),i("tr",pe,t[6]||(t[6]=[e("td",{colspan:"6",class:"text-center text-muted py-3"}," No users found. ",-1)]))):T("",!0),(d(!0),i(V,null,P(y.value,(a,A)=>(d(),i("tr",{key:A},[e("td",null,c(a.name),1),e("td",null,c(a.email||"N/A"),1),e("td",null,[a.position==="vice_president"?(d(),i("span",fe,"vice President")):(d(),i("span",ye,c((a==null?void 0:a.role)||(a==null?void 0:a.position)),1))]),e("td",null,c(l(a.role,a.position)),1),e("td",null,[e("button",he,[e("i",{class:"bi bi-three-dots-vertical action1","data-bs-toggle":"modal","data-bs-target":"#action1Modal",onClick:R=>b(a.id,a.role||a.position)},null,8,_e)])])]))),128))])])])])]),$(ne,{users:y.value},null,8,["users"]),t[9]||(t[9]=e("div",{class:"bottom-role-container container"},null,-1))])]),_:1}),e("div",ge,[e("div",Ce,[e("div",xe,[t[14]||(t[14]=G('<div class="modal-header modern-header" data-v-ee9f8853><div class="header-content" data-v-ee9f8853><i class="modal-icon fas fa-exclamation-circle" data-v-ee9f8853></i><h2 class="modal-title text-dark" id="actionModalLabel" data-v-ee9f8853>Confirm Action</h2></div><button type="button" class="btn-close modern-close" data-bs-dismiss="modal" aria-label="Close" data-v-ee9f8853><i class="bi bi-x-lg text-dark" data-v-ee9f8853></i></button></div><div class="modal-body modern-body" data-v-ee9f8853><p data-v-ee9f8853> Please select an action to perform. <span class="text-danger" data-v-ee9f8853>This action cannot be undone.</span></p></div>',2)),e("div",ke,[e("div",we,[L(r)=="admin"||L(r)=="president"?(d(),i("button",{key:0,type:"button",class:"btn btn-edit text-dark","data-bs-dismiss":"modal",onClick:t[1]||(t[1]=a=>k())},t[10]||(t[10]=[e("i",{class:"fas fa-edit"},null,-1),e("span",null,"Update",-1)]))):(d(),i("button",{key:1,type:"button",class:"btn btn-edit text-dark","data-bs-dismiss":"modal",onClick:t[2]||(t[2]=a=>w())},t[11]||(t[11]=[e("i",{class:"fas fa-eye"},null,-1),e("span",null,"View",-1)]))),e("button",{type:"button",class:"btn btn-delete text-dark","data-bs-dismiss":"modal",onClick:t[3]||(t[3]=a=>g())},t[12]||(t[12]=[e("i",{class:"fas fa-trash-alt"},null,-1),e("span",null,"Delete",-1)])),t[13]||(t[13]=e("button",{type:"button",class:"btn btn-cancel text-dark","data-bs-dismiss":"modal"},[e("i",{class:"fas fa-times"}),e("span",null,"Cancel")],-1))])])])])])]))}},Ue=S(Ae,[["__scopeId","data-v-ee9f8853"]]);export{Ue as default};
