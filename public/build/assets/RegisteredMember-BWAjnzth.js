import{l as g,x as G,f as b,o as v,b as e,h as M,e as V,t as m,d as N,m as _,C as y,u as o,H as j,F as I,E as D,j as K,I as ne,a as k,q as U,n as O,i as Q,w as B,T as Y,S as W,W as R,k as ae,g as de,J as ie,y as re}from"./app-lJPr0_lx.js";import{A as ue}from"./AdminLayout-BfAzXtKV.js";import{_ as T}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./logo1-BZ0h4foK.js";const ce={class:"container-fluid d-flex flex-row justify-content-center main-container"},me={class:"container mt-5"},pe={key:0,class:"alert alert-success alert-dismissible fade show",role:"alert"},be={class:"row mb-3 d-flex align-items-center"},ve={class:"col col-6"},fe={class:"col col-6"},_e={class:"row mb-3"},ge={class:"col col-6"},ye={class:"col col-6"},he={class:"row mb-3"},$e={class:"col col-6"},xe={class:"col col-6"},we={class:"row mb-3"},ke={class:"col col-6"},Me={class:"col col-6"},Ce={class:"row mb-3"},Ae={class:"col col-6"},Se={class:"col col-6"},Ve={key:0,class:"text-danger mt-1"},Ue={class:"row mb-3"},Ne={class:"col col-6"},Ee={key:0,class:"container text-center mt-5 fs-4"},Be={key:1},Le={class:"table table-responsive bg-light"},qe=["onClick"],Re={class:"container-fluid d-flex flex-row justify-content-between align-items-center mt-4"},Ie={key:1,class:"card mt-4 p-3 shadow-sm"},Te={class:"d-flex justify-content-end gap-2 mt-3"},je={__name:"AddNewMember",setup(A){const c=g({name:"",relation:"",age:"",birth_date:""}),n=g([]),r=g(!1),s=g(""),a=G({first_name:"",last_name:"",address:"",contact_number:"",date_of_birth:"",purok:"",age:"",middle_name:"",status:"",occupation:"",gender:"",beneficiaries:[]}),$=()=>{if(a.clearErrors(),!/^0\d{10}$/.test(a.contact_number)){a.setError("contact_number","Contact number must start with 0 and be exactly 11 digits.");return}a.beneficiaries=n.value,a.post(route("addMemberPost"),{onSuccess:()=>{s.value=" Member added successfully!",setTimeout(()=>{s.value=""},4e3)},onError:t=>console.log("An error occurred => ",t)})},h=()=>{n.value.push({...c.value}),c.value={name:"",relation:"",age:"",birth_date:""},r.value=!1},w=l=>{n.value.splice(l,1)},u=l=>{const t={year:"numeric",month:"long",day:"numeric"};return new Date(l).toLocaleDateString(void 0,t)};return(l,t)=>(v(),b("div",ce,[e("div",me,[s.value?(v(),b("div",pe,[V(m(s.value)+" ",1),e("button",{type:"button",class:"btn-close",onClick:t[0]||(t[0]=d=>s.value="")})])):M("",!0),e("form",{onSubmit:N($,["prevent"]),class:"form"},[e("div",be,[e("div",ve,[_(e("input",{type:"text",class:"form-control mt-3",placeholder:"Last name","onUpdate:modelValue":t[1]||(t[1]=d=>o(a).last_name=d)},null,512),[[y,o(a).last_name]])]),e("div",fe,[t[18]||(t[18]=e("label",null,"Birth date",-1)),_(e("input",{type:"date",class:"form-control",placeholder:"Birth date","onUpdate:modelValue":t[2]||(t[2]=d=>o(a).date_of_birth=d)},null,512),[[y,o(a).date_of_birth]])])]),e("div",_e,[e("div",ge,[_(e("input",{type:"text",class:"form-control",placeholder:"First name","onUpdate:modelValue":t[3]||(t[3]=d=>o(a).first_name=d),required:""},null,512),[[y,o(a).first_name]])]),e("div",ye,[_(e("input",{type:"number",class:"form-control",placeholder:"Age","onUpdate:modelValue":t[4]||(t[4]=d=>o(a).age=d),required:""},null,512),[[y,o(a).age]])])]),e("div",he,[e("div",$e,[_(e("input",{type:"text",class:"form-control",placeholder:"Middle name","onUpdate:modelValue":t[5]||(t[5]=d=>o(a).middle_name=d)},null,512),[[y,o(a).middle_name]])]),e("div",xe,[_(e("select",{class:"form-control","onUpdate:modelValue":t[6]||(t[6]=d=>o(a).gender=d),required:""},t[19]||(t[19]=[e("option",{value:"",disabled:""},"Gender",-1),e("option",{value:"Male"},"Male",-1),e("option",{value:"Female"},"Female",-1)]),512),[[j,o(a).gender]])])]),e("div",we,[e("div",ke,[_(e("select",{class:"form-control","onUpdate:modelValue":t[7]||(t[7]=d=>o(a).status=d),required:""},t[20]||(t[20]=[e("option",{value:"",disabled:""},"Status",-1),e("option",{value:"active"},"Active",-1),e("option",{value:"inactive"},"Inactive",-1)]),512),[[j,o(a).status]])]),e("div",Me,[_(e("input",{type:"number",class:"form-control",placeholder:"Purok","onUpdate:modelValue":t[8]||(t[8]=d=>o(a).purok=d),required:""},null,512),[[y,o(a).purok]])])]),e("div",Ce,[e("div",Ae,[_(e("input",{type:"text",class:"form-control",placeholder:"Occupation","onUpdate:modelValue":t[9]||(t[9]=d=>o(a).occupation=d),required:""},null,512),[[y,o(a).occupation]])]),e("div",Se,[_(e("input",{type:"text",class:"form-control",placeholder:"Contact no.","onUpdate:modelValue":t[10]||(t[10]=d=>o(a).contact_number=d),pattern:"[0-9]*",inputmode:"numeric"},null,512),[[y,o(a).contact_number]]),o(a).errors.contact_number?(v(),b("div",Ve,m(o(a).errors.contact_number),1)):M("",!0)])]),e("div",Ue,[e("div",Ne,[_(e("input",{type:"text",class:"form-control",placeholder:"Address","onUpdate:modelValue":t[11]||(t[11]=d=>o(a).address=d),required:""},null,512),[[y,o(a).address]])])]),n.value.length<1?(v(),b("div",Ee," No beneficiary added ")):(v(),b("div",Be,[t[22]||(t[22]=e("h5",{class:"text-dark fw-light pt-2"},"Beneficiary",-1)),e("table",Le,[t[21]||(t[21]=e("thead",null,[e("tr",null,[e("th",null,"Name"),e("th",null,"Relation"),e("th",null,"Age"),e("th",null,"Birthdate"),e("th",null,"Action")])],-1)),e("tbody",null,[(v(!0),b(I,null,D(n.value,(d,E)=>(v(),b("tr",{key:E},[e("td",null,m(d.name),1),e("td",null,m(d.relation),1),e("td",null,m(d.age),1),e("td",null,m(u(d.birth_date)),1),e("td",null,[e("button",{class:"btn btn-danger",onClick:F=>w(E)},"Delete",8,qe)])]))),128))])])])),e("div",Re,[e("div",null,[r.value?M("",!0):(v(),b("button",{key:0,class:"btn btn-primary",type:"button",onClick:t[12]||(t[12]=d=>r.value=!0)}," Add Beneficiary "))]),t[23]||(t[23]=e("div",{class:"d-flex flex-row gap-2 align-items-center"},[e("button",{class:"btn btn-success"},"submit")],-1))])],32),r.value?(v(),b("div",Ie,[t[26]||(t[26]=e("h5",{class:"mb-3"},"Add Beneficiary",-1)),e("form",{onSubmit:N(h,["prevent"])},[_(e("input",{type:"text",placeholder:"Name",class:"form-control mb-2","onUpdate:modelValue":t[13]||(t[13]=d=>c.value.name=d),required:""},null,512),[[y,c.value.name]]),_(e("input",{type:"text",placeholder:"Relation",class:"form-control mb-2","onUpdate:modelValue":t[14]||(t[14]=d=>c.value.relation=d),required:""},null,512),[[y,c.value.relation]]),_(e("input",{type:"number",placeholder:"Age",class:"form-control mb-2","onUpdate:modelValue":t[15]||(t[15]=d=>c.value.age=d),required:""},null,512),[[y,c.value.age]]),t[25]||(t[25]=e("label",null,"Date of Birth",-1)),_(e("input",{type:"date",placeholder:"Birthdate",class:"form-control mb-2","onUpdate:modelValue":t[16]||(t[16]=d=>c.value.birth_date=d),required:""},null,512),[[y,c.value.birth_date]]),e("div",Te,[e("button",{type:"button",class:"btn btn-secondary",onClick:t[17]||(t[17]=d=>r.value=!1)}," Cancel "),t[24]||(t[24]=e("button",{type:"submit",class:"btn btn-primary"}," Save Beneficiary ",-1))])],32)])):M("",!0)])]))}},De={class:"container mt-4"},Fe={key:0,class:"text-center my-5"},Pe={key:1,class:"alert alert-danger"},Oe={key:2,class:"table-responsive"},We={class:"table table-striped table-bordered shadow-sm"},Ge={key:3,class:"alert alert-info"},He={__name:"NewlyCreated",setup(A){const c=g(null),n=g(!0),r=g(null),s=async()=>{var $,h;try{const w=await ne.get("/member/new");c.value=w.data.data}catch(w){r.value=((h=($=w.response)==null?void 0:$.data)==null?void 0:h.message)||"Failed to fetch latest member."}finally{n.value=!1}},a=$=>new Date($).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return K(s),($,h)=>(v(),b("div",De,[n.value?(v(),b("div",Fe,h[0]||(h[0]=[e("div",{class:"spinner-border text-primary",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1)]))):r.value?(v(),b("div",Pe,m(r.value),1)):c.value?(v(),b("div",Oe,[e("table",We,[h[1]||(h[1]=e("thead",{class:"table-primary"},[e("tr",null,[e("th",null,"Name"),e("th",null,"Address"),e("th",null,"Contact"),e("th",null,"Age"),e("th",null,"Gender"),e("th",null,"Registration Date")])],-1)),e("tbody",null,[e("tr",null,[e("td",null,m(c.value.first_name)+" "+m(c.value.middle_name)+" "+m(c.value.last_name),1),e("td",null,m(c.value.address),1),e("td",null,m(c.value.contact_number),1),e("td",null,m(c.value.age),1),e("td",null,m(c.value.gender),1),e("td",null,m(a(c.value.created_at)),1)])])])])):(v(),b("div",Ge," No newly registered member found. "))]))}},ze=T(He,[["__scopeId","data-v-c3865ca2"]]),Xe={class:"container-fluid d-flex flex-row justify-content-between align-items-center mb-2"},Je={id:"addNewMemberModal",class:"custom-modal"},Ye={class:"modal-content",style:{"min-width":"60%",height:"auto"}},Ke={class:"modal-header"},Qe={class:"modal-body"},Ze={id:"newCreatedMemberModal",class:"custom-modal",style:{"padding-top":"0"}},et={class:"modal-content",style:{"min-width":"60%",height:"auto"}},tt={class:"modal-header alig-items-center"},lt={class:"modal-body"},st={__name:"Header",setup(A){const c=r=>{document.getElementById(r).classList.add("show")},n=r=>{document.getElementById(r).classList.remove("show")};return window.addEventListener("click",r=>{document.querySelectorAll(".custom-modal").forEach(s=>{r.target===s&&s.classList.remove("show")})}),(r,s)=>(v(),b("div",null,[e("div",Xe,[s[6]||(s[6]=e("div",null,[e("h5",{class:"ms-3 fw-light"},"Registered Members")],-1)),e("div",null,[e("button",{class:"modern-btn me-3",onClick:s[0]||(s[0]=N(a=>c("addNewMemberModal"),["prevent"]))},s[4]||(s[4]=[e("i",{class:"bi bi-person-plus"},null,-1),e("span",null,"Add Member",-1)])),e("button",{class:"modern-btn secondary",onClick:s[1]||(s[1]=a=>c("newCreatedMemberModal"))},s[5]||(s[5]=[e("i",{class:"bi bi-person-lines-fill"},null,-1),e("span",null,"Newly Created",-1)]))])]),e("div",Je,[e("div",Ye,[e("div",Ke,[s[7]||(s[7]=e("h3",null,"Add New Member",-1)),e("button",{class:"close-btn",onClick:s[2]||(s[2]=a=>n("addNewMemberModal"))},"×")]),e("div",Qe,[k(je)])])]),e("div",Ze,[e("div",et,[e("div",tt,[s[8]||(s[8]=e("div",{class:""},[e("h4",{class:"mb-3 text-dark fw-bold d-flex align-items-center"}," Newly Registered Member ")],-1)),e("button",{class:"close-btn2 fs-2",onClick:s[3]||(s[3]=a=>n("newCreatedMemberModal"))},"×")]),e("div",lt,[k(ze)])])])]))}},ot=T(st,[["__scopeId","data-v-3003f1a0"]]),nt={__name:"Alert",props:{status:{type:Boolean,default:!1},name:{type:String,default:""}},setup(A){const c=A,n=g(!1),r=g(null),s=g("");return U(()=>c.status,a=>{r.value=a,s.value="bounce-in",n.value=!0,setTimeout(()=>{s.value="slide-out",setTimeout(()=>{n.value=!1},500)},3e3)}),(a,$)=>(v(),b("div",null,[n.value?(v(),b("div",{key:0,class:O(["alert alert-info",s.value]),role:"alert"},[V(m(A.name)+"'s status has been changed to ",1),e("strong",null,m(r.value?"Active":"Inactive"),1)],2)):M("",!0)]))}},at=T(nt,[["__scopeId","data-v-f19df27b"]]),dt={class:"reminder-wrapper"},it={class:"card shadow-sm p-4 rounded-4 bg-white border-0"},rt={key:0,class:"mb-4 text-center"},ut={class:"fw-bold text-primary mb-1"},ct={class:"text-muted mb-0"},mt={class:"row g-3"},pt={class:"col-md-6"},bt={class:"col-md-6"},vt={key:0,class:"mt-4 bg-light p-3 rounded border-start border-4 border-primary"},ft={key:0,class:"mt-4 d-flex flex-wrap gap-3 justify-content-center"},_t={__name:"IsDeceased",props:{deceasedMember:{type:Object,default:()=>({})}},setup(A){const c=G({message:"",type:"deathReport",memberId:null}),n=A,r=g({}),s=g(""),a=g("");U(()=>n.deceasedMember,u=>{r.value=u},{immediate:!0}),U([s,a],([u,l])=>{var t;if(u&&l&&((t=r.value)!=null&&t.first_name)){const d=r.value;c.message=`We regret to inform you that ${d.first_name} ${d.last_name} has passed away. Last night was ${w(u)}, and the collection for burial assistance starts on ${w(l)}.`,c.memberId=d.id}else c.message=""});function $(){R.post(route("smsNotification.sendReminders"),{message:c.message},{onSuccess:()=>alert("Reminders sent successfully!"),onError:()=>alert("Error sending Reminders")})}const h=Q(()=>s.value&&a.value),w=u=>{const l={year:"numeric",month:"long",day:"numeric"};return new Date(u).toLocaleDateString(void 0,l)};return(u,l)=>(v(),b("div",dt,[e("div",it,[r.value.first_name?(v(),b("div",rt,[e("h4",ut,m(r.value.first_name)+" "+m(r.value.middle_name)+" "+m(r.value.last_name),1),e("p",ct,m(r.value.address),1)])):M("",!0),e("div",mt,[e("div",pt,[l[2]||(l[2]=e("label",{class:"form-label fw-semibold text-secondary"},"Enter last night:",-1)),_(e("input",{type:"date",class:"form-control","onUpdate:modelValue":l[0]||(l[0]=t=>s.value=t)},null,512),[[y,s.value]])]),e("div",bt,[l[3]||(l[3]=e("label",{class:"form-label fw-semibold text-secondary"},"Start of contribution:",-1)),_(e("input",{type:"date",class:"form-control","onUpdate:modelValue":l[1]||(l[1]=t=>a.value=t)},null,512),[[y,a.value]])])]),k(Y,{name:"fade"},{default:B(()=>[o(c).message?(v(),b("p",vt,m(o(c).message),1)):M("",!0)]),_:1}),k(Y,{name:"fade"},{default:B(()=>{var t;return[h.value?(v(),b("div",ft,[k(o(W),{href:u.route("smsNotification.sendToAllSelectedV2",{type:"deathReport",message:o(c).message,deceased:(t=r.value)==null?void 0:t.id,last:s.value}),class:"btn-modern text-decoration-none"},{default:B(()=>l[4]||(l[4]=[e("i",{class:"bi bi-people-fill me-2"},null,-1),V("Send to all selected ")])),_:1},8,["href"]),e("button",{class:"btn-modern",onClick:$},l[5]||(l[5]=[e("i",{class:"bi bi-send-fill me-2"},null,-1),V("Send ")]))])):M("",!0)]}),_:1})])]))}},gt=T(_t,[["__scopeId","data-v-b0c32c88"]]),yt={class:"container-fluid d-flex flex-row justify-content-center align-items-center main-container"},ht={class:"container mt-3"},$t={class:"row mb-3 d-flex flex-row align-items-center"},xt={class:"col col-6"},wt={class:"col col-6"},kt={class:"row mb-3"},Mt={class:"col col-6"},Ct={class:"col col-6"},At={class:"row mb-3"},St={class:"col col-6"},Vt={class:"col col-6"},Ut={class:"row mb-3"},Nt={class:"col col-6"},Et={class:"col col-6"},Bt={class:"row mb-3"},Lt={class:"col col-6"},qt={class:"col col-6"},Rt={key:0,class:"text-danger mt-1"},It={class:"row mb-3"},Tt={class:"col col-6"},jt={key:0,class:"container text-center mt-5 fs-4"},Dt={key:1},Ft={class:"table table-responsive bg-light"},Pt=["onClick"],Ot={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Wt={class:"modal-dialog"},Gt={class:"modal-content"},Ht={class:"modal-body"},zt={__name:"EditMember",props:{member:{type:Object,default:()=>({})}},setup(A){const c=A,n=G({first_name:"",last_name:"",address:"",contact_number:"",date_of_birth:"",purok:"",age:"",middle_name:"",status:"",occupation:"",gender:"",beneficiaries:[]}),r=g([]),s=g({name:"",relation:"",age:"",birth_date:""});U(()=>c.member,u=>{u&&(console.log("Reactive update detected:",u),n.defaults({first_name:u.first_name||"",last_name:u.last_name||"",address:u.address||"",contact_number:u.contact_number||"",date_of_birth:u.date_of_birth||"",purok:u.purok||"",age:u.age||"",middle_name:u.middle_name||"",status:u.status||"",occupation:u.occupation||"",gender:u.gender||"",beneficiaries:u.beneficiaries||[]}),n.reset(),r.value=(u==null?void 0:u.beneficiaries)||[])},{immediate:!0,deep:!0});const a=()=>{if(n.clearErrors(),!/^0\d{10}$/.test(n.contact_number)){n.setError("contact_number","Contact number must start with 0 and be exactly 11 digits.");return}n.beneficiaries=r.value,n.put(route("members.update",c.member.id),{onSuccess:()=>alert("Member updated successfully."),onError:l=>console.error("An error occurred => ",l)})},$=()=>{!s.value.name||!s.value.relation||!s.value.age||!s.value.birth_date||(r.value.push({...s.value}),s.value={name:"",relation:"",age:"",birth_date:""})},h=u=>{r.value.splice(u,1)},w=u=>{if(!u)return"";const l={year:"numeric",month:"long",day:"numeric"};return new Date(u).toLocaleDateString(void 0,l)};return(u,l)=>(v(),b("div",null,[e("div",yt,[e("div",ht,[e("form",{onSubmit:N(a,["prevent"]),class:"form"},[e("div",$t,[e("div",xt,[_(e("input",{type:"text",class:"form-control mt-3",placeholder:"Last name","onUpdate:modelValue":l[0]||(l[0]=t=>o(n).last_name=t)},null,512),[[y,o(n).last_name]])]),e("div",wt,[l[15]||(l[15]=e("label",null,"Birth date",-1)),_(e("input",{type:"date",class:"form-control",placeholder:"Birth date","onUpdate:modelValue":l[1]||(l[1]=t=>o(n).date_of_birth=t)},null,512),[[y,o(n).date_of_birth]])])]),e("div",kt,[e("div",Mt,[_(e("input",{type:"text",class:"form-control",placeholder:"First name","onUpdate:modelValue":l[2]||(l[2]=t=>o(n).first_name=t),required:""},null,512),[[y,o(n).first_name]])]),e("div",Ct,[l[16]||(l[16]=e("label",null,"Age",-1)),_(e("input",{type:"number",class:"form-control",placeholder:"Age","onUpdate:modelValue":l[3]||(l[3]=t=>o(n).age=t),required:""},null,512),[[y,o(n).age]])])]),e("div",At,[e("div",St,[_(e("input",{type:"text",class:"form-control",placeholder:"Middle name","onUpdate:modelValue":l[4]||(l[4]=t=>o(n).middle_name=t),required:""},null,512),[[y,o(n).middle_name]])]),e("div",Vt,[l[18]||(l[18]=e("label",null,"Gender",-1)),_(e("select",{class:"form-control","onUpdate:modelValue":l[5]||(l[5]=t=>o(n).gender=t),required:""},l[17]||(l[17]=[e("option",{value:""},"Select Gender",-1),e("option",{value:"Male"},"Male",-1),e("option",{value:"Female"},"Female",-1)]),512),[[j,o(n).gender]])])]),e("div",Ut,[e("div",Nt,[_(e("select",{class:"form-control","onUpdate:modelValue":l[6]||(l[6]=t=>o(n).status=t),required:""},l[19]||(l[19]=[e("option",{value:"",disabled:""},"Status",-1),e("option",{value:"active"},"Active",-1),e("option",{value:"inactive"},"Inactive",-1)]),512),[[j,o(n).status]])]),e("div",Et,[_(e("input",{type:"text",class:"form-control",placeholder:"Purok","onUpdate:modelValue":l[7]||(l[7]=t=>o(n).purok=t),required:""},null,512),[[y,o(n).purok]])])]),e("div",Bt,[e("div",Lt,[_(e("input",{type:"text",class:"form-control",placeholder:"Occupation","onUpdate:modelValue":l[8]||(l[8]=t=>o(n).occupation=t),required:""},null,512),[[y,o(n).occupation]])]),e("div",qt,[_(e("input",{type:"text",class:"form-control",placeholder:"Contact no.","onUpdate:modelValue":l[9]||(l[9]=t=>o(n).contact_number=t),required:"",pattern:"[0-9]*",inputmode:"numeric"},null,512),[[y,o(n).contact_number]]),o(n).errors.contact_number?(v(),b("div",Rt,m(o(n).errors.contact_number),1)):M("",!0)])]),e("div",It,[e("div",Tt,[_(e("input",{type:"text",class:"form-control",placeholder:"Address","onUpdate:modelValue":l[10]||(l[10]=t=>o(n).address=t),required:""},null,512),[[y,o(n).address]])])]),r.value.length?(v(),b("div",Dt,[l[21]||(l[21]=e("h5",{class:"text-dark fw-light pt-2"},"Beneficiary",-1)),e("table",Ft,[l[20]||(l[20]=e("thead",null,[e("tr",null,[e("th",null,"Name"),e("th",null,"Relation"),e("th",null,"Age"),e("th",null,"Birthdate"),e("th",null,"Action")])],-1)),e("tbody",null,[(v(!0),b(I,null,D(r.value,(t,d)=>(v(),b("tr",{key:d},[e("td",null,m(t.name),1),e("td",null,m(t.relation),1),e("td",null,m(t.age),1),e("td",null,m(w(t.birth_date)),1),e("td",null,[e("button",{class:"btn btn-danger",type:"button",onClick:E=>h(d)}," Delete ",8,Pt)])]))),128))])])])):(v(),b("div",jt," No beneficiary added ")),l[22]||(l[22]=e("div",{class:"container-fluid d-flex flex-row justify-content-between align-items-center"},[e("button",{class:"btn btn-primary",type:"button","data-bs-toggle":"modal","data-bs-target":"#exampleModal"}," Add Beneficiary "),e("button",{class:"btn btn-success",type:"submit"},"Save")],-1))],32),e("div",Ot,[e("div",Wt,[e("div",Gt,[l[25]||(l[25]=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"}," Add Beneficiary "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",Ht,[e("form",{onSubmit:N($,["prevent"])},[_(e("input",{type:"text",placeholder:"Name",class:"form-control mb-2","onUpdate:modelValue":l[11]||(l[11]=t=>s.value.name=t),required:""},null,512),[[y,s.value.name]]),_(e("input",{type:"text",placeholder:"Relation",class:"form-control mb-2","onUpdate:modelValue":l[12]||(l[12]=t=>s.value.relation=t),required:""},null,512),[[y,s.value.relation]]),_(e("input",{type:"number",placeholder:"Age",class:"form-control mb-2","onUpdate:modelValue":l[13]||(l[13]=t=>s.value.age=t),required:""},null,512),[[y,s.value.age]]),l[23]||(l[23]=e("label",null,"Date of birth",-1)),_(e("input",{type:"date",class:"form-control mb-2","onUpdate:modelValue":l[14]||(l[14]=t=>s.value.birth_date=t),required:""},null,512),[[y,s.value.birth_date]]),l[24]||(l[24]=e("div",{class:"container d-flex justify-content-end gap-2 mt-1"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close "),e("button",{type:"submit",class:"btn btn-primary","data-bs-dismiss":"modal"}," Save changes ")],-1))],32)])])])])])])]))}},Xt={class:"main-section bg-light"},Jt={class:"container table-container"},Yt={class:"mb-3"},Kt={key:0,class:"text-muted mt-2"},Qt={key:1,class:"alert alert-success mt-2"},Zt={key:2,class:"alert alert-warning mt-2"},el={class:"table-responsive"},tl={class:"table table-bordered align-middle text-center"},ll={class:"text-start"},sl={class:"status-cell"},ol={class:"status-toggle"},nl={class:"toggle-switch"},al=["checked","onChange"],dl={class:"form-check form-switch d-inline-flex justify-content-center"},il=["checked","onClick"],rl={class:"actions-column"},ul={class:"action-buttons-large"},cl=["onClick"],ml=["onClick"],pl={class:"action-buttons-small"},bl=["onClick"],vl={key:0},fl={class:"pagination-controls d-flex justify-content-center mt-3 mb-5 pb-5 pt-3"},_l=["onClick","innerHTML"],gl={class:"list-unstyled m-0"},yl={class:"modal fade",id:"editMember",tabindex:"-1","aria-labelledby":"editMemberLabel","aria-hidden":"true"},hl={class:"modal-dialog",style:{"max-width":"800px"}},$l={class:"modal-content"},xl={class:"modal-body"},wl={class:"custom-modal"},kl={class:"custom-modal-body"},Ml={__name:"RegisteredMember",props:{members:{type:Object,default:()=>({data:[],links:[],prev_page_url:null,next_page_url:null})},deceasedMember:{type:Array,default:()=>[]}},setup(A){const c=A;let n=g([]);const r=g(!1),s=g({top:"0px",left:"0px"}),a=g(null),$=g({}),h=g(!1),w=g(""),u=g(""),l=g([]),t=g({}),d=g(!1),E=g({});U(()=>c.members,p=>{n.value=p.data||[]},{immediate:!0}),U(()=>c.deceasedMember,p=>{l.value=p.data||[]},{immediate:!0});const F=Q(()=>u.value?n.value.filter(p=>`${p.first_name} ${p.middle_name||""} ${p.last_name}`.toLowerCase().includes(u.value.toLowerCase())||(p.contact_number||"").toLowerCase().includes(u.value.toLowerCase())||(p.purok||"").toLowerCase().includes(u.value.toLowerCase())):n.value),H=p=>{confirm("Are you sure you want to trash this member?")&&R.delete(route("deleteMember",{id:p}),{onSuccess:()=>{alert("Member trashed"),r.value=!1}})},Z=p=>{const i=p.status==="active"?"inactive":"active";R.put(route("toggleMemberStatus",{id:p.id}),{status:i},{onSuccess:()=>{p.status=i,h.value=i==="active",w.value=`${p.first_name} ${p.middle_name} ${p.last_name}`}})},ee=(p,i)=>{if(r.value&&a.value===i){r.value=!1,a.value=null;return}a.value=i,r.value=!0,re(()=>{const f=p.currentTarget.getBoundingClientRect(),C=document.querySelector(".actions-popup");if(!C)return;const x=C.offsetWidth,oe=window.innerWidth||document.documentElement.clientWidth;let q=f.right+window.scrollX+10;q+x>oe&&(q=f.left+window.scrollX-x-10,q<0&&(q=10)),s.value={top:`${f.top+window.scrollY}px`,left:`${q}px`}})},z=p=>{r.value&&p.target&&!p.target.closest(".actions-popup")&&!p.target.closest(".three-dots-button")&&(r.value=!1,a.value=null)};K(()=>document.addEventListener("click",z)),ae(()=>document.removeEventListener("click",z));const te=p=>{p&&R.visit(p)},le=p=>{t.value=p||null,d.value=!0},X=()=>{d.value=!1},J=p=>{r.value=!1,E.value={...p}},S=g(null),P=g(!1),L=g("");U(u,async p=>{var i,f;if(!p){S.value=null,L.value="";return}P.value=!0;try{const C=await axios.get(route("members.search"),{params:{query:p}});S.value=C.data,L.value=""}catch(C){S.value=null,L.value=((f=(i=C.response)==null?void 0:i.data)==null?void 0:f.message)||"No member found"}finally{P.value=!1}});const se=p=>{R.visit(route("members.searchPage")+`?page=${p}`)};return(p,i)=>(v(),b(I,null,[k(o(de),{title:"Registered members"}),k(ue,null,{default:B(()=>[e("div",Xt,[k(ot),k(at,{status:h.value,name:w.value},null,8,["status","name"]),e("div",Jt,[e("div",Yt,[_(e("input",{type:"text",class:"form-control w-50",placeholder:"Search members by name, contact, or purok...","onUpdate:modelValue":i[0]||(i[0]=f=>u.value=f)},null,512),[[y,u.value]]),P.value?(v(),b("div",Kt,"Searching...")):S.value?(v(),b("div",Qt,[i[4]||(i[4]=e("strong",null,"Found:",-1)),V(" "+m(S.value.member.first_name)+" "+m(S.value.member.last_name)+" ",1),i[5]||(i[5]=e("br",null,null,-1)),e("small",null,"Appears on page: "+m(S.value.page),1),e("button",{class:"btn btn-sm btn-primary ms-2",onClick:i[1]||(i[1]=f=>se(S.value.page))}," Go to Page "+m(S.value.page),1)])):L.value?(v(),b("div",Zt,m(L.value),1)):M("",!0)]),e("div",el,[e("table",tl,[i[12]||(i[12]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"ID"),e("th",null,"NAME"),e("th",null,"GENDER"),e("th",null,"AGE"),e("th",null,"CONTACT NO."),e("th",null,"STREET"),e("th",null,"STATUS"),e("th",null,"DECEASED"),e("th",null,"ACTION")])],-1)),e("tbody",null,[(v(!0),b(I,null,D(F.value,(f,C)=>(v(),b("tr",{key:C},[e("td",null,m(f.id),1),e("td",ll,m(f.first_name)+" "+m(f.middle_name)+" "+m(f.last_name),1),e("td",null,m(f.gender||"N/A"),1),e("td",null,m(f.age),1),e("td",null,m(f.contact_number),1),e("td",null,m(f.purok),1),e("td",sl,[e("div",ol,[e("label",nl,[e("input",{type:"checkbox",checked:f.status==="active",onChange:x=>Z(f)},null,40,al),i[6]||(i[6]=e("span",{class:"toggle-slider"},null,-1))]),e("span",{class:O(["status-label",f.status==="active"?"active":"inactive"])},m(f.status==="active"?"Active":"Inactive"),3)])]),e("td",null,[e("div",dl,[e("input",{class:"form-check-input",type:"checkbox",checked:l.value.some(x=>x.member_id===f.id),onClick:x=>le(f)},null,8,il)])]),e("td",rl,[e("div",ul,[k(o(W),{href:p.route("viewMemberInfo",{id:f.id}),class:"me-1"},{default:B(()=>i[7]||(i[7]=[e("i",{class:"bi bi-eye"},null,-1)])),_:2},1032,["href"]),e("button",{"data-bs-toggle":"modal","data-bs-target":"#editMember",onClick:x=>J(f),class:"me-1"},i[8]||(i[8]=[e("i",{class:"bi bi-pencil"},null,-1)]),8,cl),e("button",{onClick:x=>H(f.id)},i[9]||(i[9]=[e("i",{class:"bi bi-trash"},null,-1)]),8,ml)]),e("div",pl,[e("button",{class:"btn btn-sm btn-outline-dark three-dots-button",onClick:N(x=>ee(x,f.id),["stop"]),ref_for:!0,ref:x=>{x&&($.value[f.id]=x)}},i[10]||(i[10]=[e("i",{class:"bi bi-three-dots-vertical"},null,-1)]),8,bl)])])]))),128)),F.value.length===0?(v(),b("tr",vl,i[11]||(i[11]=[e("td",{colspan:"9",class:"text-center text-muted"},"No members found",-1)]))):M("",!0)])])])]),e("div",fl,[(v(!0),b(I,null,D(c.members.links,(f,C)=>(v(),b("button",{key:C,class:O(["btn",f.active?"btn-primary":"btn-outline-primary"]),onClick:x=>te(f.url),innerHTML:f.label},null,10,_l))),128))])]),r.value?(v(),b("div",{key:0,class:"actions-popup bg-white border rounded shadow-sm p-2",style:ie({top:s.value.top,left:s.value.left,position:"absolute"})},[e("ul",gl,[e("li",null,[k(o(W),{href:p.route("viewMemberInfo",{id:a.value}),class:"dropdown-item"},{default:B(()=>i[13]||(i[13]=[e("i",{class:"bi bi-eye me-2"},null,-1),V(" View ")])),_:1},8,["href"])]),e("li",null,[e("button",{class:"dropdown-item w-100 text-start",onClick:i[2]||(i[2]=f=>J(o(n).find(C=>C.id===a.value))),"data-bs-toggle":"modal","data-bs-target":"#editMember"},i[14]||(i[14]=[e("i",{class:"bi bi-pencil me-2"},null,-1),V(" Edit ")]))]),e("li",null,[e("button",{class:"dropdown-item w-100 text-start text-danger",onClick:i[3]||(i[3]=f=>H(a.value))},i[15]||(i[15]=[e("i",{class:"bi bi-trash me-2"},null,-1),V(" Delete ")]))])])],4)):M("",!0),e("div",yl,[e("div",hl,[e("div",$l,[i[16]||(i[16]=e("div",{class:"modal-header"},[e("h5",{class:"text-muted"},"Edit info."),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",xl,[k(zt,{member:E.value},null,8,["member"])])])])]),d.value?(v(),b("div",{key:1,class:"custom-modal-overlay",onClick:N(X,["self"])},[e("div",wl,[e("div",{class:"custom-modal-header"},[i[17]||(i[17]=e("h3",null,"Add Deceased Info",-1)),e("span",{class:"close-icon",onClick:X},"×")]),e("div",kl,[k(gt,{deceasedMember:t.value},null,8,["deceasedMember"])])])])):M("",!0)]),_:1})],64))}},Ul=T(Ml,[["__scopeId","data-v-a7d250a9"]]);export{Ul as default};
