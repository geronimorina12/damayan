import{r as p,s as C,f as n,o as a,b as e,n as U,u as r,F as N,G as L,t as d,W as O,x as B,l as R,h as A,d as H,i as P,I,D as V,E as F,e as j,J as W,a as h,j as z,g as G,w as J}from"./app-YM487_xA.js";import{_ as K}from"./not_found-DvAnRRcV.js";import{A as Q}from"./AdminLayout-Da8BGDln.js";import{_ as T}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as Y}from"./ToggleContribution-BqN7T7qX.js";import"./logo1-BZ0h4foK.js";const q={class:"d-flex align-items-center gap-2 text-muted small"},X=["onClick"],Z={__name:"Purok",props:{activePurok:{type:String,default:()=>""},currentDeceasedId:{type:[String,Number],default:null}},setup(x){const i=x;let u=p("");C(()=>i.activePurok,b=>{u.value=b},{immediate:!0});const v=["Purok 1","Purok 2","Purok 3","Purok 4"],f=b=>{const k=b.toLowerCase().replace(/\s+/g,"");O.get(route("contributions.togglePurok",{purok:k,deceasedId:i.currentDeceasedId||0}),{onSuccess:()=>console.log("changing purok"),onError:l=>console.log("An error occured: ",l)})},g=b=>b.toLowerCase().replace(/\s+/g,"");return(b,k)=>(a(),n("div",null,[e("div",q,[e("span",{class:U(["purok all-members-text",{"fw-bold active":r(u)=="all"}]),onClick:k[0]||(k[0]=l=>f("all"))},"ALL MEMBERS",2),e("div",null,[(a(),n(N,null,L(v,l=>e("span",{key:l,class:U(["mx-2 purok",{"fw-bold active":g(l)===r(u)}]),onClick:$=>f(l)},d(l),11,X)),64))])])]))}},ee=T(Z,[["__scopeId","data-v-9a43fba9"]]),te={class:"contri-container py-1"},se={class:"row justify-content-center"},oe={class:"col-md-8"},le={class:"card rounded-4 shadow-none border-0"},ne={class:"card-body p-4"},ae={key:0,class:"alert alert-success text-center fw-semibold",role:"alert"},re={class:"mb-3"},ie=["value"],de={key:0,class:"invalid-feedback"},ue={class:"mb-3"},ce={key:0,class:"invalid-feedback"},be={class:"mb-3"},pe={key:0,class:"mb-3"},_e={key:1,class:"text-danger"},ve={class:"mb-3"},fe=["value"],ke={class:"d-flex justify-content-end"},ye=["disabled"],ge={key:0,class:"spinner-border spinner-border-sm"},me={__name:"AddContribution",setup(x){const i=p([]),u=p([]),v=p([]),f=p([]),g=p([]),b=p(!1),k=p(""),l=B({member_id:"",amount:100,payment_date:"",collector:"",status:"paid",purok:"",deceased_id:""});R(async()=>{try{const _=await W.get(route("contributions.members.data")),{members:o,users:t,deceasedMembers:y}=_.data;i.value=o||[],f.value=t||[],g.value=y||[];const s=(o||[]).map(c=>({id:c.id,fullName:`${c.first_name} ${c.middle_name??""} ${c.last_name}`.replace(/\s+/g," ").trim()})),m=(t||[]).map(c=>({id:c.id,fullName:c.name}));u.value=[...s,...m],v.value=(t||[]).filter(c=>c.role==="collector"),console.log("Collectors:",v.value)}catch(_){console.error(_)}}),C(()=>l.purok,_=>{if(!_)return;const o=_.replace("purok",""),t=v.value.find(y=>String(y.purok)===String(o));t?l.collector=t.name:l.collector=""});const M=()=>{l.post(route("contributions.store"),{preserveScroll:!0,onSuccess:()=>{k.value="Contribution successfully created!",b.value=!0,setTimeout(()=>b.value=!1,3e3),l.reset()}})};return(_,o)=>(a(),n("div",null,[e("div",te,[e("div",se,[e("div",oe,[e("div",le,[o[13]||(o[13]=e("div",{class:"card-header text-center"},[e("h4",{class:"mb-0"},"Create Contribution")],-1)),e("div",ne,[b.value?(a(),n("div",ae,d(k.value),1)):A("",!0),e("form",{onSubmit:H(M,["prevent"])},[e("div",re,[o[6]||(o[6]=e("label",{class:"form-label"},"Member Name",-1)),P(e("select",{"onUpdate:modelValue":o[0]||(o[0]=t=>r(l).member_id=t),class:U(["form-select",{"is-invalid":r(l).errors.member_id}])},[o[5]||(o[5]=e("option",{disabled:"",value:""},"-- Select Member --",-1)),(a(!0),n(N,null,L(u.value,t=>(a(),n("option",{key:t.id,value:t.id},d(t.fullName),9,ie))),128))],2),[[I,r(l).member_id]]),r(l).errors.member_id?(a(),n("div",de,d(r(l).errors.member_id),1)):A("",!0)]),e("div",ue,[o[7]||(o[7]=e("label",{class:"form-label"},"Payment Date",-1)),P(e("input",{"onUpdate:modelValue":o[1]||(o[1]=t=>r(l).payment_date=t),type:"datetime-local",class:U(["form-control",{"is-invalid":r(l).errors.payment_date}])},null,2),[[V,r(l).payment_date]]),r(l).errors.payment_date?(a(),n("div",ce,d(r(l).errors.payment_date),1)):A("",!0)]),e("div",be,[o[9]||(o[9]=e("label",{class:"form-label"},"Purok",-1)),P(e("select",{"onUpdate:modelValue":o[2]||(o[2]=t=>r(l).purok=t),class:"form-control"},o[8]||(o[8]=[F('<option disabled value="">-- Select Purok --</option><option value="purok1">Purok 1</option><option value="purok2">Purok 2</option><option value="purok3">Purok 3</option><option value="purok4">Purok 4</option>',5)]),512),[[I,r(l).purok]])]),r(l).collector?(a(),n("div",pe,[o[10]||(o[10]=e("label",{class:"form-label"},"Collector",-1)),P(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o[3]||(o[3]=t=>r(l).collector=t),readonly:""},null,512),[[V,r(l).collector]])])):(a(),n("div",_e,"No Collector for that purok.")),e("div",ve,[o[12]||(o[12]=e("label",{class:"form-label"},"Select Deceased Member",-1)),P(e("select",{"onUpdate:modelValue":o[4]||(o[4]=t=>r(l).deceased_id=t),class:"form-control"},[o[11]||(o[11]=e("option",{disabled:"",value:""},"-- Select Deceased Member --",-1)),(a(!0),n(N,null,L(g.value,t=>(a(),n("option",{key:t.id,value:t.member_id},d(t.deceased_name),9,fe))),128))],512),[[I,r(l).deceased_id]])]),e("div",ke,[e("button",{type:"submit",class:"btn btn-success px-4 rounded-pill d-flex align-items-center gap-2",disabled:r(l).processing||!r(l).collector},[r(l).processing?(a(),n("span",ge)):A("",!0),j(" "+d(r(l).processing?"Submitting...":"Submit"),1)],8,ye)])],32)])])])])])]))}},he={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},xe={class:"modal-dialog",style:{"min-width":"60%"}},Ce={class:"modal-content"},$e={class:"modal-body"},Me={__name:"Header",setup(x){return(i,u)=>(a(),n("div",null,[u[1]||(u[1]=F('<div class="container-fluid d-flex flex-row justify-content-between align-items-center px-0 mb-2" data-v-31f09250><div data-v-31f09250><h6 class="mt-4 payment-contribution-text fs-5" style="transform:translateY(-20%);" data-v-31f09250><span class="d-none d-sm-none d-lg-inline" data-v-31f09250>Payment</span> Contribution</h6></div><div data-v-31f09250><button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#exampleModal" data-v-31f09250><span class="d-none d-sm-none d-lg-inline" data-v-31f09250>Add contribution</span><i class="bi bi-plus d-inline d-sm-inline d-lg-none" data-v-31f09250></i></button></div></div>',1)),e("div",he,[e("div",xe,[e("div",Ce,[u[0]||(u[0]=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Add contribution"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",$e,[h(me)])])])])]))}},Pe=T(Me,[["__scopeId","data-v-31f09250"]]),E={__name:"Collector",props:{collectors:{type:Array,default:()=>[]},purok:{type:String,default:""}},setup(x){var v;const i=x,u=p("");return i.collectors.length!=0&&i.purok!=""?u.value=((v=i.collectors.find(f=>f.purok===i.purok.slice(-1)))==null?void 0:v.name)||"N/A":u.value="N/A",(f,g)=>(a(),n("div",null,[e("p",null,d(u.value),1)]))}},Ae={class:"main-container"},Ne={class:"container-fluid d-flex justify-content-end"},Se={class:"search-container w-50"},we={class:"bg-light p-2"},De={class:""},Le={key:0,class:"mt-3"},Ue={key:1,class:"table-responsive mt-3 desktop-view"},Ie={class:"table table-bordered table-hover align-middle text-center"},Ve={class:"scrollable-tbody"},je={class:"text-start"},Te={key:0},Ee={key:1,class:"text-muted"},Oe={key:0,class:"badge bg-success"},Fe={key:1,class:"text-muted"},Be={class:"pagination-controls d-flex align-items-center justify-content-end gap-2 mt-3"},Re=["disabled"],He=["disabled"],We={key:2,class:"mobile-view"},ze={class:"mobile-cards-container"},Ge={class:"mobile-card-header"},Je={class:"mobile-member-id"},Ke={class:"mobile-status"},Qe={key:0,class:"badge bg-success"},Ye={key:1,class:"text-muted"},qe={class:"mobile-card-body"},Xe={class:"mobile-field"},Ze={class:"mobile-value"},et={class:"mobile-field-group"},tt={class:"mobile-field"},st={class:"mobile-value"},ot={class:"mobile-field"},lt={class:"mobile-value"},nt={class:"mobile-field"},at={key:0,class:"mobile-value"},rt={key:1,class:"text-muted"},it={class:"mobile-field"},dt={class:"mobile-value"},ut={class:"mobile-pagination d-flex align-items-center justify-content-between mt-3"},ct=["disabled"],bt=["disabled"],pt={key:3,class:"container mt-4 text-center"},_t={class:"fw-light"},vt={class:"text-success"},ft={__name:"MemberContribution",props:{member:{type:Object,default:()=>({data:[],links:{},meta:{}})},selectedPurok:{type:String,default:()=>""},collectors:{type:Array,default:()=>[]},currentDeceasedMembers:{type:Array,default:()=>[]},currentDeceasedMember:{type:Object,default:()=>({})}},setup(x){const i=x;let u=p([]),v=p(""),f=p([]);const g=p([]),b=p({});C(()=>i.member,o=>{u.value=(o==null?void 0:o.data)||[]},{immediate:!0}),C(()=>i.selectedPurok,o=>{v.value=o},{immediate:!0}),C(()=>i.collectors,o=>{f.value=o},{immediate:!0}),C(()=>i.currentDeceasedMembers,o=>{g.value=o?Object.values(o):[]},{immediate:!0}),C(()=>i.currentDeceasedMember,o=>{b.value=o},{immediate:!0});const k=o=>{const t={year:"numeric",month:"long",day:"numeric"};return new Date(o).toLocaleDateString(void 0,t)};function l(o){return o==null?"N/A":parseFloat(o)}function $(o){o&&O.get(o,{},{preserveScroll:!0,preserveState:!0})}const M=p(""),_=z(()=>{if(!M.value.trim())return u.value;const o=M.value.toLowerCase();return u.value.filter(t=>{var y,s,m,c;return t.first_name&&t.first_name.toLowerCase().includes(o)||t.last_name&&t.last_name.toLowerCase().includes(o)||t.middle_name&&t.middle_name.toLowerCase().includes(o)||t.purok&&t.purok.toLowerCase().includes(o)||((s=(y=t.contributions)==null?void 0:y[0])==null?void 0:s.collector)&&t.contributions[0].collector.toLowerCase().includes(o)||((c=(m=t.contributions)==null?void 0:m[0])==null?void 0:c.status)&&t.contributions[0].status.toLowerCase().includes(o)})});return(o,t)=>(a(),n(N,null,[h(r(G),{title:"Member contribution"}),e("div",null,[h(Q,null,{default:J(()=>{var y;return[e("div",Ae,[e("div",Ne,[e("div",Se,[P(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>M.value=s),type:"text",class:"form-control",placeholder:"Search by name, purok, collector, or status..."},null,512),[[V,M.value]])])]),e("div",we,[e("div",De,[h(Pe)]),h(ee,{activePurok:r(v),currentDeceasedId:(y=b.value)==null?void 0:y.member_id},null,8,["activePurok","currentDeceasedId"]),b.value?(a(),n("div",Le,[h(Y,{allDeceased:g.value,data:b.value,purok:r(v)},null,8,["allDeceased","data","purok"])])):A("",!0),Array.isArray(_.value)&&_.value.length>0?(a(),n("div",Ue,[e("table",Ie,[t[5]||(t[5]=e("thead",{class:""},[e("tr",null,[e("th",null,"ID"),e("th",null,"NAME"),e("th",null,"AMOUNT"),e("th",null,"DATE"),e("th",null,"COLLECTOR"),e("th",null,"PUROK"),e("th",null,"STATUS")])],-1)),e("tbody",Ve,[(a(!0),n(N,null,L(_.value,(s,m)=>{var c,S,w,D;return a(),n("tr",{key:m},[e("td",null,d(s==null?void 0:s.id),1),e("td",je,d(s==null?void 0:s.first_name)+" "+d(s==null?void 0:s.middle_name)+" "+d(s==null?void 0:s.last_name),1),e("td",null,d(l((c=s==null?void 0:s.contributions[0])==null?void 0:c.amount)),1),e("td",null,[(S=s==null?void 0:s.contributions[0])!=null&&S.payment_date?(a(),n("span",Te,d(k((w=s==null?void 0:s.contributions[0])==null?void 0:w.payment_date)),1)):(a(),n("span",Ee,"..."))]),e("td",null,[h(E,{collectors:r(f),purok:s.purok},null,8,["collectors","purok"])]),e("td",null,d((s==null?void 0:s.purok)||"N/A"),1),e("td",null,[((D=s==null?void 0:s.contributions[0])==null?void 0:D.status)==="paid"?(a(),n("span",Oe,"Paid")):(a(),n("span",Fe,"Unpaid"))])])}),128))])]),e("div",Be,[e("button",{class:"btn btn-outline-primary",disabled:!i.member.prev_page_url,onClick:t[1]||(t[1]=s=>$(i.member.prev_page_url))}," Previous ",8,Re),e("button",{class:"btn btn-outline-primary",disabled:!i.member.next_page_url,onClick:t[2]||(t[2]=s=>$(i.member.next_page_url))}," Next ",8,He)])])):A("",!0),Array.isArray(_.value)&&_.value.length>0?(a(),n("div",We,[e("div",ze,[(a(!0),n(N,null,L(_.value,(s,m)=>{var c,S,w,D;return a(),n("div",{class:"mobile-card",key:m},[e("div",Ge,[e("div",Je,"ID: "+d(s==null?void 0:s.id),1),e("div",Ke,[((c=s==null?void 0:s.contributions[0])==null?void 0:c.status)==="paid"?(a(),n("span",Qe,"Paid")):(a(),n("span",Ye,"Unpaid"))])]),e("div",qe,[e("div",Xe,[t[6]||(t[6]=e("label",null,"Name:",-1)),e("span",Ze,d(s==null?void 0:s.first_name)+" "+d(s==null?void 0:s.middle_name)+" "+d(s==null?void 0:s.last_name),1)]),e("div",et,[e("div",tt,[t[7]||(t[7]=e("label",null,"Amount:",-1)),e("span",st,d(l((S=s==null?void 0:s.contributions[0])==null?void 0:S.amount)),1)]),e("div",ot,[t[8]||(t[8]=e("label",null,"Purok:",-1)),e("span",lt,d((s==null?void 0:s.purok)||"N/A"),1)])]),e("div",nt,[t[9]||(t[9]=e("label",null,"Date:",-1)),(w=s==null?void 0:s.contributions[0])!=null&&w.payment_date?(a(),n("span",at,d(k((D=s==null?void 0:s.contributions[0])==null?void 0:D.payment_date)),1)):(a(),n("span",rt,"..."))]),e("div",it,[t[10]||(t[10]=e("label",null,"Collector:",-1)),e("span",dt,[h(E,{collectors:r(f),purok:s.purok},null,8,["collectors","purok"])])])])])}),128))]),e("div",ut,[e("button",{class:"btn btn-outline-primary btn-sm",disabled:!i.member.prev_page_url,onClick:t[3]||(t[3]=s=>$(i.member.prev_page_url))}," ← Previous ",8,ct),e("button",{class:"btn btn-outline-primary btn-sm",disabled:!i.member.next_page_url,onClick:t[4]||(t[4]=s=>$(i.member.next_page_url))}," Next → ",8,bt)])])):(a(),n("div",pt,[t[13]||(t[13]=e("img",{src:K,alt:"No Data",class:"not-found-image image-rounded"},null,-1)),e("h5",_t,[t[11]||(t[11]=j(" No contribution found in ")),e("span",vt,d(r(v)||"N/A"),1),t[12]||(t[12]=j(". "))])])),t[14]||(t[14]=e("div",{class:"container space-at-bottom"},null,-1))])])]}),_:1})])],64))}},Ct=T(ft,[["__scopeId","data-v-3d0509c7"]]);export{Ct as default};
