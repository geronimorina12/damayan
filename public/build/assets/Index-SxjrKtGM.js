import{l as n,q as w,f as u,o as m,b as t,F as x,E as k,e as R,n as F,t as i,W as $,a as C,u as A,g as L,w as U}from"./app-lJPr0_lx.js";import{A as N}from"./AdminLayout-BfAzXtKV.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./logo1-BZ0h4foK.js";const I={class:"card mt-4"},S={class:"card-body"},D={class:"table-responsive"},P={class:"table table-bordered align-middle"},V={class:"btn btn-sm btn-light"},B=["onClick"],T={class:"modal fade",id:"action",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},W={class:"modal-dialog"},q={class:"modal-content"},z={class:"modal-footer"},J={class:"container-fluid"},j={class:"col"},G={__name:"RoleAndPermissionTable",props:{users:{type:Array,default:()=>[]}},setup(v){const b=v,a=n([]),r=n(0),c=n(0),p=n(0),_=n(0),h=n(0),f=n(0),o=n(0),e=n(null);w(()=>b.users,y=>{a.value=y,r.value=a.value.filter(s=>s.role==="admin").length,c.value=a.value.filter(s=>s.position==="secretary").length,p.value=a.value.filter(s=>s.position==="president").length,_.value=a.value.filter(s=>s.position==="vise_president").length,h.value=a.value.filter(s=>s.position==="purok_leader").length,f.value=a.value.filter(s=>s.position==="treasurer").length,o.value=a.value.filter(s=>s.position==="colector").length},{immediate:!0});const l=[{name:"Admin",description:"Full access",users:r.value+(r.value>1?" users":" user"),access:"Full modules",icon:"bi bi-person"},{name:"Collector",description:"Jurisdiction-based",users:4,access:"Status updates",icon:"bi bi-people"}],g=()=>{if(!e.value){alert("No role selected. Please select a role to view.");return}$.get(route("role.viewSpecificRole",{role:e.value})),e.value=null};return(y,s)=>(m(),u("div",null,[t("div",I,[t("div",S,[s[2]||(s[2]=t("h6",{class:"fw-semibold"},"Roles and Permissions",-1)),t("div",D,[t("table",P,[s[1]||(s[1]=t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"Role"),t("th",null,"Description"),t("th",null,"Users"),t("th",null,"Access"),t("th")])],-1)),t("tbody",null,[(m(),u(x,null,k(l,(d,M)=>t("tr",{key:M},[t("td",null,[t("i",{class:F(d.icon)},null,2),R(" "+i(d.name),1)]),t("td",null,i(d.description),1),t("td",null,i(d.users),1),t("td",null,i(d.access),1),t("td",null,[t("button",V,[t("i",{class:"bi bi-three-dots-vertical","data-bs-toggle":"modal","data-bs-target":"#action",onClick:rt=>e.value=d.name.toLocaleLowerCase()},null,8,B)])])])),64))])])])])]),t("div",T,[t("div",W,[t("div",q,[s[3]||(s[3]=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"exampleModalLabel"}," Action "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",z,[t("div",J,[t("div",j,[t("button",{type:"button",class:"btn btn-primary w-100","data-bs-dismiss":"modal",onClick:s[0]||(s[0]=d=>g())}," View All ")])])])])])])]))}},H={class:"container mt-4 role-container"},K={class:"card mt-3"},O={class:"card-body"},Q={class:"table-responsive"},X={class:"table table-bordered align-middle"},Y={class:"btn btn-sm btn-light"},Z=["onClick"],tt={class:"modal fade",id:"action1Modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},et={class:"modal-dialog"},st={class:"modal-content"},lt={class:"modal-footer"},ot={class:"container-fluid"},at={class:"row gx-2"},nt={class:"col"},it={class:"col"},dt={__name:"Index",props:{users:{type:Array,default:()=>[]},admins:{type:Array,default:()=>[]}},setup(v){const b=v;let a=n([]),r=n([]),c=n(null);w(()=>b.admins,o=>{r.value=o},{immediate:!0}),w(()=>b.users,o=>{a.value=o,a.value.push(...r.value)},{immediate:!0});const p=o=>{c.value=o},_=()=>{$.get(route("role.edit",{id:c.value}))},h=()=>{confirm("Are you sure you want to delete this user?")&&$.delete(route("role.deleteUser",{user:c.value}),{onSuccess:()=>{alert("User deleted successfully.")},onError:o=>{console.error("Failed to delete user.",o)}})},f=(o,e)=>o==="collector"||e==="collector"?"Status updates":o==="admin"||e==="admin"?"Full modules":o==="secretary"||e==="secretary"?"Records and Reports":o==="vise_president"||e==="vise_president"?"Review and Approval":"N/A";return(o,e)=>(m(),u("div",null,[C(A(L),{title:"Role Management"}),C(N,null,{default:U(()=>[t("div",H,[e[4]||(e[4]=t("h5",{class:"fw-bold"},"User and Role Management",-1)),t("div",K,[t("div",O,[e[3]||(e[3]=t("h6",{class:"fw-semibold"},"User Management",-1)),t("div",Q,[t("table",X,[e[2]||(e[2]=t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"ID"),t("th",null,"NAME"),t("th",null,"EMAIL"),t("th",null,"Role"),t("th",null,"Access")])],-1)),t("tbody",null,[(m(!0),u(x,null,k(A(a),(l,g)=>(m(),u("tr",{key:g},[t("td",null,i(l.id),1),t("td",null,i(l.name),1),t("td",null,i(l.email||"N/A"),1),t("td",null,i((l==null?void 0:l.role)||(l==null?void 0:l.position)),1),t("td",null,i(f(l.role,l.position)),1),t("td",null,[t("button",Y,[t("i",{class:"bi bi-three-dots-vertical action1","data-bs-toggle":"modal","data-bs-target":"#action1Modal",onClick:y=>p(l.id)},null,8,Z)])])]))),128))])])])])]),C(G,{users:A(a)},null,8,["users"]),e[5]||(e[5]=t("div",{class:"bottom-role-container container"},null,-1))])]),_:1}),t("div",tt,[t("div",et,[t("div",st,[e[7]||(e[7]=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"exampleModalLabel"}," Action "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",lt,[t("div",ot,[t("div",at,[t("div",nt,[t("button",{type:"button",class:"btn btn-primary w-100","data-bs-dismiss":"modal",onClick:e[0]||(e[0]=l=>_())}," Edit ")]),t("div",it,[t("button",{type:"button",class:"btn btn-warning w-100","data-bs-dismiss":"modal",onClick:e[1]||(e[1]=l=>h())}," Delete ")]),e[6]||(e[6]=t("div",{class:"col"},[t("button",{type:"button",class:"btn btn-secondary w-100","data-bs-dismiss":"modal"}," Cancel ")],-1))])])])])])])]))}},vt=E(dt,[["__scopeId","data-v-5ac17762"]]);export{vt as default};
