import{r as u,s as A,z as O,J as B,j as E,f as l,o as n,a as g,u as C,g as L,w,b as t,i as V,D as j,e as D,h as v,t as o,F as h,G as T,S as P,n as z,W as I}from"./app-BKViIBP_.js";import{C as U}from"./CollectorLayout-BHr-NoE9.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./logo1-BZ0h4foK.js";const G={class:"main-section bg-light"},H={class:"mb-3 px-3"},W={class:"table-responsive"},$={class:"table table-bordered align-middle text-center"},J={key:0},K={key:1},Q={colspan:"6",class:"text-center text-danger"},X={class:"purok"},Y={key:2},Z={class:"pagination-wrapper mt-3 mb-5 pb-5 pt-3"},q=["onClick","innerHTML"],ee=400,te={__name:"RegisteredMember",props:{members:{type:Object,default:()=>({data:[],links:[],prev_page_url:null,next_page_url:null})}},setup(M){const f=M;let c=u([]);const m=u(""),y=u(null),i=u(!1),p=u("");A(()=>f.members,async a=>{c.value=a.data||[],await O(),R()},{immediate:!0});let b=null;A(m,a=>{b&&clearTimeout(b),b=setTimeout(()=>N(a.trim()),ee)});async function N(a){if(!a){c.value=f.members.data,console.log("Search cleared â€” showing default members:",c.value),i.value=!1;return}i.value=!0,p.value="",console.log(`ðŸ” Searching for: "${a}"`);try{const s=await B.get(route("members.search"),{params:{query:a}});console.log(" Raw backend response:",s.data);let e=[];const r=s.data||{};if(Array.isArray(r.members))e=r.members;else if(r.members&&Array.isArray(r.members.data))e=r.members.data;else if(r.member&&typeof r.member=="object")e=[r.member];else if(Array.isArray(r.data))e=r.data;else{const d=Object.values(r).find(k=>{var x;return Array.isArray(k)&&((x=k[0])==null?void 0:x.id)});d&&(e=d)}console.log("ðŸ§¾ Normalized member data:",e),c.value=Array.isArray(e)?e:[]}catch(s){console.error("âŒ Search error:",s),p.value="Error fetching search results."}finally{i.value=!1}}const _=E(()=>i.value?[]:c.value||[]),S=a=>{a&&I.visit(a,{preserveState:!0})},R=()=>{const a=y.value;if(!a)return;const s=a.querySelector(".btn.btn-primary");if(s){const e=a.getBoundingClientRect(),r=s.getBoundingClientRect(),d=r.left-e.left-e.width/2+r.width/2;a.scrollTo({left:a.scrollLeft+d,behavior:"smooth"})}};return(a,s)=>(n(),l(h,null,[g(C(L),{title:"Registered members"}),g(U,null,{default:w(()=>[t("div",G,[s[5]||(s[5]=t("div",null,[t("h5",{class:"ms-3 fw-light"},[t("span",{class:"d-none d-sm-none d-lg-inline-block me-2"},"Registered"),t("span",null,"Members")])],-1)),t("div",H,[V(t("input",{type:"text",class:"form-control w-50",placeholder:"Search members by name, contact, or purok...","onUpdate:modelValue":s[0]||(s[0]=e=>m.value=e)},null,512),[[j,m.value]])]),t("div",W,[t("table",$,[s[4]||(s[4]=t("thead",{class:"table-light"},[t("tr",null,[t("th",null,[t("i",{class:"bi bi-person"}),D(" NAME")]),t("th",null,"AGE"),t("th",null,"CONTACT NO."),t("th",null,"PUROK"),t("th",null,"ACTION")])],-1)),t("tbody",null,[i.value?(n(),l("tr",J,s[1]||(s[1]=[t("td",{colspan:"6",class:"text-center py-4"},[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")])],-1)]))):v("",!0),p.value&&!i.value?(n(),l("tr",K,[t("td",Q,o(p.value),1)])):v("",!0),(n(!0),l(h,null,T(_.value,(e,r)=>(n(),l("tr",{key:r},[t("td",null,o(e==null?void 0:e.first_name)+" "+o(e==null?void 0:e.middle_name)+" "+o(e==null?void 0:e.last_name),1),t("td",null,o(e.age),1),t("td",null,o(e.contact_number),1),t("td",X,o(e.purok),1),t("td",null,[g(C(P),{href:a.route("viewMemberInfo",{id:e==null?void 0:e.id}),class:"btn btn-sm btn-outline-dark me-1 border-0"},{default:w(()=>s[2]||(s[2]=[t("i",{class:"bi bi-eye fs-5"},null,-1)])),_:2},1032,["href"])])]))),128)),_.value.length===0?(n(),l("tr",Y,s[3]||(s[3]=[t("td",{colspan:"6",class:"text-center text-muted"},"No members found",-1)]))):v("",!0)])])]),t("div",Z,[t("div",{class:"pagination-controls",ref_key:"paginationContainer",ref:y},[(n(!0),l(h,null,T(f.members.links,(e,r)=>(n(),l("button",{key:r,class:z(["btn pagination-btn",e.active?"btn-primary":"btn-outline-primary"]),onClick:d=>S(e.url),innerHTML:e.label},null,10,q))),128))],512)])])]),_:1})],64))}},ne=F(te,[["__scopeId","data-v-4fbd77ad"]]);export{ne as default};
