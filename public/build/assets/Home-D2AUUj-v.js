import{r as d,j as H,l as J,f as a,o as r,b as e,e as S,h as w,t as u,i as q,D as z,F as I,G as V,J as W,s as M,u as A,W as N,a as x,g as Q,w as F,S as K}from"./app-DWiHdejm.js";import{A as X}from"./AdminLayout-BWPX31Kq.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./logo1-BZ0h4foK.js";const Y={class:"table-card"},Z={class:"card-header"},ee={class:"card-title"},te={key:0,class:"record-count"},le={class:"table-container"},oe={class:"mb-3"},se={class:"table-responsive"},ne={class:"deceased-table"},ae={key:0,class:"no-data-row"},re={class:"index-cell"},ie={class:"name-cell"},ce={class:"date-cell"},ue={__name:"Contributions",setup(E){const _=d([]),b=d(""),y=async()=>{try{const i=await W.get(route("contributions.list"));_.value=i.data,console.log("contributions: ",_.value)}catch(i){console.error("Error fetching contributions:",i)}},p=H(()=>{let i={};return _.value.forEach(s=>{s.collector&&(i[s.collector]||(i[s.collector]=0),i[s.collector]+=parseFloat(s.amount))}),Object.keys(i).map(s=>({collector:s,collected:i[s]}))}),g=H(()=>b.value?p.value.filter(i=>i.collector.toLowerCase().includes(b.value.toLowerCase())):p.value);return J(y),(i,s)=>(r(),a("div",Y,[e("div",Z,[e("h5",ee,[s[1]||(s[1]=S(" Collector Contributions Summary ")),g.value.length>0?(r(),a("span",te,u(g.value.length),1)):w("",!0)])]),e("div",le,[e("div",oe,[q(e("input",{type:"text",class:"form-control",placeholder:"Filter collector...","onUpdate:modelValue":s[0]||(s[0]=f=>b.value=f)},null,512),[[z,b.value]])]),e("div",se,[e("table",ne,[s[3]||(s[3]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Collector"),e("th",null,"Collected")])],-1)),e("tbody",null,[g.value.length===0?(r(),a("tr",ae,s[2]||(s[2]=[e("td",{colspan:"3",class:"no-data"}," No contributions found. ",-1)]))):w("",!0),(r(!0),a(I,null,V(g.value,(f,v)=>(r(),a("tr",{key:f.collector,class:"data-row"},[e("td",re,u(v+1),1),e("td",ie,u(f.collector),1),e("td",ce,"₱"+u(f.collected.toFixed(2)),1)]))),128))])])])])]))}},de=U(ue,[["__scopeId","data-v-c4a2a346"]]),ve={class:"main-section bg-light"},fe={key:0,class:"table-responsive"},be={class:"table table-bordered align-middle text-center"},he={class:"form-check form-switch d-inline-flex justify-content-center"},me=["checked"],_e={class:"d-flex flex-row justify-content-center align-items-center action-buttons"},ye=["onClick"],pe=["onClick"],ge=["disabled","onClick"],ke={key:1,class:"container text-center mt-3"},we={key:2,class:"modal fade show d-block",tabindex:"-1",role:"dialog",style:{"background-color":"rgba(0,0,0,0.5)"}},Ae={class:"modal-dialog modal-dialog-centered",role:"document"},Ce={class:"modal-content"},$e={class:"modal-header"},xe={class:"modal-title"},Oe={key:0,class:"modal-body"},Me={key:0},Ne={class:"table table-bordered text-center mt-3"},Ee={key:0},De={class:"text-success fw-bold"},Te={class:"text-success fw-bold"},Se={key:1},Ie={key:1,class:"modal-body"},je={class:"modal-footer"},Le={__name:"Official",props:{officials:{type:Array,default:()=>[]}},setup(E){const _=E;let b=d([]);const y=d(!1),p=d(""),g=d(""),i=d(""),s=d(null),f=d(null),v=d(null),k=d(0),C=d(null),O=(t,l,m,c=null)=>{p.value=t,g.value=l,i.value="confirm",s.value=m,f.value=c,y.value=!0},h=(t,l)=>{p.value=t,g.value=l,i.value="alert",y.value=!0},j=()=>{s.value&&f.value?s.value(f.value):s.value&&s.value(),y.value=!1},$=()=>{y.value=!1,s.value=null,f.value=null,v.value=null,k.value=0};M(()=>_.officials,t=>{b.value=t},{immediate:!0});const D=t=>{O("Delete Official Permanently","Are you sure you want to delete this official permanently? This action cannot be undone.",L,t)},L=t=>{N.delete(route("officialArchive.deleteOfficial",{id:t}),{onSuccess:()=>{h("Success","Official deleted successfully...")},onError:l=>{console.log("An error occurred while deleting data.",l),h("Error","An error occurred while deleting the official.")}})},P=(t,l)=>{O("Restore Official","Are you sure you want to restore this official?",R,{id:t,position:l})},R=t=>{const{id:l,position:m}=t;m!=="collector"?N.post(route("officialArchived.restoreOfficial",{id:l}),{onSuccess:()=>{h("Success","Official restored successfully...")},onError:c=>{console.log("An error occurred while restoring data.",c),h("Error","An error occurred while restoring the official.")}}):N.post(route("officialArchived.collector.restore",{id:l}),{onSuccess:()=>{h("Success","Official restored successfully...")},onError:c=>{console.log("An error occurred while restoring data.",c),h("Error","An error occurred while restoring the official.")}})},T=t=>{if(!t)return"N/A";const l=new Date(t);if(isNaN(l))return"N/A";const m={year:"numeric"};return l.toLocaleDateString(void 0,m)},n=async t=>{C.value=t,await o(t.id),p.value=`Transaction Info - ${t.name}`,i.value="transaction",y.value=!0},o=async t=>{try{const l=await W.get(`/contribution/list/${t}`);v.value=Array.isArray(l.data)?l.data:[l.data],k.value=v.value.reduce((m,c)=>m+Number(c.amount||0),0)}catch(l){console.error("Error fetching contributions:",l),h("Error","Unable to fetch contribution data.")}};return(t,l)=>{var m;return r(),a("div",ve,[l[8]||(l[8]=e("div",{class:"container-fluid d-flex flex-row justify-content-between align-items-center mb-2 flex-wrap"},[e("div",{class:"d-flex flex-row justify-content-between align-items-center w-100"},[e("p",{class:"text-muted mb-0"},"Officials")])],-1)),A(b).length>0?(r(),a("div",fe,[e("table",be,[l[3]||(l[3]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"ID"),e("th",null,"NAME"),e("th",null,"POSITION"),e("th",null,"TERM"),e("th",null,"STATUS"),e("th",null,"ACTION")])],-1)),e("tbody",null,[(r(!0),a(I,null,V(A(b),(c,B)=>(r(),a("tr",{key:B},[e("td",null,u(B+1),1),e("td",null,u(c==null?void 0:c.name),1),e("td",null,u(c.position?c.position:c.role||"N/A"),1),e("td",null,u(T(c.term_start))+" - "+u(T(c.term_end)),1),e("td",null,[e("div",he,[e("input",{class:"form-check-input",type:"checkbox",checked:c.status===1,title:"can't modify",disabled:""},null,8,me)])]),e("td",null,[e("div",_e,[e("button",{class:"btn btn-sm btn-outline-dark me-2",onClick:G=>D(c.id),title:"delete permanently"},l[0]||(l[0]=[e("i",{class:"bi bi-trash"},null,-1)]),8,ye),e("button",{class:"btn btn-sm btn-outline-dark me-2",onClick:G=>P(c.id,c.position||c.role),title:"restore"},l[1]||(l[1]=[e("i",{class:"bi bi-arrow-clockwise"},null,-1)]),8,pe),e("button",{class:"btn btn-sm btn-outline-dark",disabled:c.role!=="collector",onClick:G=>c.role==="collector"?n(c):null,title:"view transaction info"},l[2]||(l[2]=[e("i",{class:"bi bi-clock-history"},null,-1)]),8,ge)])])]))),128))])])])):(r(),a("div",ke,l[4]||(l[4]=[e("h5",{class:"text-dark fw-light"},"No Official's Archive Data.",-1)]))),y.value?(r(),a("div",we,[e("div",Ae,[e("div",Ce,[e("div",$e,[e("h5",xe,u(p.value),1),e("button",{type:"button",class:"btn-close",onClick:$,"aria-label":"Close"})]),i.value==="transaction"?(r(),a("div",Oe,[v.value&&v.value.length>0?(r(),a("div",Me,[e("table",Ne,[v.value&&v.value.length?(r(),a("div",Ee,[e("span",De,u((m=C.value)==null?void 0:m.name),1),l[5]||(l[5]=S(" has diligently served as a collector, successfully collecting a total amount of ")),e("span",Te,"₱"+u(k.value),1),l[6]||(l[6]=S(" during his/her service. "))])):w("",!0)])])):(r(),a("div",Se,l[7]||(l[7]=[e("p",null,"No contribution data found.",-1)])))])):(r(),a("div",Ie,[e("p",null,u(g.value),1)])),e("div",je,[i.value==="confirm"?(r(),a("button",{key:0,type:"button",class:"btn btn-primary",onClick:j}," Confirm ")):w("",!0),i.value==="alert"?(r(),a("button",{key:1,type:"button",class:"btn btn-primary",onClick:$}," OK ")):w("",!0)])])])])):w("",!0)])}}},Pe=U(Le,[["__scopeId","data-v-9b6af518"]]),Re={class:"main-section bg-light"},Fe={class:"container-fluid d-flex flex-row justify-content-between align-items-center mb-2 flex-wrap"},Ve={class:"mt-2 mt-md-0"},Ue={key:0,class:"container"},Be={class:"table-responsive"},Ge={class:"table table-bordered align-middle text-center"},He={class:"d-flex flex-row justify-content-center align-items-center action-buttons"},Ke=["onClick"],We=["onClick"],Je={key:1,class:"container text-center mt-3"},qe={key:2,class:"modal fade show d-block",tabindex:"-1",role:"dialog",style:{"background-color":"rgba(0,0,0,0.5)"}},ze={class:"modal-dialog modal-dialog-centered",role:"document"},Qe={class:"modal-content"},Xe={class:"modal-header"},Ye={class:"modal-title"},Ze={class:"modal-body"},et={class:"modal-footer"},tt={__name:"Home",props:{members:{type:Array,default:()=>[]},deceasedMembers:{type:Array,default:()=>[]},officials:{type:Array,default:()=>[]},otherOfficial:{type:Array,default:()=>[]}},setup(E){const _=E;let b=d([]);const y=d([]);let p=d([]),g=d([]);const i=d(!1),s=d(""),f=d(""),v=d(""),k=d(null),C=d(null),O=(n,o,t,l=null)=>{s.value=n,f.value=o,v.value="confirm",k.value=t,C.value=l,i.value=!0},h=(n,o)=>{s.value=n,f.value=o,v.value="alert",i.value=!0},j=()=>{k.value&&C.value?k.value(C.value):k.value&&k.value(),i.value=!1},$=()=>{i.value=!1,k.value=null,C.value=null};M(()=>_.otherOfficial,n=>{g.value=n},{immediate:!0}),M(()=>_.officials,n=>{p.value=[...n,...g.value],console.log("Official: ",p.value)},{immediate:!0}),M(()=>_.deceasedMembers,n=>{y.value=n,D()},{immediate:!0}),M(()=>_.members,n=>{D(n)},{immediate:!0});function D(n=_.members){if(!n){b.value=[];return}b.value=n.filter(o=>{const t=`${o.first_name} ${o.last_name}`.toLowerCase();return!y.value.some(l=>l.deceased_name.toLowerCase()===t)})}const L=n=>{O("Delete Member Permanently","Are you sure you want to delete this member permanently? This action cannot be undone.",P,n)},P=n=>{N.delete(route("archive.deleteMember",{id:n}),{onSuccess:()=>{h("Success","Member deleted successfully...")},onError:o=>{console.log("An error occurred while deleting data.",o),h("Error","An error occurred while deleting the member.")}})},R=n=>{O("Restore Member","Are you sure you want to restore this member?",T,n)},T=n=>{N.post(route("archive.undo",{id:n}),{onSuccess:()=>{h("Success","Member restored successfully...")},onError:o=>{console.log("An error occurred while restoring data.",o),h("Error","An error occurred while restoring the member.")}})};return(n,o)=>(r(),a(I,null,[x(A(Q),{title:"Registered members"}),x(X,null,{default:F(()=>[e("div",Re,[e("div",Fe,[o[1]||(o[1]=e("div",null,[e("h5",{class:"fw-light fs-5 mb-0"},"Archived")],-1)),e("div",Ve,[x(A(K),{href:n.route("archive.viewDeceasedMember"),class:"btn btn-dark"},{default:F(()=>o[0]||(o[0]=[e("span",{class:"d-none d-md-inline"},"View Deceased Member",-1),e("i",{class:"bi bi-eye d-inline d-md-none"},null,-1)])),_:1},8,["href"])])]),o[7]||(o[7]=e("p",{class:"text-muted ms-2"},"Members",-1)),A(b).length?(r(),a("div",Ue,[e("div",Be,[e("table",Ge,[o[5]||(o[5]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"ID"),e("th",null,[e("i",{class:"bi bi-person"}),S(" NAME")]),e("th",null,"GENDER"),e("th",null,"AGE"),e("th",null,"CONTACT NO."),e("th",null,"STREET"),e("th",null,"STATUS"),e("th",null,"ACTION")])],-1)),e("tbody",null,[(r(!0),a(I,null,V(A(b),(t,l)=>(r(),a("tr",{key:l},[e("td",null,u(l+1),1),e("td",null,u(t==null?void 0:t.first_name)+" "+u(t==null?void 0:t.middle_name)+" "+u(t==null?void 0:t.last_name),1),e("td",null,u(t.gender||"N/A"),1),e("td",null,u(t.age),1),e("td",null,u(t.contact_number),1),e("td",null,u(t.purok),1),e("td",null,u(t.status),1),e("td",null,[e("div",He,[x(A(K),{href:n.route("archive.view",{id:t==null?void 0:t.id}),class:"btn btn-sm btn-outline-dark me-1",title:"view info."},{default:F(()=>o[2]||(o[2]=[e("i",{class:"bi bi-eye"},null,-1)])),_:2},1032,["href"]),e("button",{class:"btn btn-sm btn-outline-dark me-1",onClick:m=>L(t.id),title:"delete permanently"},o[3]||(o[3]=[e("i",{class:"bi bi-trash"},null,-1)]),8,Ke),e("button",{class:"btn btn-sm btn-outline-dark",onClick:m=>R(t.id),title:"undo delete"},o[4]||(o[4]=[e("i",{class:"bi bi-arrow-counterclockwise"},null,-1)]),8,We)])])]))),128))])])])])):(r(),a("div",Je,o[6]||(o[6]=[e("h5",{class:"text-dark fw-light"},"No Member's Archive Data.",-1)]))),i.value?(r(),a("div",qe,[e("div",ze,[e("div",Qe,[e("div",Xe,[e("h5",Ye,u(s.value),1),e("button",{type:"button",class:"btn-close",onClick:$,"aria-label":"Close"})]),e("div",Ze,[e("p",null,u(f.value),1)]),e("div",et,[v.value==="confirm"?(r(),a("button",{key:0,type:"button",class:"btn btn-secondary",onClick:$}," Cancel ")):w("",!0),v.value==="confirm"?(r(),a("button",{key:1,type:"button",class:"btn btn-primary",onClick:j}," Confirm ")):w("",!0),v.value==="alert"?(r(),a("button",{key:2,type:"button",class:"btn btn-primary",onClick:$}," OK ")):w("",!0)])])])])):w("",!0),x(Pe,{officials:A(p)},null,8,["officials"]),x(de)])]),_:1})],64))}},at=U(tt,[["__scopeId","data-v-9629d05e"]]);export{at as default};
