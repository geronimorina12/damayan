import{r as a,s as y,f as i,o as d,b as e,F as U,G as T,e as V,n as D,t as n,W as C,j as E,a as A,u as P,g as B,w as j,i as W,h as N,D as q,E as z}from"./app-BduWwRy9.js";import{A as G}from"./AdminLayout-D32tZ7BG.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./logo1-BZ0h4foK.js";const J={class:"card mt-4"},Q={class:"card-body"},H={class:"table-responsive"},K={class:"table table-bordered align-middle"},O={class:"btn btn-sm btn-light"},X=["onClick"],Y={class:"modal fade",id:"action",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Z={class:"modal-dialog"},ee={class:"modal-content"},te={class:"modal-footer"},se={class:"container-fluid"},le={class:"col"},ae={__name:"RoleAndPermissionTable",props:{users:{type:Array,default:()=>[]}},setup(x){const f=x,o=a([]),r=a(0),u=a(0),v=a(0),c=a(0),b=a(0),p=a(0),h=a(0),m=a(null);y(()=>f.users,_=>{o.value=_,r.value=o.value.filter(s=>s.role==="admin").length,u.value=o.value.filter(s=>s.position==="secretary").length,v.value=o.value.filter(s=>s.position==="president").length,c.value=o.value.filter(s=>s.position==="vise_president").length,b.value=o.value.filter(s=>s.position==="purok_leader").length,p.value=o.value.filter(s=>s.position==="treasurer").length,h.value=o.value.filter(s=>s.position==="colector").length},{immediate:!0});const k=[{name:"Admin",description:"Full access",users:r.value+(r.value>1?" users":" user"),access:"Full modules",icon:"bi bi-person"},{name:"Collector",description:"Jurisdiction-based",users:4,access:"Status updates",icon:"bi bi-people"}],w=()=>{if(!m.value){alert("No role selected. Please select a role to view.");return}C.get(route("role.viewSpecificRole",{role:m.value})),m.value=null};return(_,s)=>(d(),i("div",null,[e("div",J,[e("div",Q,[s[2]||(s[2]=e("h6",{class:"fw-semibold"},"Roles and Permissions",-1)),e("div",H,[e("table",K,[s[1]||(s[1]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"Role"),e("th",null,"Description"),e("th",null,"Users"),e("th",null,"Access"),e("th")])],-1)),e("tbody",null,[(d(),i(U,null,T(k,(t,l)=>e("tr",{key:l},[e("td",null,[e("i",{class:D(t.icon)},null,2),V(" "+n(t.name),1)]),e("td",null,n(t.description),1),e("td",null,n(t.users),1),e("td",null,n(t.access),1),e("td",null,[e("button",O,[e("i",{class:"bi bi-three-dots-vertical","data-bs-toggle":"modal","data-bs-target":"#action",onClick:g=>m.value=t.name.toLocaleLowerCase()},null,8,X)])])])),64))])])])])]),e("div",Y,[e("div",Z,[e("div",ee,[s[3]||(s[3]=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"}," Action "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",te,[e("div",se,[e("div",le,[e("button",{type:"button",class:"btn btn-primary w-100","data-bs-dismiss":"modal",onClick:s[0]||(s[0]=t=>w())}," View All ")])])])])])])]))}},oe=I(ae,[["__scopeId","data-v-72122ad6"]]),ne={class:"container mt-4 role-container"},ie={class:"card mt-3"},de={class:"card-body"},re={class:"container-fluid d-flex align-items-center justify-content-between px-0"},ue={class:"search-box mb-3 position-relative"},ce={key:0,class:"spinner-border text-primary spinner-sm position-absolute end-0 top-50 translate-middle-y me-3",role:"status"},me={class:"table-responsive"},ve={class:"table table-bordered align-middle"},be={key:0},pe={class:"btn btn-sm btn-light"},fe=["onClick"],he={class:"modal fade",id:"action1Modal",tabindex:"-1","aria-labelledby":"actionModalLabel","aria-hidden":"true"},_e={class:"modal-dialog modal-dialog-centered"},ge={class:"modal-content modern-modal"},ye={class:"modal-footer modern-footer"},Ce={class:"action-buttons"},xe={__name:"Index",props:{users:{type:Array,default:()=>[]},admins:{type:Array,default:()=>[]}},setup(x){const f=x;let o=a([]),r=a([]),u=a(null),v=a("");const c=a(""),b=a(!1);a(""),y(()=>f.admins,s=>{r.value=s},{immediate:!0}),y(()=>f.users,s=>{o.value=[...s,...r.value]},{immediate:!0});const p=E(()=>{const s=c.value.trim().toLowerCase();return s?o.value.filter(t=>{var L,R,M,F;const l=((L=t.name)==null?void 0:L.toLowerCase())||"",g=((R=t.email)==null?void 0:R.toLowerCase())||"",$=((M=t.role)==null?void 0:M.toLowerCase())||"",S=((F=t.position)==null?void 0:F.toLowerCase())||"";return l.includes(s)||g.includes(s)||$.includes(s)||S.includes(s)}):o.value});let h;y(c,()=>{b.value=!0,clearTimeout(h),h=setTimeout(()=>{b.value=!1},400)});const m=(s,t)=>{u.value=s,v.value=t},k=()=>{v.value==="admin"||v.value==="collector"?C.get(route("role.edit",{id:u.value})):C.get(route("role.official.edit",{official:u.value}))},w=()=>{confirm("Are you sure you want to delete this user?")&&C.delete(route("role.deleteUser",{user:u.value}),{onSuccess:()=>{alert("User deleted successfully.")},onError:s=>{console.error("Failed to delete user.",s)}})},_=(s,t)=>s==="collector"||t==="collector"?"Status updates":s==="admin"||t==="president"?"Full modules":s==="secretary"||t==="secretary"?"Records and Reports":s==="vise_president"||t==="vise_president"?"Review and Approval":"N/A";return(s,t)=>(d(),i("div",null,[A(P(B),{title:"Role Management"}),A(G,null,{default:j(()=>[e("div",ne,[t[7]||(t[7]=e("h5",{class:"fw-light"},"User and Role Management",-1)),e("div",ie,[e("div",de,[e("div",re,[t[4]||(t[4]=e("div",null,[e("h6",{class:"fw-semibold"},"User Management")],-1)),e("div",ue,[W(e("input",{type:"text",class:"form-control search-input",placeholder:"Search...","onUpdate:modelValue":t[0]||(t[0]=l=>c.value=l)},null,512),[[q,c.value]]),b.value?(d(),i("div",ce,t[3]||(t[3]=[e("span",{class:"visually-hidden"},"Loading...",-1)]))):N("",!0)])]),e("div",me,[e("table",ve,[t[6]||(t[6]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"ID"),e("th",null,"NAME"),e("th",null,"EMAIL"),e("th",null,"Role"),e("th",null,"Access"),e("th")])],-1)),e("tbody",null,[p.value.length===0?(d(),i("tr",be,t[5]||(t[5]=[e("td",{colspan:"6",class:"text-center text-muted py-3"}," No users found. ",-1)]))):N("",!0),(d(!0),i(U,null,T(p.value,(l,g)=>(d(),i("tr",{key:g},[e("td",null,n(l.id),1),e("td",null,n(l.name),1),e("td",null,n(l.email||"N/A"),1),e("td",null,n((l==null?void 0:l.role)||(l==null?void 0:l.position)),1),e("td",null,n(_(l.role,l.position)),1),e("td",null,[e("button",pe,[e("i",{class:"bi bi-three-dots-vertical action1","data-bs-toggle":"modal","data-bs-target":"#action1Modal",onClick:$=>m(l.id,l.role||l.position)},null,8,fe)])])]))),128))])])])])]),A(oe,{users:p.value},null,8,["users"]),t[8]||(t[8]=e("div",{class:"bottom-role-container container"},null,-1))])]),_:1}),e("div",he,[e("div",_e,[e("div",ge,[t[12]||(t[12]=z('<div class="modal-header modern-header" data-v-5d093a86><div class="header-content" data-v-5d093a86><i class="modal-icon fas fa-exclamation-circle" data-v-5d093a86></i><h2 class="modal-title text-dark" id="actionModalLabel" data-v-5d093a86>Confirm Action</h2></div><button type="button" class="btn-close modern-close" data-bs-dismiss="modal" aria-label="Close" data-v-5d093a86><i class="bi bi-x-lg text-dark" data-v-5d093a86></i></button></div><div class="modal-body modern-body" data-v-5d093a86><p data-v-5d093a86> Please select an action to perform. <span class="text-danger" data-v-5d093a86>This action cannot be undone.</span></p></div>',2)),e("div",ye,[e("div",Ce,[e("button",{type:"button",class:"btn btn-edit text-dark","data-bs-dismiss":"modal",onClick:t[1]||(t[1]=l=>k())},t[9]||(t[9]=[e("i",{class:"fas fa-edit"},null,-1),e("span",null,"Edit",-1)])),e("button",{type:"button",class:"btn btn-delete text-dark","data-bs-dismiss":"modal",onClick:t[2]||(t[2]=l=>w())},t[10]||(t[10]=[e("i",{class:"fas fa-trash-alt"},null,-1),e("span",null,"Delete",-1)])),t[11]||(t[11]=e("button",{type:"button",class:"btn btn-cancel text-dark","data-bs-dismiss":"modal"},[e("i",{class:"fas fa-times"}),e("span",null,"Cancel")],-1))])])])])])]))}},Le=I(xe,[["__scopeId","data-v-5d093a86"]]);export{Le as default};
