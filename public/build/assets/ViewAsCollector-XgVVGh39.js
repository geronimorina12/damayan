import{r,s as N,l as S,j as x,f as u,o as c,b as t,e as f,t as e,F as h,G as B,J as P}from"./app-FxwxEWAe.js";import{h as F}from"./html2pdf-BP8nMiEf.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";const O={class:"header"},R={class:"deceased-name"},V={class:"fw-light"},j={class:"container-fluid d-flex flex-row justify-content-between align-items-center mb-2"},z={class:"fw-bold"},U={class:"fw-bold"},I={class:"table-container"},Y={class:"members-table"},$={class:"total-amount"},q={__name:"ViewAsCollector",props:{deceased:{type:Object,default:()=>({})},purok:String},setup(k){const a=k,n=r([]),p=r(null),d=r({}),D=r(""),v=r(!1),M=async(s,o)=>{if(!(!s||!o))try{console.log("id: ",s),console.log("purok: ",o),v.value=!0;const i=await P.get(`/collector/contributions/${s}/${o}`);n.value=i.data.contributions||[],console.log(" Contributions fetched:",n.value)}catch(i){console.error(" Error fetching contributions:",i)}finally{v.value=!1}};N([()=>a.purok],([s])=>{D.value=s},{immediate:!1}),N(()=>a.deceased,s=>{d.value=s,console.log("deceased: ",d.value)},{immediate:!0}),S(()=>{var s;(s=a.deceased)!=null&&s.member_id&&a.purok&&M(a.deceased.member_id,a.purok)});const T=x(()=>n.value.reduce((s,o)=>s+parseFloat(o.amount||0),0)),E=()=>{const s=p.value,o={filename:"Contributions_Report.pdf",image:{type:"jpeg",quality:.98},html2canvas:{scale:2},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}};F().from(s).set(o).save()};return(s,o)=>{var i,m,g,b,_,A;return c(),u(h,null,[t("button",{onClick:E,class:"download-btn btn btn-dark px-3 ms-2",title:"Download PDF"},o[0]||(o[0]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",fill:"currentColor",viewBox:"0 0 24 24"},[t("path",{d:`M12 3a1 1 0 011 1v9.586l3.293-3.293a1 1 0 011.414 1.414l-5 
        5a1 1 0 01-1.414 0l-5-5a1 1 0 
        011.414-1.414L11 13.586V4a1 1 0 011-1zm-7 
        14a1 1 0 100 2h14a1 1 0 100-2H5z`})],-1)])),t("div",{ref_key:"pdfContent",ref:p,class:"document-container"},[t("div",O,[o[3]||(o[3]=t("div",{class:"organization-name"},"BULAN P.R.O.T.E.C DAMAYAN FEDERATION",-1)),o[4]||(o[4]=t("div",{class:"organization-subtitle"},"(People's Responsible Organization Transforming Community)",-1)),o[5]||(o[5]=t("div",{class:"chapter-info fst-italic"},"Affiliated Bulan, Sorsogon Chapter Brgy. ______ C.Y 2021",-1)),o[6]||(o[6]=t("div",{class:"established fst-italic"},"Since 2016",-1)),t("div",R,[o[1]||(o[1]=f(" Deceased Name: ")),o[2]||(o[2]=t("br",null,null,-1)),t("p",V,e(((i=d.value)==null?void 0:i.deceased_name)||""),1)])]),t("div",j,[t("div",null,[o[7]||(o[7]=f(" Collector Name: ")),t("span",z,e(((m=n.value[0])==null?void 0:m.collector)||""),1)]),t("div",null,[o[8]||(o[8]=f(" Purok: ")),t("span",U,e(((A=(g=n.value[0])==null?void 0:g.purok)==null?void 0:A.charAt(((_=(b=n.value[0])==null?void 0:b.purok)==null?void 0:_.length)-1))||"all"),1)])]),t("div",I,[o[10]||(o[10]=t("div",{class:"mb-3"},[t("strong",null,"MEMBERS")],-1)),t("table",Y,[o[9]||(o[9]=t("thead",null,[t("tr",null,[t("th",null,"No."),t("th",null,"NAME"),t("th",null,"STATUS"),t("th",null,"AMOUNT")])],-1)),t("tbody",null,[(c(!0),u(h,null,B(n.value,(l,w)=>{var C,y;return c(),u("tr",{key:w},[t("td",null,e(w+1),1),t("td",null,e(((C=l==null?void 0:l.member_contribution)==null?void 0:C.first_name)||"Member")+" "+e(((y=l==null?void 0:l.member_contribution)==null?void 0:y.last_name)||""),1),t("td",null,e(l.status||""),1),t("td",null,"₱"+e(Math.floor(l.amount).toLocaleString()||""),1)])}),128))])]),t("div",$," TOTAL AMOUNT: ₱"+e(T.value.toLocaleString()),1)]),o[11]||(o[11]=t("div",{class:"signature"},[t("div",null,"Noted By:"),t("div",{class:"president-name"},"Melva Canale Delariarte"),t("div",null,"DAMAYAN PRESIDENT")],-1))],512)],64)}}},K=L(q,[["__scopeId","data-v-4f9da42c"]]);export{K as V};
