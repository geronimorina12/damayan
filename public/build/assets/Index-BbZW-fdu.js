import{C as w}from"./CollectorLayout-BFqDXDvN.js";import{r,s as n,f as g,o as v,b as e,t as _,u as m,j as x,n as S,i as T,h as D,D as U,F as A,G as $,W as I,a as y,g as F,w as L}from"./app-YM487_xA.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./logo1-BZ0h4foK.js";const E={class:"table-wrapper mt-3"},j={class:"container-fluid header-container"},B={class:"table"},O={class:"tbody"},V={style:{"border-top":"1px solid #000","border-bottom":"1px solid #000"}},H={class:"bg-light"},K={class:"bg-light"},W={class:"bg-light"},q={class:"bg-light"},z={class:"bg-light"},G={__name:"SubHeaderForCollectorReport",props:{membersCount:{type:Number,default:0},amount:{type:Number,default:0},activePurok:{type:String,default:""},paidMembers:{type:Number,default:0},unpaidMembers:{type:Number,default:0}},setup(h){const s=h;let d=r(0),u=r(0),c=r(""),p=r(""),l=r("");return n(()=>s.amount,o=>{u.value=o},{immediate:!0}),n(()=>s.membersCount,o=>{d.value=o},{immediate:!0}),n(()=>s.activePurok,o=>{c.value=o},{immediate:!0}),n(()=>s.paidMembers,o=>{p.value=u.value/100},{immediate:!0}),n(()=>s.unpaidMembers,o=>{l.value=o.toString()+(o===1?" Member":" Members")},{immediate:!0}),(o,b)=>(v(),g("div",E,[e("div",j,[e("table",B,[b[0]||(b[0]=e("thead",{class:"thead"},[e("tr",{style:{"border-top":"1px solid #000","border-bottom":"1px solid #000"}},[e("td",{class:"bg-light"},"MEMBERS"),e("td",{class:"bg-light"},"AMOUNT"),e("td",{class:"bg-light"},"PUROK"),e("td",{class:"bg-light"},"PAID"),e("td",{class:"bg-light"},"UNPAID")])],-1)),e("tbody",O,[e("tr",V,[e("td",H,_(m(d))+" Members",1),e("td",K,_(m(u)),1),e("td",W,_(m(c)[5]||"All"),1),e("td",q,_(m(p)),1),e("td",z,_(m(l)),1)])])])])]))}},Q=P(G,[["__scopeId","data-v-d0cf5257"]]),J={class:"container-fluid d-flex gap-3 align-items-center mb-3 justify-content-between"},X={class:"d-flex gap-3"},Y={class:"search-box position-relative"},Z={key:0,class:"spinner-border text-primary spinner-sm position-absolute end-0 top-50 translate-middle-y me-3",role:"status"},ee={class:"table-responsive table-container"},te={key:0,class:"table"},se={class:"bg-light"},ae={class:"bg-light"},oe={class:"bg-light"},le={class:"bg-light"},re={class:"bg-light text-center"},ie={key:0,class:"bg-success rounded px-2 py-1 text-light"},ne={key:1,class:"bg-danger rounded px-2 py-1 text-light"},ue={key:1,class:"text-center p-3"},ce={__name:"ReportTable",props:{activeStatus:{type:String,default:"paid"},activePurok:{type:String,default:"all"},members:{type:Array,default:()=>[]},contributionsIds:{type:Array,default:()=>[]}},setup(h){const s=h,d=r([]),u=r("all"),c=r(s.activeStatus),p=r(""),l=r(!1),o=()=>{c.value==="paid"?d.value=s.members.filter(t=>s.contributionsIds.includes(t.id)):c.value==="not_paid"?d.value=s.members.filter(t=>!s.contributionsIds.includes(t.id)):d.value=s.members},b=x(()=>{const t=p.value.trim().toLowerCase();return t?d.value.filter(a=>{var C,M;const i=`${a.first_name} ${a.middle_name||""} ${a.last_name}`.toLowerCase(),N=((C=a.contact_number)==null?void 0:C.toLowerCase())||"",R=((M=a.purok)==null?void 0:M.toLowerCase())||"";return i.includes(t)||N.includes(t)||R.includes(t)}):d.value});let f;n(p,()=>{l.value=!0,clearTimeout(f),f=setTimeout(()=>{l.value=!1},400)}),n(()=>[s.members,c.value],()=>{o()},{immediate:!0,deep:!0}),n(()=>s.activePurok,t=>{u.value=t},{immediate:!0});const k=t=>{if(c.value=t,u.value==="all"){o();return}I.get(route("collector.toggleStatus",{status:t,purok:u.value}),{},{preserveState:!0,replace:!0})};return(t,a)=>(v(),g("div",null,[e("div",J,[e("div",X,[e("h5",{class:S(["choice",{"text-success":c.value==="paid"}]),onClick:a[0]||(a[0]=i=>k("paid"))}," PAID ",2),e("h5",{class:S(["choice",{"text-success":c.value==="not_paid"}]),onClick:a[1]||(a[1]=i=>k("not_paid"))}," UNPAID ",2)]),e("div",Y,[T(e("input",{type:"text",class:"form-control",placeholder:"Search by name, contact, or purok...","onUpdate:modelValue":a[2]||(a[2]=i=>p.value=i)},null,512),[[U,p.value]]),l.value?(v(),g("div",Z,a[3]||(a[3]=[e("span",{class:"visually-hidden"},"Loading...",-1)]))):D("",!0)])]),e("div",ee,[b.value.length>0?(v(),g("table",te,[a[4]||(a[4]=e("thead",null,[e("tr",null,[e("th",{class:"bg-light"},"ID"),e("th",{class:"bg-light"},"NAME"),e("th",{class:"bg-light"},"CONTACT"),e("th",{class:"bg-light"},"PUROK"),e("th",{class:"bg-light"},"STATUS")])],-1)),e("tbody",null,[(v(!0),g(A,null,$(b.value,i=>(v(),g("tr",{key:i.id},[e("td",se,_(i.id),1),e("td",ae,_(i.first_name)+" "+_(i.middle_name)+" "+_(i.last_name),1),e("td",oe,_(i.contact_number),1),e("td",le,_(i.purok),1),e("td",re,[s.contributionsIds.includes(i.id)?(v(),g("span",ie," paid ")):(v(),g("span",ne," unpaid "))])]))),128))])])):(v(),g("div",ue,a[5]||(a[5]=[e("p",{class:"text-muted"},"No members found.",-1)])))])]))}},de=P(ce,[["__scopeId","data-v-312bc9bb"]]),pe={class:"d-flex flex-row justify-content-between align-items-center px-0"},me=["onClick"],be={__name:"PurokComponentForCollectorReport",props:{activePurok:{type:String,default:()=>"all"},activeStatus:{type:String,default:()=>"paid"}},setup(h){const s=h;let d=r(""),u=r("all");n(()=>s.activePurok,l=>{u.value=l},{immediate:!0}),n(()=>s.activeStatus,l=>{d.value=l},{immediate:!0});const c=["purok1","purok2","purok3","purok4"],p=l=>{I.get(route("collector.togglePurok",{status:d.value,purok:l}),{onSuccess:()=>console.log("changing purok"),onError:o=>console.log("An error occured: ",o)})};return(l,o)=>(v(),g("div",pe,[e("div",null,[(v(),g(A,null,$(c,b=>e("span",{key:b,class:S(["mx-2 purok",{"fw-bold active":b===m(u)}]),onClick:f=>p(b)},_(b),11,me)),64))])]))}},ge=P(be,[["__scopeId","data-v-b89b0c21"]]),ve={class:"purok-container container-fluid d-flex justify-content-end align-items-center"},ke={__name:"Index",props:{contributions:{type:Array,default:()=>[]},activePurok:{type:String,default:()=>"all"},activeStatus:{type:String,default:()=>"paid"},contributionsIds:{type:Array,default:()=>[]},members:{type:Array,default:()=>[]}},setup(h){const s=h;let d=r([]),u=r("all"),c=r(0),p=r("paid"),l=r([]);const o=r([]);n(()=>s.contributions,t=>{d.value=t,c.value=parseInt(t.reduce((a,i)=>a+parseFloat(i.amount),0))},{immediate:!0}),n(()=>s.activePurok,t=>{u.value=t},{immediate:!0}),n(()=>s.activeStatus,t=>{p.value=t},{immediate:!0}),n(()=>s.contributionsIds,t=>{l.value=Array.isArray(t)?[...t]:[]},{immediate:!0}),n(()=>s.members,t=>{o.value=t},{immediate:!0});const b=x(()=>o.value.filter(t=>l.value.includes(t.id)).length),f=x(()=>o.value.filter(t=>!l.value.includes(t.id)).length),k=x(()=>o.value.length);return(t,a)=>(v(),g("div",null,[y(m(F),{title:"Report"}),y(w,null,{default:L(()=>[a[0]||(a[0]=e("div",{class:"head container"},[e("h5",{class:"mb-0"},"Report"),e("p",{class:"d-none d-lg-block"},"Contribution Report")],-1)),e("div",ve,[y(ge,{activePurok:m(u),activeStatus:m(p)},null,8,["activePurok","activeStatus"])]),y(Q,{membersCount:k.value,amount:Number(m(c)),activePurok:m(u),paidMembers:b.value,unpaidMembers:f.value},null,8,["membersCount","amount","activePurok","paidMembers","unpaidMembers"]),y(de,{activeStatus:m(p),contributionsIds:m(l),members:o.value},null,8,["activeStatus","contributionsIds","members"])]),_:1})]))}};export{ke as default};
