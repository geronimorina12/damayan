import{r as g,x as O,f as c,o as m,b as e,h as k,e as S,t as p,d as V,i as f,D as y,u as o,I as D,F as N,G as R,l as z,J as ee,a as x,s as L,n as I,j as X,w as E,T as H,S as j,W as T,m as te,g as se,K as le,z as oe}from"./app-DWQox_iF.js";import{A as ne}from"./AdminLayout-BiNiaMAT.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./logo1-BZ0h4foK.js";const ae={class:"container-fluid d-flex flex-row justify-content-center main-container"},de={class:"container mt-5"},ie={key:0,class:"alert alert-success alert-dismissible fade show",role:"alert"},re={class:"row g-3"},ue={class:"col-md-6"},ce={class:"col-md-6"},me={class:"col-md-6"},pe={class:"col-md-6"},be={class:"col-md-6"},ve={class:"col-md-6"},fe={class:"col-md-6"},_e={class:"col-md-6"},ge={class:"col-md-6"},ye={class:"col-md-6"},he={key:0,class:"text-danger small mt-1"},$e={class:"col-12"},we={class:"mt-4"},xe={key:0,class:"text-center mt-3 text-muted"},ke={key:1,class:"table-responsive mt-2"},Me={class:"table table-bordered table-striped align-middle"},Ce=["onClick"],Ae={class:"d-flex flex-column flex-md-row justify-content-between align-items-center mt-4 gap-3"},Se={key:1,class:"card mt-4 p-3 shadow-sm"},Ve={class:"col-md-6"},Ue={class:"col-md-6"},Ne={class:"col-md-6"},Ee={class:"col-md-6"},Le={class:"col-12 d-flex justify-content-end gap-2 mt-3"},qe={__name:"AddNewMember",setup(M){const b=g({name:"",relation:"",age:"",birth_date:""}),n=g([]),i=g(!1),l=g(""),a=O({first_name:"",last_name:"",address:"",contact_number:"",date_of_birth:"",purok:"",age:"",middle_name:"",status:"",occupation:"",gender:"",beneficiaries:[]}),w=()=>{if(a.clearErrors(),!/^0\d{10}$/.test(a.contact_number)){a.setError("contact_number","Contact number must start with 0 and be exactly 11 digits.");return}a.beneficiaries=n.value,a.post(route("addMemberPost"),{onSuccess:()=>{l.value="Member added successfully!",setTimeout(()=>l.value="",4e3)},onError:t=>console.log("An error occurred => ",t)})},$=()=>{n.value.push({...b.value}),b.value={name:"",relation:"",age:"",birth_date:""},i.value=!1},h=s=>{n.value.splice(s,1)},u=s=>{const t={year:"numeric",month:"long",day:"numeric"};return new Date(s).toLocaleDateString(void 0,t)};return(s,t)=>(m(),c("div",ae,[e("div",de,[l.value?(m(),c("div",ie,[S(p(l.value)+" ",1),e("button",{type:"button",class:"btn-close",onClick:t[0]||(t[0]=d=>l.value="")})])):k("",!0),e("form",{onSubmit:V(w,["prevent"]),class:"form"},[e("div",re,[e("div",ue,[f(e("input",{type:"text",class:"form-control",placeholder:"Last name","onUpdate:modelValue":t[1]||(t[1]=d=>o(a).last_name=d)},null,512),[[y,o(a).last_name]])]),e("div",ce,[t[18]||(t[18]=e("label",{class:"form-label"},"Birth date",-1)),f(e("input",{type:"date",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=d=>o(a).date_of_birth=d)},null,512),[[y,o(a).date_of_birth]])]),e("div",me,[f(e("input",{type:"text",class:"form-control",placeholder:"First name","onUpdate:modelValue":t[3]||(t[3]=d=>o(a).first_name=d),required:""},null,512),[[y,o(a).first_name]])]),e("div",pe,[f(e("input",{type:"number",class:"form-control",placeholder:"Age","onUpdate:modelValue":t[4]||(t[4]=d=>o(a).age=d),required:""},null,512),[[y,o(a).age]])]),e("div",be,[f(e("input",{type:"text",class:"form-control",placeholder:"Middle name","onUpdate:modelValue":t[5]||(t[5]=d=>o(a).middle_name=d)},null,512),[[y,o(a).middle_name]])]),e("div",ve,[f(e("select",{class:"form-select","onUpdate:modelValue":t[6]||(t[6]=d=>o(a).gender=d),required:""},t[19]||(t[19]=[e("option",{value:"",disabled:""},"Gender",-1),e("option",{value:"Male"},"Male",-1),e("option",{value:"Female"},"Female",-1)]),512),[[D,o(a).gender]])]),e("div",fe,[f(e("select",{class:"form-select","onUpdate:modelValue":t[7]||(t[7]=d=>o(a).status=d),required:""},t[20]||(t[20]=[e("option",{value:"",disabled:""},"Status",-1),e("option",{value:"active"},"Active",-1),e("option",{value:"inactive"},"Inactive",-1)]),512),[[D,o(a).status]])]),e("div",_e,[f(e("input",{type:"number",class:"form-control",placeholder:"Purok","onUpdate:modelValue":t[8]||(t[8]=d=>o(a).purok=d),required:""},null,512),[[y,o(a).purok]])]),e("div",ge,[f(e("input",{type:"text",class:"form-control",placeholder:"Occupation","onUpdate:modelValue":t[9]||(t[9]=d=>o(a).occupation=d),required:""},null,512),[[y,o(a).occupation]])]),e("div",ye,[f(e("input",{type:"text",class:"form-control",placeholder:"Contact no.","onUpdate:modelValue":t[10]||(t[10]=d=>o(a).contact_number=d),pattern:"[0-9]*",inputmode:"numeric"},null,512),[[y,o(a).contact_number]]),o(a).errors.contact_number?(m(),c("div",he,p(o(a).errors.contact_number),1)):k("",!0)]),e("div",$e,[f(e("input",{type:"text",class:"form-control",placeholder:"Address","onUpdate:modelValue":t[11]||(t[11]=d=>o(a).address=d),required:""},null,512),[[y,o(a).address]])])]),e("div",we,[t[22]||(t[22]=e("h5",{class:"text-dark fw-light"},"Beneficiary",-1)),n.value.length===0?(m(),c("div",xe," No beneficiary added ")):(m(),c("div",ke,[e("table",Me,[t[21]||(t[21]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"Name"),e("th",null,"Relation"),e("th",null,"Age"),e("th",null,"Birthdate"),e("th",null,"Action")])],-1)),e("tbody",null,[(m(!0),c(N,null,R(n.value,(d,U)=>(m(),c("tr",{key:U},[e("td",null,p(d.name),1),e("td",null,p(d.relation),1),e("td",null,p(d.age),1),e("td",null,p(u(d.birth_date)),1),e("td",null,[e("button",{type:"button",class:"btn btn-danger btn-sm",onClick:F=>h(U)}," Delete ",8,Ce)])]))),128))])])]))]),e("div",Ae,[i.value?k("",!0):(m(),c("button",{key:0,class:"btn btn-primary w-100 w-md-auto",type:"button",onClick:t[12]||(t[12]=d=>i.value=!0)}," Add Beneficiary ")),t[23]||(t[23]=e("button",{class:"btn btn-success w-100 w-md-auto",type:"submit"},"Submit",-1))])],32),i.value?(m(),c("div",Se,[t[26]||(t[26]=e("h5",{class:"mb-3"},"Add Beneficiary",-1)),e("form",{onSubmit:V($,["prevent"]),class:"row g-2"},[e("div",Ve,[f(e("input",{type:"text",placeholder:"Name",class:"form-control","onUpdate:modelValue":t[13]||(t[13]=d=>b.value.name=d),required:""},null,512),[[y,b.value.name]])]),e("div",Ue,[f(e("input",{type:"text",placeholder:"Relation",class:"form-control","onUpdate:modelValue":t[14]||(t[14]=d=>b.value.relation=d),required:""},null,512),[[y,b.value.relation]])]),e("div",Ne,[f(e("input",{type:"number",placeholder:"Age",class:"form-control","onUpdate:modelValue":t[15]||(t[15]=d=>b.value.age=d),required:""},null,512),[[y,b.value.age]])]),e("div",Ee,[t[24]||(t[24]=e("label",{class:"form-label small"},"Birthdate",-1)),f(e("input",{type:"date",class:"form-control","onUpdate:modelValue":t[16]||(t[16]=d=>b.value.birth_date=d),required:""},null,512),[[y,b.value.birth_date]])]),e("div",Le,[e("button",{type:"button",class:"btn btn-secondary",onClick:t[17]||(t[17]=d=>i.value=!1)}," Cancel "),t[25]||(t[25]=e("button",{type:"submit",class:"btn btn-primary"},"Save Beneficiary",-1))])],32)])):k("",!0)])]))}},Be=q(qe,[["__scopeId","data-v-6f62a135"]]),Re={class:"container mt-4"},Ie={key:0,class:"text-center my-5"},Te={key:1,class:"alert alert-danger"},De={key:2,class:"table-responsive"},Fe={class:"table table-striped table-bordered shadow-sm"},je={key:3,class:"alert alert-info"},Oe={__name:"NewlyCreated",setup(M){const b=g([]),n=g(!0),i=g(null),l=async()=>{var w,$;try{const h=await ee.get("/member/new");b.value=h.data.data}catch(h){i.value=(($=(w=h.response)==null?void 0:w.data)==null?void 0:$.message)||"Failed to fetch latest members."}finally{n.value=!1}},a=w=>new Date(w).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return z(l),(w,$)=>(m(),c("div",Re,[n.value?(m(),c("div",Ie,$[0]||($[0]=[e("div",{class:"spinner-border text-primary",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1)]))):i.value?(m(),c("div",Te,p(i.value),1)):b.value.length?(m(),c("div",De,[e("table",Fe,[$[1]||($[1]=e("thead",{class:"table-primary"},[e("tr",null,[e("th",null,"Name"),e("th",null,"Address"),e("th",null,"Contact"),e("th",null,"Age"),e("th",null,"Gender"),e("th",null,"Registration Date")])],-1)),e("tbody",null,[(m(!0),c(N,null,R(b.value,h=>(m(),c("tr",{key:h.id},[e("td",null,p(h.first_name)+" "+p(h.middle_name)+" "+p(h.last_name),1),e("td",null,p(h.address),1),e("td",null,p(h.contact_number),1),e("td",null,p(h.age),1),e("td",null,p(h.gender),1),e("td",null,p(a(h.created_at)),1)]))),128))])])])):(m(),c("div",je," No newly registered members found. "))]))}},Pe=q(Oe,[["__scopeId","data-v-cb085a94"]]),Ge={class:"container-fluid d-flex flex-row justify-content-between align-items-center mb-2"},We={id:"addNewMemberModal",class:"custom-modal"},He={class:"modal-content",style:{"min-width":"60%",height:"auto"}},ze={class:"modal-header"},Xe={class:"modal-body"},Je={id:"newCreatedMemberModal",class:"custom-modal",style:{"padding-top":"0"}},Ke={class:"modal-content",style:{"min-width":"60%",height:"auto"}},Qe={class:"modal-header alig-items-center"},Ye={class:"modal-body"},Ze={__name:"Header",setup(M){const b=i=>{document.getElementById(i).classList.add("show")},n=i=>{document.getElementById(i).classList.remove("show")};return window.addEventListener("click",i=>{document.querySelectorAll(".custom-modal").forEach(l=>{i.target===l&&l.classList.remove("show")})}),(i,l)=>(m(),c("div",null,[e("div",Ge,[l[6]||(l[6]=e("div",null,[e("h5",{class:"ms-3 fw-light"},[e("span",{class:"d-none d-sm-none d-lg-inline-block me-2"},"Registered"),e("span",null,"Members")])],-1)),e("div",null,[e("button",{class:"modern-btn me-3",onClick:l[0]||(l[0]=V(a=>b("addNewMemberModal"),["prevent"]))},l[4]||(l[4]=[e("i",{class:"bi bi-person-plus"},null,-1),e("span",null,"Add Member",-1)])),e("button",{class:"modern-btn secondary",onClick:l[1]||(l[1]=a=>b("newCreatedMemberModal"))},l[5]||(l[5]=[e("i",{class:"bi bi-person-lines-fill"},null,-1),e("span",null,"Newly Created",-1)]))])]),e("div",We,[e("div",He,[e("div",ze,[l[7]||(l[7]=e("h3",null,"Add New Member",-1)),e("button",{class:"close-btn",onClick:l[2]||(l[2]=a=>n("addNewMemberModal"))},"×")]),e("div",Xe,[x(Be)])])]),e("div",Je,[e("div",Ke,[e("div",Qe,[l[8]||(l[8]=e("div",{class:""},[e("h4",{class:"mb-3 text-dark fw-bold d-flex align-items-center"}," Newly Registered Member ")],-1)),e("button",{class:"close-btn2 fs-2",onClick:l[3]||(l[3]=a=>n("newCreatedMemberModal"))},"×")]),e("div",Ye,[x(Pe)])])])]))}},et=q(Ze,[["__scopeId","data-v-ff43b7b9"]]),tt={__name:"Alert",props:{status:{type:Boolean,default:!1},name:{type:String,default:""}},setup(M){const b=M,n=g(!1),i=g(null),l=g("");return L(()=>b.status,a=>{i.value=a,l.value="bounce-in",n.value=!0,setTimeout(()=>{l.value="slide-out",setTimeout(()=>{n.value=!1},500)},3e3)}),(a,w)=>(m(),c("div",null,[n.value?(m(),c("div",{key:0,class:I(["alert alert-info",l.value]),role:"alert"},[S(p(M.name)+"'s status has been changed to ",1),e("strong",null,p(i.value?"Active":"Inactive"),1)],2)):k("",!0)]))}},st=q(tt,[["__scopeId","data-v-f19df27b"]]),lt={class:"reminder-wrapper"},ot={class:"card shadow-sm p-4 rounded-4 bg-white border-0"},nt={key:0,class:"mb-4 text-center"},at={class:"fw-bold text-primary mb-1"},dt={class:"text-muted mb-0"},it={class:"row g-3"},rt={class:"col-md-6"},ut={class:"col-md-6"},ct={key:0,class:"mt-4 bg-light p-3 rounded border-start border-4 border-primary"},mt={key:0,class:"mt-4 d-flex flex-wrap gap-3 justify-content-center"},pt={__name:"IsDeceased",props:{deceasedMember:{type:Object,default:()=>({})}},setup(M){const b=O({message:"",type:"deathReport",memberId:null}),n=M,i=g({}),l=g(""),a=g("");L(()=>n.deceasedMember,u=>{i.value=u},{immediate:!0}),L([l,a],([u,s])=>{var t;if(u&&s&&((t=i.value)!=null&&t.first_name)){const d=i.value;b.message=`We regret to inform you that ${d.first_name} ${d.last_name} has passed away. Last night is on ${h(u)}, and the collection for burial assistance starts on ${h(s)}.`,b.memberId=d.id}else b.message=""});function w(){T.post(route("smsNotification.sendReminders"),{message:b.message},{onSuccess:()=>alert("Reminders sent successfully!"),onError:()=>alert("Error sending Reminders")})}const $=X(()=>l.value&&a.value),h=u=>{const s={year:"numeric",month:"long",day:"numeric"};return new Date(u).toLocaleDateString(void 0,s)};return(u,s)=>(m(),c("div",lt,[e("div",ot,[i.value.first_name?(m(),c("div",nt,[e("h4",at,p(i.value.first_name)+" "+p(i.value.middle_name)+" "+p(i.value.last_name),1),e("p",dt,p(i.value.address),1)])):k("",!0),e("div",it,[e("div",rt,[s[2]||(s[2]=e("label",{class:"form-label fw-semibold text-secondary"},"Enter last night:",-1)),f(e("input",{type:"date",class:"form-control","onUpdate:modelValue":s[0]||(s[0]=t=>l.value=t)},null,512),[[y,l.value]])]),e("div",ut,[s[3]||(s[3]=e("label",{class:"form-label fw-semibold text-secondary"},"Start of contribution:",-1)),f(e("input",{type:"date",class:"form-control","onUpdate:modelValue":s[1]||(s[1]=t=>a.value=t)},null,512),[[y,a.value]])])]),x(H,{name:"fade"},{default:E(()=>[o(b).message?(m(),c("p",ct,p(o(b).message),1)):k("",!0)]),_:1}),x(H,{name:"fade"},{default:E(()=>{var t;return[$.value?(m(),c("div",mt,[x(o(j),{href:u.route("smsNotification.sendToAllSelectedV2",{type:"deathReport",message:o(b).message,deceased:(t=i.value)==null?void 0:t.id,last:l.value}),class:"btn-modern text-decoration-none"},{default:E(()=>s[4]||(s[4]=[e("i",{class:"bi bi-people-fill me-2"},null,-1),S("Send to all selected ")])),_:1},8,["href"]),e("button",{class:"btn-modern",onClick:w},s[5]||(s[5]=[e("i",{class:"bi bi-send-fill me-2"},null,-1),S("Send ")]))])):k("",!0)]}),_:1})])]))}},bt=q(pt,[["__scopeId","data-v-7863633d"]]),vt={class:"container-fluid d-flex flex-row justify-content-center align-items-center main-container"},ft={class:"container mt-3"},_t={class:"row mb-3 d-flex flex-row align-items-center"},gt={class:"col col-6"},yt={class:"col col-6"},ht={class:"row mb-3"},$t={class:"col col-6"},wt={class:"col col-6"},xt={class:"row mb-3"},kt={class:"col col-6"},Mt={class:"col col-6"},Ct={class:"row mb-3"},At={class:"col col-6"},St={class:"col col-6"},Vt={class:"row mb-3"},Ut={class:"col col-6"},Nt={class:"col col-6"},Et={key:0,class:"text-danger mt-1"},Lt={class:"row mb-3"},qt={class:"col col-6"},Bt={key:0,class:"container text-center mt-5 fs-4"},Rt={key:1},It={class:"table table-responsive bg-light"},Tt=["onClick"],Dt={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Ft={class:"modal-dialog"},jt={class:"modal-content"},Ot={class:"modal-body"},Pt={__name:"EditMember",props:{member:{type:Object,default:()=>({})}},setup(M){const b=M,n=O({first_name:"",last_name:"",address:"",contact_number:"",date_of_birth:"",purok:"",age:"",middle_name:"",status:"",occupation:"",gender:"",beneficiaries:[]}),i=g([]),l=g({name:"",relation:"",age:"",birth_date:""});L(()=>b.member,u=>{u&&(console.log("Reactive update detected:",u),n.defaults({first_name:u.first_name||"",last_name:u.last_name||"",address:u.address||"",contact_number:u.contact_number||"",date_of_birth:u.date_of_birth||"",purok:u.purok||"",age:u.age||"",middle_name:u.middle_name||"",status:u.status||"",occupation:u.occupation||"",gender:u.gender||"",beneficiaries:u.beneficiaries||[]}),n.reset(),i.value=(u==null?void 0:u.beneficiaries)||[])},{immediate:!0,deep:!0});const a=()=>{if(n.clearErrors(),!/^0\d{10}$/.test(n.contact_number)){n.setError("contact_number","Contact number must start with 0 and be exactly 11 digits.");return}n.beneficiaries=i.value,n.put(route("members.update",b.member.id),{onSuccess:()=>alert("Member updated successfully."),onError:s=>console.error("An error occurred => ",s)})},w=()=>{!l.value.name||!l.value.relation||!l.value.age||!l.value.birth_date||(i.value.push({...l.value}),l.value={name:"",relation:"",age:"",birth_date:""})},$=u=>{i.value.splice(u,1)},h=u=>{if(!u)return"";const s={year:"numeric",month:"long",day:"numeric"};return new Date(u).toLocaleDateString(void 0,s)};return(u,s)=>(m(),c("div",null,[e("div",vt,[e("div",ft,[e("form",{onSubmit:V(a,["prevent"]),class:"form"},[e("div",_t,[e("div",gt,[f(e("input",{type:"text",class:"form-control mt-3",placeholder:"Last name","onUpdate:modelValue":s[0]||(s[0]=t=>o(n).last_name=t)},null,512),[[y,o(n).last_name]])]),e("div",yt,[s[15]||(s[15]=e("label",null,"Birth date",-1)),f(e("input",{type:"date",class:"form-control",placeholder:"Birth date","onUpdate:modelValue":s[1]||(s[1]=t=>o(n).date_of_birth=t)},null,512),[[y,o(n).date_of_birth]])])]),e("div",ht,[e("div",$t,[f(e("input",{type:"text",class:"form-control",placeholder:"First name","onUpdate:modelValue":s[2]||(s[2]=t=>o(n).first_name=t),required:""},null,512),[[y,o(n).first_name]])]),e("div",wt,[s[16]||(s[16]=e("label",null,"Age",-1)),f(e("input",{type:"number",class:"form-control",placeholder:"Age","onUpdate:modelValue":s[3]||(s[3]=t=>o(n).age=t),required:""},null,512),[[y,o(n).age]])])]),e("div",xt,[e("div",kt,[f(e("input",{type:"text",class:"form-control",placeholder:"Middle name","onUpdate:modelValue":s[4]||(s[4]=t=>o(n).middle_name=t),required:""},null,512),[[y,o(n).middle_name]])]),e("div",Mt,[s[18]||(s[18]=e("label",null,"Gender",-1)),f(e("select",{class:"form-control","onUpdate:modelValue":s[5]||(s[5]=t=>o(n).gender=t),required:""},s[17]||(s[17]=[e("option",{value:""},"Select Gender",-1),e("option",{value:"Male"},"Male",-1),e("option",{value:"Female"},"Female",-1)]),512),[[D,o(n).gender]])])]),e("div",Ct,[e("div",At,[f(e("select",{class:"form-control","onUpdate:modelValue":s[6]||(s[6]=t=>o(n).status=t),required:""},s[19]||(s[19]=[e("option",{value:"",disabled:""},"Status",-1),e("option",{value:"active"},"Active",-1),e("option",{value:"inactive"},"Inactive",-1)]),512),[[D,o(n).status]])]),e("div",St,[f(e("input",{type:"text",class:"form-control",placeholder:"Purok","onUpdate:modelValue":s[7]||(s[7]=t=>o(n).purok=t),required:""},null,512),[[y,o(n).purok]])])]),e("div",Vt,[e("div",Ut,[f(e("input",{type:"text",class:"form-control",placeholder:"Occupation","onUpdate:modelValue":s[8]||(s[8]=t=>o(n).occupation=t),required:""},null,512),[[y,o(n).occupation]])]),e("div",Nt,[f(e("input",{type:"text",class:"form-control",placeholder:"Contact no.","onUpdate:modelValue":s[9]||(s[9]=t=>o(n).contact_number=t),required:"",pattern:"[0-9]*",inputmode:"numeric"},null,512),[[y,o(n).contact_number]]),o(n).errors.contact_number?(m(),c("div",Et,p(o(n).errors.contact_number),1)):k("",!0)])]),e("div",Lt,[e("div",qt,[f(e("input",{type:"text",class:"form-control",placeholder:"Address","onUpdate:modelValue":s[10]||(s[10]=t=>o(n).address=t),required:""},null,512),[[y,o(n).address]])])]),i.value.length?(m(),c("div",Rt,[s[21]||(s[21]=e("h5",{class:"text-dark fw-light pt-2"},"Beneficiary",-1)),e("table",It,[s[20]||(s[20]=e("thead",null,[e("tr",null,[e("th",null,"Name"),e("th",null,"Relation"),e("th",null,"Age"),e("th",null,"Birthdate"),e("th",null,"Action")])],-1)),e("tbody",null,[(m(!0),c(N,null,R(i.value,(t,d)=>(m(),c("tr",{key:d},[e("td",null,p(t.name),1),e("td",null,p(t.relation),1),e("td",null,p(t.age),1),e("td",null,p(h(t.birth_date)),1),e("td",null,[e("button",{class:"btn btn-danger",type:"button",onClick:U=>$(d)}," Delete ",8,Tt)])]))),128))])])])):(m(),c("div",Bt," No beneficiary added ")),s[22]||(s[22]=e("div",{class:"container-fluid d-flex flex-row justify-content-between align-items-center"},[e("button",{class:"btn btn-primary",type:"button","data-bs-toggle":"modal","data-bs-target":"#exampleModal"}," Add Beneficiary "),e("button",{class:"btn btn-success",type:"submit"},"Save")],-1))],32),e("div",Dt,[e("div",Ft,[e("div",jt,[s[25]||(s[25]=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"}," Add Beneficiary "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",Ot,[e("form",{onSubmit:V(w,["prevent"])},[f(e("input",{type:"text",placeholder:"Name",class:"form-control mb-2","onUpdate:modelValue":s[11]||(s[11]=t=>l.value.name=t),required:""},null,512),[[y,l.value.name]]),f(e("input",{type:"text",placeholder:"Relation",class:"form-control mb-2","onUpdate:modelValue":s[12]||(s[12]=t=>l.value.relation=t),required:""},null,512),[[y,l.value.relation]]),f(e("input",{type:"number",placeholder:"Age",class:"form-control mb-2","onUpdate:modelValue":s[13]||(s[13]=t=>l.value.age=t),required:""},null,512),[[y,l.value.age]]),s[23]||(s[23]=e("label",null,"Date of birth",-1)),f(e("input",{type:"date",class:"form-control mb-2","onUpdate:modelValue":s[14]||(s[14]=t=>l.value.birth_date=t),required:""},null,512),[[y,l.value.birth_date]]),s[24]||(s[24]=e("div",{class:"container d-flex justify-content-end gap-2 mt-1"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close "),e("button",{type:"submit",class:"btn btn-primary","data-bs-dismiss":"modal"}," Save changes ")],-1))],32)])])])])])])]))}},Gt={class:"main-section bg-light"},Wt={class:"container table-container"},Ht={class:"search-box mb-3"},zt={class:"table-responsive"},Xt={class:"table table-bordered align-middle text-center"},Jt={class:"text-start"},Kt={class:"status-cell"},Qt={class:"status-toggle"},Yt={class:"toggle-switch"},Zt=["checked","onChange"],es={class:"status-cell"},ts={class:"status-toggle"},ss={class:"toggle-switch"},ls=["checked","onClick"],os={class:"actions-column"},ns={class:"action-buttons-large"},as=["onClick"],ds=["onClick"],is={class:"action-buttons-small"},rs=["onClick"],us={key:0},cs={class:"pagination-wrapper mt-3 mb-5"},ms={class:"pagination-controls"},ps=["onClick","innerHTML"],bs={class:"list-unstyled m-0"},vs={class:"modal fade",id:"editMember",tabindex:"-1"},fs={class:"modal-dialog modal-lg"},_s={class:"modal-content"},gs={class:"modal-body"},ys={class:"custom-modal"},hs={class:"custom-modal-body"},$s={__name:"RegisteredMember",props:{members:{type:Object,default:()=>({data:[],links:[],prev_page_url:null,next_page_url:null})},deceasedMember:{type:Array,default:()=>[]}},setup(M){const b=M,n=g([]),i=g(!1),l=g({top:"0px",left:"0px"}),a=g(null);g({});const w=g(!1),$=g(""),h=g(""),u=g([]),s=g({}),t=g(!1),d=g({});g(null),g(!1),g(""),L(()=>b.members,v=>{n.value=v.data||[]},{immediate:!0}),L(()=>b.deceasedMember,v=>{u.value=v.data||[]},{immediate:!0});const U=X(()=>h.value?n.value.filter(v=>`${v.first_name} ${v.middle_name||""} ${v.last_name}`.toLowerCase().includes(h.value.toLowerCase())||(v.contact_number||"").toLowerCase().includes(h.value.toLowerCase())||(v.purok||"").toLowerCase().includes(h.value.toLowerCase())):n.value),F=v=>{confirm("Are you sure you want to trash this member?")&&T.delete(route("deleteMember",{id:v}),{onSuccess:()=>{alert("Member trashed"),i.value=!1}})},J=v=>{const r=v.status==="active"?"inactive":"active";T.put(route("toggleMemberStatus",{id:v.id}),{status:r},{onSuccess:()=>{v.status=r,w.value=r==="active",$.value=`${v.first_name} ${v.middle_name} ${v.last_name}`}})},K=(v,r)=>{if(i.value&&a.value===r){i.value=!1,a.value=null;return}a.value=r,i.value=!0,oe(()=>{const _=v.currentTarget.getBoundingClientRect(),A=document.querySelector(".actions-popup");if(!A)return;const C=A.offsetWidth,Z=window.innerWidth;let B=_.right+window.scrollX+10;B+C>Z&&(B=_.left+window.scrollX-C-10,B<0&&(B=10)),l.value={top:`${_.top+window.scrollY}px`,left:`${B}px`}})},P=v=>{i.value&&v.target&&!v.target.closest(".actions-popup")&&!v.target.closest(".three-dots-button")&&(i.value=!1,a.value=null)};z(()=>document.addEventListener("click",P)),te(()=>document.removeEventListener("click",P));const Q=v=>{v&&T.visit(v)},Y=v=>{s.value=v||null,t.value=!0},G=()=>{t.value=!1},W=v=>{i.value=!1,d.value={...v}};return(v,r)=>(m(),c(N,null,[x(o(se),{title:"Registered members"}),x(ne,null,{default:E(()=>[e("div",Gt,[x(et),x(st,{status:w.value,name:$.value},null,8,["status","name"]),e("div",Wt,[e("div",Ht,[f(e("input",{type:"text",class:"form-control search-input",placeholder:"Search members by name, contact, or purok...","onUpdate:modelValue":r[0]||(r[0]=_=>h.value=_)},null,512),[[y,h.value]])]),e("div",zt,[e("table",Xt,[r[10]||(r[10]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"ID"),e("th",null,"NAME"),e("th",null,"GENDER"),e("th",null,"AGE"),e("th",null,"CONTACT NO."),e("th",null,"STREET"),e("th",null,"STATUS"),e("th",null,"DECEASED"),e("th",null,"ACTION")])],-1)),e("tbody",null,[(m(!0),c(N,null,R(U.value,(_,A)=>(m(),c("tr",{key:A},[e("td",null,p(_.id),1),e("td",Jt,p(_.first_name)+" "+p(_.middle_name)+" "+p(_.last_name),1),e("td",null,p(_.gender||"N/A"),1),e("td",null,p(_.age),1),e("td",null,p(_.contact_number),1),e("td",null,p(_.purok),1),e("td",Kt,[e("div",Qt,[e("label",Yt,[e("input",{type:"checkbox",checked:_.status==="active",onChange:C=>J(_)},null,40,Zt),r[3]||(r[3]=e("span",{class:"toggle-slider"},null,-1))]),e("span",{class:I(["status-label",_.status==="active"?"active":"inactive"])},p(_.status==="active"?"Active":"Inactive"),3)])]),e("td",es,[e("div",ts,[e("label",ss,[e("input",{type:"checkbox",checked:u.value.some(C=>C.member_id===_.id),onClick:C=>Y(_)},null,8,ls),r[4]||(r[4]=e("span",{class:"toggle-slider"},null,-1))]),e("span",{class:I(["status-label",_.status==="active"?"active":"inactive"])},null,2)])]),e("td",os,[e("div",ns,[x(o(j),{href:v.route("viewMemberInfo",{id:_.id}),class:"me-1"},{default:E(()=>r[5]||(r[5]=[e("i",{class:"bi bi-eye"},null,-1)])),_:2},1032,["href"]),e("button",{"data-bs-toggle":"modal","data-bs-target":"#editMember",onClick:C=>W(_),class:"me-1"},r[6]||(r[6]=[e("i",{class:"bi bi-pencil"},null,-1)]),8,as),e("button",{onClick:C=>F(_.id)},r[7]||(r[7]=[e("i",{class:"bi bi-trash"},null,-1)]),8,ds)]),e("div",is,[e("button",{class:"btn btn-sm btn-outline-dark three-dots-button",onClick:V(C=>K(C,_.id),["stop"])},r[8]||(r[8]=[e("i",{class:"bi bi-three-dots-vertical"},null,-1)]),8,rs)])])]))),128)),U.value.length===0?(m(),c("tr",us,r[9]||(r[9]=[e("td",{colspan:"9",class:"text-center text-muted"},"No members found",-1)]))):k("",!0)])])]),e("div",cs,[e("div",ms,[(m(!0),c(N,null,R(b.members.links,(_,A)=>(m(),c("button",{key:A,class:I(["btn pagination-btn",_.active?"btn-primary":"btn-outline-primary"]),onClick:C=>Q(_.url),innerHTML:_.label},null,10,ps))),128))])])])]),i.value?(m(),c("div",{key:0,class:"actions-popup bg-white border rounded shadow-sm p-2",style:le({top:l.value.top,left:l.value.left})},[e("ul",bs,[e("li",null,[x(o(j),{href:v.route("viewMemberInfo",{id:a.value}),class:"dropdown-item"},{default:E(()=>r[11]||(r[11]=[e("i",{class:"bi bi-eye me-2"},null,-1),S(" View")])),_:1},8,["href"])]),e("li",null,[e("button",{class:"dropdown-item w-100 text-start","data-bs-toggle":"modal","data-bs-target":"#editMember",onClick:r[1]||(r[1]=_=>W(n.value.find(A=>A.id===a.value)))},r[12]||(r[12]=[e("i",{class:"bi bi-pencil me-2"},null,-1),S(" Edit")]))]),e("li",null,[e("button",{class:"dropdown-item w-100 text-start text-danger",onClick:r[2]||(r[2]=_=>F(a.value))},r[13]||(r[13]=[e("i",{class:"bi bi-trash me-2"},null,-1),S(" Delete")]))])])],4)):k("",!0),e("div",vs,[e("div",fs,[e("div",_s,[r[14]||(r[14]=e("div",{class:"modal-header"},[e("h5",null,"Edit Member Info"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),e("div",gs,[x(Pt,{member:d.value},null,8,["member"])])])])]),t.value?(m(),c("div",{key:1,class:"custom-modal-overlay",onClick:V(G,["self"])},[e("div",ys,[e("div",{class:"custom-modal-header"},[r[15]||(r[15]=e("h3",null,"Add Deceased Info",-1)),e("span",{class:"close-icon",onClick:G},"×")]),e("div",hs,[x(bt,{deceasedMember:s.value},null,8,["deceasedMember"])])])])):k("",!0)]),_:1})],64))}},Cs=q($s,[["__scopeId","data-v-3a83792c"]]);export{Cs as default};
