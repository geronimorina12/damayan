import{r as d,s as A,z as O,J as B,j as E,f as r,o as n,a as v,u as C,g as L,w,b as t,i as V,D as j,e as D,h as b,t as o,F as h,G as T,S as P,n as z,W as I}from"./app-DhPW_94J.js";import{C as U}from"./CollectorLayout-ByBNDDS4.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./logo1-BZ0h4foK.js";const G={class:"main-section bg-light"},H={class:"mb-3 px-3"},W={class:"table-responsive"},$={class:"table table-bordered align-middle text-center"},J={key:0},K={key:1},Q={colspan:"6",class:"text-center text-danger"},X={key:2},Y={class:"pagination-wrapper mt-3 mb-5 pb-5 pt-3"},Z=["onClick","innerHTML"],q=400,ee={__name:"RegisteredMember",props:{members:{type:Object,default:()=>({data:[],links:[],prev_page_url:null,next_page_url:null})}},setup(M){const f=M;let c=d([]);const m=d(""),y=d(null),i=d(!1),p=d("");A(()=>f.members,async a=>{c.value=a.data||[],await O(),R()},{immediate:!0});let g=null;A(m,a=>{g&&clearTimeout(g),g=setTimeout(()=>N(a.trim()),q)});async function N(a){if(!a){c.value=f.members.data,console.log("Search cleared â€” showing default members:",c.value),i.value=!1;return}i.value=!0,p.value="",console.log(`ðŸ” Searching for: "${a}"`);try{const s=await B.get(route("members.search"),{params:{query:a}});console.log(" Raw backend response:",s.data);let e=[];const l=s.data||{};if(Array.isArray(l.members))e=l.members;else if(l.members&&Array.isArray(l.members.data))e=l.members.data;else if(l.member&&typeof l.member=="object")e=[l.member];else if(Array.isArray(l.data))e=l.data;else{const u=Object.values(l).find(x=>{var k;return Array.isArray(x)&&((k=x[0])==null?void 0:k.id)});u&&(e=u)}console.log("ðŸ§¾ Normalized member data:",e),c.value=Array.isArray(e)?e:[]}catch(s){console.error("âŒ Search error:",s),p.value="Error fetching search results."}finally{i.value=!1}}const _=E(()=>i.value?[]:c.value||[]),S=a=>{a&&I.visit(a,{preserveState:!0})},R=()=>{const a=y.value;if(!a)return;const s=a.querySelector(".btn.btn-primary");if(s){const e=a.getBoundingClientRect(),l=s.getBoundingClientRect(),u=l.left-e.left-e.width/2+l.width/2;a.scrollTo({left:a.scrollLeft+u,behavior:"smooth"})}};return(a,s)=>(n(),r(h,null,[v(C(L),{title:"Registered members"}),v(U,null,{default:w(()=>[t("div",G,[s[5]||(s[5]=t("div",null,[t("h5",{class:"ms-3 fw-light"},[t("span",{class:"d-none d-sm-none d-lg-inline-block me-2"},"Registered"),t("span",null,"Members")])],-1)),t("div",H,[V(t("input",{type:"text",class:"form-control w-50",placeholder:"Search members by name, contact, or purok...","onUpdate:modelValue":s[0]||(s[0]=e=>m.value=e)},null,512),[[j,m.value]])]),t("div",W,[t("table",$,[s[4]||(s[4]=t("thead",{class:"table-light"},[t("tr",null,[t("th",null,[t("i",{class:"bi bi-person"}),D(" NAME")]),t("th",null,"AGE"),t("th",null,"CONTACT NO."),t("th",null,"PUROK"),t("th",null,"ACTION")])],-1)),t("tbody",null,[i.value?(n(),r("tr",J,s[1]||(s[1]=[t("td",{colspan:"6",class:"text-center py-4"},[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")])],-1)]))):b("",!0),p.value&&!i.value?(n(),r("tr",K,[t("td",Q,o(p.value),1)])):b("",!0),(n(!0),r(h,null,T(_.value,(e,l)=>(n(),r("tr",{key:l},[t("td",null,o(e==null?void 0:e.first_name)+" "+o(e==null?void 0:e.middle_name)+" "+o(e==null?void 0:e.last_name),1),t("td",null,o(e.age),1),t("td",null,o(e.contact_number),1),t("td",null,o(e.purok),1),t("td",null,[v(C(P),{href:a.route("viewMemberInfo",{id:e==null?void 0:e.id}),class:"btn btn-sm btn-outline-dark me-1 border-0"},{default:w(()=>s[2]||(s[2]=[t("i",{class:"bi bi-eye fs-5"},null,-1)])),_:2},1032,["href"])])]))),128)),_.value.length===0?(n(),r("tr",X,s[3]||(s[3]=[t("td",{colspan:"6",class:"text-center text-muted"},"No members found",-1)]))):b("",!0)])])]),t("div",Y,[t("div",{class:"pagination-controls",ref_key:"paginationContainer",ref:y},[(n(!0),r(h,null,T(f.members.links,(e,l)=>(n(),r("button",{key:l,class:z(["btn pagination-btn",e.active?"btn-primary":"btn-outline-primary"]),onClick:u=>S(e.url),innerHTML:e.label},null,10,Z))),128))],512)])])]),_:1})],64))}},re=F(ee,[["__scopeId","data-v-19500e48"]]);export{re as default};
