import{r as p,s as _,f,o as v,b as t,F as C,G as E,n as M,u as S,t as l,W as B,l as F,j as I,e as b,J as L}from"./app-BKViIBP_.js";import{_ as T}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{h as O}from"./html2pdf-B-S0kQPb.js";const $={class:"d-flex flex-row justify-content-between align-items-center px-0"},j=["onClick"],z={__name:"PurokComponentForCollector",props:{activePurok:{type:String,default:()=>""},deceasedId:{type:Number,default:()=>0}},setup(k){const n=k;let s=p("");_(()=>n.activePurok,a=>{s.value=a},{immediate:!0});const m=["Purok 1","Purok 2","Purok 3","Purok 4"],d=a=>a.toLowerCase().replace(/\s+/g,""),g=a=>{console.log("deceasedId:",n.deceasedId);const u=d(a);B.get(route("collectorContribution.togglePurok",{purok:u,deceasedId:n.deceasedId}),{onSuccess:()=>console.log("Changing purok"),onError:r=>console.log("An error occurred:",r)})};return(a,u)=>(v(),f("div",$,[t("div",null,[(v(),f(C,null,E(m,r=>t("span",{key:r,class:M(["mx-2 purok",{"fw-bold active":d(r)===S(s)}]),onClick:w=>g(r)},l(r),11,j)),64))]),t("div",{class:M(["mx-2 purok",{"fw-bold active":S(s)==="all"}]),onClick:u[0]||(u[0]=r=>g("all"))}," All members ",2)]))}},tt=T(z,[["__scopeId","data-v-2bdb649d"]]),R={class:"header"},V={class:"deceased-name"},U={class:"fw-light"},Y={class:"container-fluid d-flex flex-row justify-content-between align-items-center mb-2"},W={class:"fw-bold"},q={class:"fw-bold"},G={class:"table-container"},H={class:"members-table"},J={class:"total-amount"},K={__name:"ViewAsCollector",props:{deceased:{type:Object,default:()=>({})},purok:String},setup(k){const n=k,s=p([]),m=p(null),d=p({}),g=p(""),a=p(!1),u=async(e,o)=>{if(!(!e||!o))try{console.log("id: ",e),console.log("purok: ",o),a.value=!0;const c=await L.get(`/collector/contributions/${e}/${o}`);s.value=c.data.contributions||[],console.log(" Contributions fetched:",s.value)}catch(c){console.error(" Error fetching contributions:",c)}finally{a.value=!1}};_([()=>n.purok],([e])=>{g.value=e},{immediate:!1}),_(()=>n.deceased,e=>{d.value=e,console.log("deceased: ",d.value)},{immediate:!0}),F(()=>{var e;(e=n.deceased)!=null&&e.member_id&&n.purok&&u(n.deceased.member_id,n.purok)});const r=I(()=>s.value.reduce((e,o)=>e+parseFloat(o.amount||0),0)),w=()=>{const e=m.value,o={filename:"Contributions_Report.pdf",image:{type:"jpeg",quality:.98},html2canvas:{scale:2},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}};O().from(e).set(o).save()};return(e,o)=>{var c,A,P,y,h;return v(),f(C,null,[t("button",{onClick:w,class:"download-btn btn btn-dark px-3 ms-2",title:"Download PDF"},o[0]||(o[0]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",fill:"currentColor",viewBox:"0 0 24 24"},[t("path",{d:`M12 3a1 1 0 011 1v9.586l3.293-3.293a1 1 0 011.414 1.414l-5 
        5a1 1 0 01-1.414 0l-5-5a1 1 0 
        011.414-1.414L11 13.586V4a1 1 0 011-1zm-7 
        14a1 1 0 100 2h14a1 1 0 100-2H5z`})],-1)])),t("div",{ref_key:"pdfContent",ref:m,class:"document-container"},[t("div",R,[o[3]||(o[3]=t("div",{class:"organization-name"},"BULAN P.R.O.T.E.C DAMAYAN FEDERATION",-1)),o[4]||(o[4]=t("div",{class:"organization-subtitle"},"(People's Responsible Organization Transforming Community)",-1)),o[5]||(o[5]=t("div",{class:"chapter-info fst-italic"},"Affiliated Bulan, Sorsogon Chapter Brgy. ______ C.Y 2021",-1)),o[6]||(o[6]=t("div",{class:"established fst-italic"},"Since 2016",-1)),t("div",V,[o[1]||(o[1]=b(" Deceased Name: ")),o[2]||(o[2]=t("br",null,null,-1)),t("p",U,l(((c=d.value)==null?void 0:c.deceased_name)||""),1)])]),t("div",Y,[t("div",null,[o[7]||(o[7]=b(" Collector Name: ")),t("span",W,l(((A=s.value[0])==null?void 0:A.collector)||""),1)]),t("div",null,[o[8]||(o[8]=b(" Purok: ")),t("span",q,l(((h=s.value[0])==null?void 0:h.purok.charAt(((y=(P=s.value[0])==null?void 0:P.purok)==null?void 0:y.length)-1))||""),1)])]),t("div",G,[o[10]||(o[10]=t("div",{class:"mb-3"},[t("strong",null,"MEMBERS")],-1)),t("table",H,[o[9]||(o[9]=t("thead",null,[t("tr",null,[t("th",null,"No."),t("th",null,"NAME"),t("th",null,"STATUS"),t("th",null,"AMOUNT")])],-1)),t("tbody",null,[(v(!0),f(C,null,E(s.value,(i,x)=>{var N,D;return v(),f("tr",{key:x},[t("td",null,l(x+1),1),t("td",null,l(((N=i==null?void 0:i.member_contribution)==null?void 0:N.first_name)||"Member")+" "+l(((D=i==null?void 0:i.member_contribution)==null?void 0:D.last_name)||""),1),t("td",null,l(i.status),1),t("td",null,"₱"+l(Math.floor(i.amount).toLocaleString()),1)])}),128))])]),t("div",J," TOTAL AMOUNT: ₱"+l(r.value.toLocaleString()),1)]),o[11]||(o[11]=t("div",{class:"signature"},[t("div",null,"Noted By:"),t("div",{class:"president-name"},"Melva Canale Delariarte"),t("div",null,"DAMAYAN PRESIDENT")],-1))],512)],64)}}},ot=T(K,[["__scopeId","data-v-7322785c"]]);export{tt as P,ot as V};
