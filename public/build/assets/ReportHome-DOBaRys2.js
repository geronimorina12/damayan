import{A as B}from"./AdminLayout-DJAeWfnW.js";import{r as n,s as y,l as P,f as u,o as i,b as e,F as $,G as M,e as E,t as d,x as O,i as C,D as x,u as a,n as w,I as V,h as R,d as F,j as I,J as T,a as D,g as H,w as z,c as U}from"./app-B2PZaDBq.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{h as j}from"./html2pdf-DTn4ufS3.js";import"./logo1-BZ0h4foK.js";const Y={key:0,class:"mb-4"},G={class:"container"},K={class:"table-responsive-wrapper"},q={class:"responsive-table"},J={"data-label":"Collector"},Z={"data-label":"Purok"},Q={"data-label":"Assigned Members"},W={"data-label":"Paid"},X={"data-label":"Unpaid"},ee={key:1,class:"container text-muted text-center"},te={__name:"ContributionReportForAdmin",props:{contributions:{type:Array,default:()=>[]}},setup(g){const _=g,o=n([]),v=n([]),c=n([]),m=n([]),f=n([]),l=n([]),p=h=>Array.isArray(h)?[...h].sort((r,s)=>Number(r.purok)-Number(s.purok)):[];y(()=>_.contributions,h=>{o.value=p(h||[]),v.value=o.value.filter(r=>Number(r.purok)===1),c.value=o.value.filter(r=>Number(r.purok)===2),m.value=o.value.filter(r=>Number(r.purok)===3),f.value=o.value.filter(r=>Number(r.purok)===4),console.log("SORTED:",o.value)},{immediate:!0});const A=async()=>{try{const h=await axios.get("/members");l.value=h.data;const r=l.value.filter(k=>k.purok.toLowerCase().replace(/\s/g,"")==="purok1"),s=l.value.filter(k=>k.purok.toLowerCase().replace(/\s/g,"")==="purok2"),t=l.value.filter(k=>k.purok.toLowerCase().replace(/\s/g,"")==="purok3"),b=l.value.filter(k=>k.purok.toLowerCase().replace(/\s/g,"")==="purok4");v.value=r.length,c.value=s.length,m.value=t.length,f.value=b.length,console.log("Purok 1:",v.value),console.log("Purok 2:",c.value),console.log("Purok 3:",m.value),console.log("Purok 4:",f.value)}catch(h){console.error("Error fetching members:",h)}};return P(()=>{A()}),(h,r)=>(i(),u("div",null,[o.value.length>0?(i(),u("div",Y,[e("div",G,[e("div",K,[e("table",q,[r[1]||(r[1]=e("thead",{class:"table-light"},[e("tr",null,[e("th",{"data-label":"Collector"},"COLLECTOR"),e("th",{"data-label":"Purok"},"PUROK"),e("th",{"data-label":"Assigned Members"},"ASSIGNED MEMBERS"),e("th",{"data-label":"Paid"},"PAID"),e("th",{"data-label":"Unpaid"},"UNPAID")])],-1)),e("tbody",null,[(i(!0),u($,null,M(o.value,(s,t)=>(i(),u("tr",{key:t},[e("td",J,[r[0]||(r[0]=e("i",{class:"bi bi-person me-2"},null,-1)),E(d(s.collector),1)]),e("td",Z,d(s.purok),1),e("td",Q,d(s.members),1),e("td",W,d(s.paid),1),e("td",X,d(s.members-s.paid),1)]))),128))])])]),r[2]||(r[2]=e("div",{class:"container w-50 h-50"},null,-1))])])):(i(),u("div",ee,r[3]||(r[3]=[e("p",null,"No contribution data.",-1)])))]))}},oe=N(te,[["__scopeId","data-v-cc690c08"]]),se={key:0,class:"container"},le={class:"table-responsive-wrapper"},ae={class:"responsive-table"},re={"data-label":"Collector"},ne={"data-label":"Purok"},ie={"data-label":"Members"},de={"data-label":"Amount"},ue={key:1,class:"container text-muted text-center"},ce={__name:"RecentContributionForAdmin",props:{recent:{type:Array,default:()=>[]}},setup(g){const _=g,o=n([]);return y(()=>_.recent,v=>{o.value=v},{immediate:!0}),(v,c)=>(i(),u("div",null,[o.value.length>0?(i(),u("div",se,[e("div",le,[e("table",ae,[c[0]||(c[0]=e("thead",{class:"table-light"},[e("tr",null,[e("th",{"data-label":"Collector"},"COLLECTOR"),e("th",{"data-label":"Purok"},"PUROK"),e("th",{"data-label":"Members"},"MEMBERS"),e("th",{"data-label":"Amount"},"AMOUNT")])],-1)),e("tbody",null,[(i(!0),u($,null,M(g.recent,(m,f)=>(i(),u("tr",{key:f},[e("td",re,d(m.collector),1),e("td",ne,d(m.purok),1),e("td",ie,d(m.members),1),e("td",de,d(m.total_amount),1)]))),128))])])])])):(i(),u("div",ue,c[1]||(c[1]=[e("p",null,"No recent contribution data.",-1)])))]))}},me=N(ce,[["__scopeId","data-v-089be15a"]]),pe={class:"container"},be={class:"mb-3"},ve={class:"invalid-feedback"},_e={class:"mb-3"},fe={class:"invalid-feedback"},he={class:"mb-3"},ke={class:"invalid-feedback"},ge={class:"mb-3"},Ce={class:"mb-3"},ye=["value"],we={class:"invalid-feedback"},$e=["disabled"],Ae={key:0,class:"spinner-border spinner-border-sm me-1"},Me={__name:"AddCollector",emits:["submitted"],setup(g,{emit:_}){const o=O({name:"",email:"",password:"",role:"collector",purok:"1"}),v=_,c=["1","2","3","4"],m=()=>{o.post(route("reports.storeCollector"),{onSuccess:()=>{o.reset(),v("submitted"),alert("Collector added successfully!")},onError:f=>console.log(f)})};return(f,l)=>(i(),u("div",pe,[e("form",{onSubmit:F(m,["prevent"]),class:"bg-white rounded"},[e("div",be,[l[5]||(l[5]=e("label",{for:"name",class:"form-label"},"Name",-1)),C(e("input",{type:"text",id:"name","onUpdate:modelValue":l[0]||(l[0]=p=>a(o).name=p),class:w(["form-control",{"is-invalid":a(o).errors.name}])},null,2),[[x,a(o).name]]),e("div",ve,d(a(o).errors.name),1)]),e("div",_e,[l[6]||(l[6]=e("label",{for:"email",class:"form-label"},"Email",-1)),C(e("input",{type:"email",id:"email","onUpdate:modelValue":l[1]||(l[1]=p=>a(o).email=p),class:w(["form-control",{"is-invalid":a(o).errors.email}])},null,2),[[x,a(o).email]]),e("div",fe,d(a(o).errors.email),1)]),e("div",he,[l[7]||(l[7]=e("label",{for:"password",class:"form-label"},"Password",-1)),C(e("input",{type:"password",id:"password","onUpdate:modelValue":l[2]||(l[2]=p=>a(o).password=p),class:w(["form-control",{"is-invalid":a(o).errors.password}])},null,2),[[x,a(o).password]]),e("div",ke,d(a(o).errors.password),1)]),e("div",ge,[l[8]||(l[8]=e("label",{for:"role",class:"form-label"},"Role",-1)),C(e("input",{type:"text",id:"role","onUpdate:modelValue":l[3]||(l[3]=p=>a(o).role=p),class:"form-control",readonly:""},null,512),[[x,a(o).role]])]),e("div",Ce,[l[10]||(l[10]=e("label",{for:"purok",class:"form-label"},"Purok",-1)),C(e("select",{id:"purok","onUpdate:modelValue":l[4]||(l[4]=p=>a(o).purok=p),class:w(["form-select",{"is-invalid":a(o).errors.purok}])},[l[9]||(l[9]=e("option",{disabled:"",value:""},"Select Purok",-1)),(i(),u($,null,M(c,p=>e("option",{key:p,value:p},d(p),9,ye)),64))],2),[[V,a(o).purok]]),e("div",we,d(a(o).errors.purok),1)]),e("button",{type:"submit",class:"btn btn-primary",disabled:a(o).processing},[a(o).processing?(i(),u("span",Ae)):R("",!0),l[11]||(l[11]=E(" Submit "))],8,$e)],32)]))}},Re=N(Me,[["__scopeId","data-v-ff4066de"]]),Ne={key:0,class:"select-wrapper"},xe={class:"select-box"},De=["value"],Pe={key:1},Ee={class:"header"},Se={class:"deceased-name"},Le={class:"table-container"},Te={class:"members-table"},Ue={class:"total-amount"},Ve={__name:"View",setup(g){const _=n([]),o=n(null);n(null);const v=n(""),c=n(!1),m=n([]),f=n(null),l=async s=>{try{const t=await T.get(`/reports/contributions/${s}`);m.value=t.data.contributions}catch(t){console.error("Error fetching contributions:",t)}};P(async()=>{try{const s=await T.get("/reports/deceased");_.value=s.data.deceased}catch(s){console.error("An error occurred while fetching deceased:",s)}});const A=()=>{l(o.value);const s=_.value.find(t=>t.member_id==o.value);v.value=(s==null?void 0:s.deceased_name)||"",c.value=!0},h=I(()=>m.value.reduce((s,t)=>s+parseFloat(t.amount||0),0)),r=()=>{const s=f.value,t={filename:`${v.value}_Report.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}};j().from(s).set(t).save()};return(s,t)=>(i(),u($,null,[c.value?R("",!0):(i(),u("div",Ne,[t[2]||(t[2]=e("label",{class:"select-label"},"Select Deceased Member:",-1)),e("div",xe,[C(e("select",{"onUpdate:modelValue":t[0]||(t[0]=b=>o.value=b),onChange:A},[t[1]||(t[1]=e("option",{disabled:"",value:""},"Select...",-1)),(i(!0),u($,null,M(_.value,b=>(i(),u("option",{key:b.member_id,value:b.member_id},d(b.deceased_name),9,De))),128))],544),[[V,o.value]])])])),c.value?(i(),u("div",Pe,[e("button",{onClick:r,class:"download-btn",title:"Download PDF"},t[3]||(t[3]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:`M12 3a1 1 0 011 1v9.586l3.293-3.293a1 1 0 011.414 1.414l-5 
            5a1 1 0 01-1.414 0l-5-5a1 1 0 
            011.414-1.414L11 13.586V4a1 1 0 011-1zm-7 
            14a1 1 0 100 2h14a1 1 0 100-2H5z`})],-1)])),e("div",{ref_key:"pdfContent",ref:f,class:"document-container"},[e("div",Ee,[t[4]||(t[4]=e("div",{class:"organization-name"},"BULAN P.R.O.T.E.C DAMAYAN FEDERATION",-1)),t[5]||(t[5]=e("div",{class:"organization-subtitle"},"(People's Responsible Organization Transforming Community)",-1)),t[6]||(t[6]=e("div",{class:"chapter-info"},"Affiliated Bulan, Sorsogon Chapter Brgy. ______ C.Y 2021",-1)),t[7]||(t[7]=e("div",{class:"established"},"Since 2016",-1)),e("div",Se," Deceased Name: "+d(v.value),1)]),e("div",Le,[t[9]||(t[9]=e("div",{class:"mb-3"},[e("strong",null,"MEMBERS")],-1)),e("table",Te,[t[8]||(t[8]=e("thead",null,[e("tr",null,[e("th",null,"No."),e("th",null,"NAME"),e("th",null,"STATUS"),e("th",null,"AMOUNT")])],-1)),e("tbody",null,[(i(!0),u($,null,M(m.value,(b,k)=>{var S,L;return i(),u("tr",{key:k},[e("td",null,d(k+1),1),e("td",null,d(((S=b==null?void 0:b.member_contribution)==null?void 0:S.first_name)||"member")+" "+d(((L=b==null?void 0:b.member_contribution)==null?void 0:L.last_name)||""),1),e("td",null,d(b.status),1),e("td",null,d(Math.floor(b.amount)||"0"),1)])}),128))])]),e("div",Ue," TOTAL AMOUNT: â‚±"+d(h.value.toLocaleString()),1)]),t[10]||(t[10]=e("div",{class:"signature"},[e("div",null,"Noted By:"),e("div",{class:"president-name"},"Melva Canale Delariarte"),e("div",null,"DAMAYAN PRESIDENT")],-1))],512)])):R("",!0)],64))}},Be=N(Ve,[["__scopeId","data-v-5599dfff"]]),Oe={class:"modern-report-container"},Fe={class:"tab-navigation"},Ie={class:"content-area"},He={class:"modal fade",id:"viewReportModal",tabindex:"-1","aria-labelledby":"viewReportModalLabel","aria-hidden":"true"},ze={class:"modal-dialog modern-modal-dialog"},je={class:"modal-content modern-modal-content"},Ye={class:"modal-body"},Ge={class:"modal fade",id:"addCollectorModal",tabindex:"-1","aria-labelledby":"addCollectorModalLabel","aria-hidden":"true"},Ke={class:"modal-dialog",style:{"max-width":"700px"}},qe={class:"modal-content"},Je={class:"modal-body"},Ze={__name:"ReportHome",props:{contributions:{type:Array,default:()=>[]},memberContributions:{type:Array,default:()=>[]},deathReports:{type:Array,default:()=>[]},president:{type:Object,default:()=>({})}},setup(g){const _=g;let o=n([]),v=n(!0),c=n(!1),m=n([]),f=n([]);n(!1),n(null);let l=n(0);n(null);const p=n("");y(()=>_.contributions,s=>{o.value=s},{immediate:!0}),y(()=>_.memberContributions,s=>{m.value=s.filter(t=>t.member_contribution!==null),console.log("member contributions:",m.value),l.value=m.value.reduce((t,b)=>t+Number(b.amount||0),0)},{immediate:!0}),y(()=>_.deathReports,s=>{f.value=s},{immediate:!0}),y(()=>_.president,s=>{p.value=s==null?void 0:s.name},{immediate:!0});const A=()=>{c.value=!0,v.value=!1},h=()=>{c.value=!1,v.value=!0};P(()=>{document.getElementById("addCollectorModal")});const r=()=>{};return(s,t)=>(i(),u("div",null,[D(a(H),{title:"Report"}),D(B,null,{default:z(()=>[e("div",Oe,[t[2]||(t[2]=e("div",{class:"modern-header"},[e("div",{class:"header-content"},[e("h5",{class:"fw-light"},"Reports Dashboard")]),e("div",{class:"header-actions"},[e("button",{class:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#viewReportModal"},[e("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M9 17H15",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"}),e("path",{d:"M9 13H15",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"}),e("path",{d:"M9 9H13",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"}),e("path",{d:"M3 5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H19C19.5304 3 20.0391 3.21071 20.4142 3.58579C20.7893 3.96086 21 4.46957 21 5V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V5Z",stroke:"currentColor","stroke-width":"2"})]),E(" View Reports ")])])],-1)),e("div",Fe,[e("button",{class:w(a(c)?"tab-btn active":"tab-btn"),onClick:A}," Recent Contributions ",2),e("button",{class:w(a(v)?"tab-btn active":"tab-btn"),onClick:h}," Contributions Report ",2)]),e("div",Ie,[a(v)?(i(),U(oe,{key:0,contributions:a(o)},null,8,["contributions"])):R("",!0),a(c)?(i(),U(me,{key:1,recent:a(o)},null,8,["recent"])):R("",!0)]),e("div",He,[e("div",ze,[e("div",je,[t[0]||(t[0]=e("div",{class:"modal-header modern-modal-header"},[e("div",{class:"header-content"}),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",Ye,[D(Be)])])])]),e("div",Ge,[e("div",Ke,[e("div",qe,[t[1]||(t[1]=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"addCollectorModalLabel"}," Add Collector "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",Je,[D(Re,{onSubmitted:r})])])])]),t[3]||(t[3]=e("div",{class:"extra-space"},null,-1))])]),_:1})]))}},ot=N(Ze,[["__scopeId","data-v-279a1c35"]]);export{ot as default};
